**Microsoft Visual C++**（简称**Visual C++**、**MSVC**、**VC++**或**VC**）是[微軟公司的](https://zh.wikipedia.org/wiki/微軟公司 "wikilink")[C++](../Page/C++.md "wikilink")開發工具，具有[集成开发环境](../Page/集成开发环境.md "wikilink")，可提供編輯[C語言](https://zh.wikipedia.org/wiki/C語言 "wikilink")，[C++](../Page/C++.md "wikilink")以及[C++/CLI等](https://zh.wikipedia.org/wiki/C++/CLI "wikilink")[编程語言](https://zh.wikipedia.org/wiki/编程語言 "wikilink")。VC++整合了便利的除錯工具，特別是整合了微軟[Windows视窗操作系统应用程序接口](https://zh.wikipedia.org/wiki/Microsoft_Windows "wikilink")（[Windows API](../Page/Windows_API.md "wikilink")）、[三维動畫](https://zh.wikipedia.org/wiki/三维動畫 "wikilink")[DirectX](../Page/DirectX.md "wikilink") API，[Microsoft .NET框架](https://zh.wikipedia.org/wiki/Microsoft_.NET "wikilink")。目前最新的版本是Microsoft Visual C++ 2019。

## 風格

Visual C++以拥有[语法高亮](https://zh.wikipedia.org/wiki/语法高亮 "wikilink")、[IntelliSense](https://zh.wikipedia.org/wiki/IntelliSense "wikilink")（智能提示）以及高级调试功能而著称。比如，它允许用户进行远程调试，单步执行等。还有允许用户在调试期间重新编译被修改的代码，而不必重新启动正在调试的程序。其编译及创建預編譯頭文件（`stdafx.h`）、最小重建功能及累加連結（link）著稱。這些特徵明顯縮短程式編輯、編譯及連結的時間花費，在大型軟體計畫上尤其顯著。

## 发行版本

Visual C++被整合在Visual Studio之中，但仍可單獨安裝使用。

通常细分为多个发行版本。以Visual C++ 2013为例：

  - Visual C++ 2013 Community社群版(功能同專業版)(非商業免費)
  - Visual C++ 2013 Express速成版
  - Visual C++ 2013 Professional专业版
  - Visual C++ 2013 Premium高级版
  - Visual C++ 2013 Ultimate旗舰版

其中Microsoft Visual C++ 2013 Express可從[MSDN的網站免費下載使用](https://zh.wikipedia.org/wiki/MSDN "wikilink")，並且不限制商業使用（但不包含[MFC](../Page/MFC_\(微軟\).md "wikilink")）。

## 歷史

Visual C++的前身是[Microsoft C/C++](https://zh.wikipedia.org/wiki/Microsoft_C/C++ "wikilink")。还有相关产品：*Microsoft [QuickC](https://zh.wikipedia.org/wiki/QuickC "wikilink")* 2.5 与*Microsoft QuickC for Windows* 1.0. Visual C++ [编译器仍然叫做](https://zh.wikipedia.org/wiki/编译器 "wikilink")*Microsoft C/C++*。例如Visual C++ 2015 Update 2的版本号是19.00.23918.

### 16-bit版本

  - Microsoft C 1.0～6.0,C/C++ 7.0

  - Visual C++ 1.0～1.52c

  - **Microsoft C 1.0**, 基于[Lattice C](https://zh.wikipedia.org/wiki/Lattice_C "wikilink"), Microsoft的第一款C产品，发布于1983年10月。遵循K\&R C语言标准。售价500美元。

  - **C 2.0** 增加了large model支持.

  - **C 3.0**是第一款Microsoft自己开发的C产品. 目标是兼容K\&R与ANSI标准。1984年初微软用它开发了[Windows与](https://zh.wikipedia.org/wiki/Microsoft_Windows "wikilink")[Xenix](../Page/Xenix.md "wikilink")。1985年对外发布.

  - **C 4.0**增加了优化器与源级调试器[CodeView](https://zh.wikipedia.org/wiki/CodeView "wikilink").

  - **C 5.0**增加了循环优化与*Huge Model* (数组大于64k)支持。Microsoft [Fortran](../Page/Fortran.md "wikilink")与80386上第一款32位编译器也是此计划的一部分。

  - **C 5.1**1988年发布，允许为OS/2 1.x编译.

  - **C 6.0**1989发布. 增加了全局流分析、源浏览器、新调试器、可选的C++前端.\[1\]

  - **C/C++ 7.0**1992年发布. 内建支持C++与MFC 1.0.\[2\]

  - **Visual C++ 1.0**, 包含了[MFC](https://zh.wikipedia.org/wiki/Microsoft_Foundation_Class_Library "wikilink") 2.0, 发布于1993年2月22日。是[Cfront](https://zh.wikipedia.org/wiki/Cfront "wikilink") 2.1 兼容\[3\]。IDE称“Visual Workbench”。有两个版本:\[4\]

      - Standard – 替换“QuickC for Windows”。售价199美元。
      - Professional – 替换 C/C++ 7.0. 可建构 DOS与Windows应用程序。包含了优化编译器、源profiler, Windows 3.1 SDK。\[5\]以及[Phar Lap](https://zh.wikipedia.org/wiki/Phar_Lap_\(company\) "wikilink") 286 DOS Extender Lite\[6\]售价499美元。

  - **Visual C++ 1.5**发布于1993年12月, 包含了MFC 2.5, 增加了[OLE](https://zh.wikipedia.org/wiki/Object_Linking_and_Embedding "wikilink") 2.0与[ODBC](https://zh.wikipedia.org/wiki/Open_Database_Connectivity "wikilink") 支持.\[7\] 是首款仅用[CD-ROM](../Page/CD-ROM.md "wikilink")发布的Visual C++.這個版本-{只}支持16位开发。

      - **Visual C++ 1.51 与 1.52**作为subscription service可利用.
      - **Visual C++ 1.52b** 类似于1.52, 但不包括Control Development Kit.
      - **Visual C++ 1.52c** 是1.5的加补丁版. 是最后一版，也是有争议的最为流行的[Microsoft Windows](https://zh.wikipedia.org/wiki/Microsoft_Windows "wikilink") 3.x开发平台. 可通过[Microsoft Developer Network使用它](https://zh.wikipedia.org/wiki/Microsoft_Developer_Network "wikilink").

### 32-bit版本

  - **Visual C++ 1.0** (最初称: **Visual C++ 32-bit Edition**)是该系列的第一款32位编译器.\[8\] 1993年7月发布时，已经有了16位的VC++ 1.5，但这个版本不支持OLE2与ODBC. 套装叫做**Visual C++ 16/32-bit Suite**, 其中包含了Visual C++ 1.5.\[9\]

  - **Visual C++ 2.0**，集成了MFC 3.0，第一個只發行32位的版本。這個版本提前發行了，幾乎成了一個「丟失的版本」。這是因為那個時候[Windows 95](../Page/Windows_95.md "wikilink")（開發代碼為"Chicago"）還沒有發行，而[Windows NT又只佔有很小的市場份額](../Page/Windows_NT.md "wikilink")。該版本用戶可以通過[微軟公司的訂閱服務](https://zh.wikipedia.org/wiki/微軟 "wikilink")（[Microsoft](https://zh.wikipedia.org/wiki/Microsoft "wikilink") Subscription Service）升級至2.1和2.2版本。微軟公司在這個版本中还包含了升級后的Visual C++ 1.5：2.0版本中包含了Visual C++ 1.51；2.1版本包含了Visual C++ 1.52。Visual C++ 2.x附帶了16位和32位版本的[CDK](https://zh.wikipedia.org/wiki/CDK "wikilink")，同時支持[Win32s的開發](https://zh.wikipedia.org/wiki/Win32s "wikilink")。Visual C++ 2.2及其後續版本不再升級Visual C++ 1.5（儘管它一直被集成至Visual C++ 4.x）。儘管出生的比Windows 95早，這個版本的發行日期還是非常接近[Windows 95](../Page/Windows_95.md "wikilink")，可是當[Windows 95發行時](../Page/Windows_95.md "wikilink")，Visual C++ 4.0也已經發行了。因此很多程序開發者直接從1.x過渡到4.0，把2.x跳過去了。

      - **Visual C++ 2.1与2.2**可通过订阅服务获得。

  - **Visual C++ 4.0**，发布于1995-12-11\[10\]，引入了Developer Studio IDE，\[11\]集成了MFC 4.0，這個版本是專門為[Windows 95以及](../Page/Windows_95.md "wikilink")[Windows NT設計的](../Page/Windows_NT.md "wikilink")。用戶可以通過[微軟公司的訂閱服務](https://zh.wikipedia.org/wiki/微軟 "wikilink")（[Microsoft](https://zh.wikipedia.org/wiki/Microsoft "wikilink") Subscription Service）升級至4.1版本（包含Microsoft Game SDK）和4.2版本（此版本不再支持[Win32s開發](https://zh.wikipedia.org/wiki/Win32s "wikilink")）。 为支持老的(Windows 3.x/DOS)项目，还包含了Visual C++ 1.52安装光盘。 VC++ 3.0版本号被跳过，以与MFC 4.0的版本号相同.\[12\]

  - **Visual C++ 5.0**，集成了MFC 4.21，发布于1997-04-28,\[13\]。是4.2版以來比較大的一次升級。\[14\]包含了四个版本：

      - Learning版\[15\]
      - Professional,\[16\]
      - Enterprise,\[17\]
      - RISC.\[18\]

  - **Visual C++ 6.0**，集成了MFC 6.0，於1998年8月發行。\[19\]發行至今一直被廣泛地用於大大小小的項目開發。但是，這個版本在Windows XP下運行會出現問題，尤其是在調試模式的情況下（例如：靜態變量的值並不會顯示）。這個調試問題可以通過打一個叫「Visual C++ 6.0 Processor Pack」的補丁來解決。奇怪的是，這個網頁強調用戶也必須運行Windows 98、Windows NT 4.0、或Windows 2000。版本号12.00.8804

  - **Visual C++ .NET 2002**（也即Visual C++ 7.0），於2002年發行，集成了MFC 7.0，支持[鏈接時代碼生成和](https://zh.wikipedia.org/wiki/鏈接時代碼生成 "wikilink")[調試執行時檢查](https://zh.wikipedia.org/wiki/調試執行時檢查 "wikilink")。這個版本還集成了[Managed Extension for C++](https://zh.wikipedia.org/wiki/Managed_Extension_for_C++ "wikilink")，以及一個全新的用戶界面（與[Visual Basic和](../Page/Visual_Basic.md "wikilink")[Visual C\#共用](https://zh.wikipedia.org/wiki/C_Sharp "wikilink")）。這也是為什麼Visual C++ 6.0仍然被廣泛使用的一個主要原因。版本号13.00.9466

  - **Visual C++ .NET 2003**（也即Visual C++ 7.1），集成了MFC 7.1，於2003年發行，是對Visual C++ .NET 2002的一次重大升級。版本号13.10.3077

  - **eMbedded Visual C++**，\[20\]用於[Windows CE操作系统](https://zh.wikipedia.org/wiki/Windows_CE "wikilink")。Visual C++作為一個獨立的開發環境被[Microsoft Visual Studio 2005所替代](../Page/Microsoft_Visual_Studio.md "wikilink")。

### 32/64 - bit版本

  - **Visual C++ 2005**（也即Visual C++ 8.0），集成了MFC 8.0，於2005年11月發佈。這個版本引進了全新版本的[C++/CLI語言以替换](https://zh.wikipedia.org/wiki/C++/CLI "wikilink")[Managed C++](https://zh.wikipedia.org/wiki/Managed_C++ "wikilink")，以及[OpenMP](../Page/OpenMP.md "wikilink")的支持。Visual Studio 2005標準版與專業版有支援x64編譯。
  - **Visual C++ 2008**（也即Visual C++ 9.0），於2007年11月發佈。這個版本支持.NET 3.5。Visual Studio 2008 Team Suite更同時支援x64與IA-64編譯
  - **Visual C++ 2010**（也即Visual C++ 10.0），於2010年4月12日發佈。Visual C++開發團隊考慮使用SQL Server Compact格式的資料庫來儲存源碼的相關資訊\[21\].本版也加入了現代化的C++并行運算庫-Parallel Patterns Library，部分支援C++0x。本版建構於.NET 4.0之上，但仍支持機器碼的編譯。
  - **Visual C++ 2012**（也即Visual C++ 11.0），於2012年8月15日發佈。支持[Windows Runtime开发](../Page/Windows_Runtime.md "wikilink")。\[22\]从该版本起，编译出的32位程序不能在Windows NT4.0 / 2000 / XP上运行，这是因为在程序内部使用了自Vista起出现在kernel32.dll中的GetTickCount64函数。解决办法是在编译project的platform set选择为“Visual Studio 2012 - Windows XP (v110_xp) ”。
  - **Visual C++ 2013**（也即Visual C++ 12.0），於2013年10月17日發佈。支持[C++11](../Page/C++11.md "wikilink")与[C99特性](https://zh.wikipedia.org/wiki/C99 "wikilink")，并引入了REST SDK。\[23\]
      - RTM version number: 18.0.21005.1
      - Update 2 version number: 18.00.30501
  - **Visual C++ 2015**（也即Visual C++ 14.0）於2015年7月20日發佈。\[24\] 改进了对C++11/14/17支持.\[25\]

### MSC版本列表

MSC编译器:\[26\]

``` c++
MSVC++ 14.15 _MSC_VER == 1915 (Visual Studio 2017 version 15.8)
MSVC++ 14.14 _MSC_VER == 1914 (Visual Studio 2017 version 15.7)
MSVC++ 14.13 _MSC_VER == 1913 (Visual Studio 2017 version 15.6)
MSVC++ 14.12 _MSC_VER == 1912 (Visual Studio 2017 version 15.5)
MSVC++ 14.11 _MSC_VER == 1911 (Visual Studio 2017 version 15.3)
MSVC++ 15.0 _MSC_VER == 1910 (Visual Studio 2017)
MSVC++ 14.0 _MSC_VER == 1900 (Visual Studio 2015)
MSVC++ 12.0 _MSC_VER == 1800 (Visual Studio 2013)
MSVC++ 11.0 _MSC_VER == 1700 (Visual Studio 2012)
MSVC++ 10.0 _MSC_VER == 1600 (Visual Studio 2010)
MSVC++ 9.0  _MSC_VER == 1500 (Visual Studio 2008)
MSVC++ 8.0  _MSC_VER == 1400 (Visual Studio 2005)
MSVC++ 7.1  _MSC_VER == 1310 (Visual Studio 2003)
MSVC++ 7.0  _MSC_VER == 1300
MSVC++ 6.0  _MSC_VER == 1200
MSVC++ 5.0  _MSC_VER == 1100
MSVC++ 4.2  _MSC_VER == 1020
MSVC++ 4.0  _MSC_VER == 1000
MSVC++ 2.0  _MSC_VER == 900
MSVC++ 1.0  _MSC_VER == 800
MSC    7.0  _MSC_VER == 700
MSC    6.0  _MSC_VER == 600
MSC    5.0  _MSC_VER == 500
MSC    4.0  _MSC_VER == 400
MSC    3.0  _MSC_VER == 300 第一个微软自行开发，兼容K&R及随后的ANSI C语言标准。1985年发布。
MSC    2.0  _MSC_VER == 200 增加了Large模式（用于16位编程）。
MSC    1.0  _MSC_VER == 100 基于{{tsl|en|Lattice C}}，发布于1983年。
```

## 语言标准支持

### C99

在Visual C++ 2012以前，完全不支持[C99与](https://zh.wikipedia.org/wiki/C99 "wikilink")[C11](../Page/C11.md "wikilink")的新特性，仅支持1989年版的[ANSI C](../Page/ANSI_C.md "wikilink")。\[27\]Visual C++ 2012开始在C模式下支持C99的部分特性，如designated initializers、compound literals、`_Bool`类型。Visual C++ 2013很大改进了对C99特性的支持。\[28\] Visual C++ 2015基本上完整支持了C99标准库，但需要编译器尚未支持的C99语言特性的那部分标准库除外。\[29\]

### C++

至VC++2017 Versi 15.7已经完全实现了[C++17](../Page/C++17.md "wikilink")

详细情况见\[30\]

## 工具链生态环境

  - Universal CRT (UCRT)包含了[C99运行时库的函数与全局变量](https://zh.wikipedia.org/wiki/C99 "wikilink")。UCRT现在是Windows component，随Windows 10安装。UCRT的静态库、DLL的导入库、头文件是Windows 10 SDK的一部分。
  - vcruntime库包含Visual C++ CRT实现相关的代码，如[异常处理](../Page/异常处理.md "wikilink")、调试支持、运行时检查、类型信息、实现细节与特定扩展库函数。 vcruntime库相关于特定编译器。
  - CRT初始化库处理进程启动（CRT startup）、内部的逐线程的初始化、终止。CRT初始化库相关于特定编译器。CRT初始化库总是静态链接，即使使用了动态链接的UCRT.
  - 对于本地代码与受管代码混合的情形，使用/clr编译选项，这会动态链接 UCRT与vcruntime，静态链接msvcmrt.lib或msvcmrtd.lib；svcmrt.lib或msvcmrtd.lib提供了受管代码与本地CRT之间的proxy。对于纯受管代码情形，使用/clr:pure编译选项，这会静态链接msvcurt.lib或msvcurtd.lib。

编译时，根据项目是调试版还是发布版，动态还是静态链接[运行时库](../Page/运行时库.md "wikilink")，编译器可自动使用默认库。如果使用编译选项/nodefaultlib，需要显式指定使用的库。对于VC++2015，所有下述库均为多线程：\[31\]

<table>
<thead>
<tr class="header">
<th><p>情形</p></th>
<th><p>编译选项</p></th>
<th><p>预处理directives</p></th>
<th><p>CRT初始化库<br />
（均为静态链接）</p></th>
<th><p>vcruntime库</p></th>
<th><p>vcruntime DLL</p></th>
<th><p>Universal CRT</p></th>
<th><p>UCRT DLL</p></th>
<th><p>Standard C++库</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>Release DLLs</p></td>
<td><p>/MD</p></td>
<td><p>_MT, _DLL</p></td>
<td><p>msvcrt.lib</p></td>
<td><p>vcruntime.lib</p></td>
<td><p>vcruntime<version>.dll</p></td>
<td><p>ucrt.lib</p></td>
<td><p>ucrtbase.dll</p></td>
<td><p>MSVCPRT.LIB<br />
<small>是MSVCP<version>.dll的输入库</small></p></td>
</tr>
<tr class="even">
<td><p>Debug DLLs</p></td>
<td><p>/MDd</p></td>
<td><p>_DEBUG, _MT, _DLL</p></td>
<td><p>msvcrtd.lib</p></td>
<td><p>vcruntimed.lib</p></td>
<td><p>vcruntime<version>d.dll</p></td>
<td><p>ucrtd.lib</p></td>
<td><p>ucrtbased.dll</p></td>
<td><p>MSVCPRTD.LIB<br />
<small>是MSVCP<version>D.dll的输入库</small></p></td>
</tr>
<tr class="odd">
<td><p>Release Static</p></td>
<td><p>/MT</p></td>
<td><p>_MT</p></td>
<td><p>libcmt.lib</p></td>
<td><p>libvcruntime.lib</p></td>
<td><p>None</p></td>
<td><p>libucrt.lib</p></td>
<td><p>None</p></td>
<td><p>LIBCPMT.LIB</p></td>
</tr>
<tr class="even">
<td><p>Debug Static</p></td>
<td><p>/MTd</p></td>
<td><p>_DEBUG, _MT</p></td>
<td><p>libcmtd.lib</p></td>
<td><p>libvcruntimed.lib</p></td>
<td><p>None</p></td>
<td><p>libucrtd.lib</p></td>
<td><p>None</p></td>
<td><p>LIBCPMTD.LIB</p></td>
</tr>
<tr class="odd">
<td><p>Mixed Release Static</p></td>
<td><p>/clr</p></td>
<td><p>_MT</p></td>
<td><p>msvcmrt.lib</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td><p>Mixed Debug Static</p></td>
<td><p>/clr</p></td>
<td><p>_MT</p></td>
<td><p>msvcmrtd.lib</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td><p>Pure Release Static(过时)</p></td>
<td><p>/clr:pure</p></td>
<td><p>_MT</p></td>
<td><p>msvcurt.lib</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td><p>Pure Debug Static(过时)</p></td>
<td><p>/clr:pure</p></td>
<td><p>_MT</p></td>
<td><p>msvcurtd.lib</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>

### Visual C++运行时库

Visual C++编译出的应用程序，其运行环境通常需要安装Visual C++运行时库。官方下载网址见\[32\]。

## 参考文献

## 外部連結

  - [Visual Studio Express首页](http://msdn2.microsoft.com/zh-cn/express/default.aspx)

  - [Visual Studio Express下载页面](http://msdn2.microsoft.com/zh-cn/express/aa975050.aspx)

  - [微软的Visual C++开发者中心](http://msdn.microsoft.com/visualc/)

  - [微软的Visual C++开发社区](http://msdn.microsoft.com/visualc/community/)

  - [Building Win32 Applications Using Visual C++ 2005 Express](http://blogs.msdn.com/brianjo/archive/2004/08/08/211085.aspx)

  - [Visual C++ STL Templates Tutorial](https://web.archive.org/web/20061118034423/http://wi-fizzle.com/howtos/vc-stl/templates.htm)

{{-}}

[Category:集成开发环境](https://zh.wikipedia.org/wiki/Category:集成开发环境 "wikilink") [Category:C編譯器](https://zh.wikipedia.org/wiki/Category:C編譯器 "wikilink") [Category:C++編譯器](https://zh.wikipedia.org/wiki/Category:C++編譯器 "wikilink") [Category:Microsoft_Visual_Studio](https://zh.wikipedia.org/wiki/Category:Microsoft_Visual_Studio "wikilink")

1.

2.  Retrieved from <http://support.microsoft.com/kb/196831>.

3.

4.
5.
6.

7.

8.

9.

10.

11.

12.

13.
14.

15.

16.

17.

18.

19.

20. Douglas Boling :*Programming Microsoft Windows CE .NET, Third Edition* Microsoft Press; 3rd edition (June 25, 2003) Paperback: 1264 pages ISBN 978-0735618848 - [Companion CD with Microsoft eMbedded Visual C++ 4.0 Service Pack 2](http://examples.oreilly.de/english_examples/9780735618848/cd_contents/Readme.txt)

21.

22.

23.

24.

25.

26.

27.

28.

29.

30. [MSDN: Visual C++ Language Conformance](https://docs.microsoft.com/en-us/cpp/visual-cpp-language-conformance?view=vs-2017)

31. [Visual C++ Team Blog: "Introducing the Universal CRT"](https://blogs.msdn.microsoft.com/vcblog/2015/03/03/introducing-the-universal-crt/)

32. [MSDN: The latest supported Visual C++ downloads](https://support.microsoft.com/en-us/help/2977003/the-latest-supported-visual-c-downloads)
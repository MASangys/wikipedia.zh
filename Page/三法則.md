**三法則**（）在[C++裡](../Page/C++.md "wikilink")，它是一個以設計的基本原則而制定的定律。它的要求是，假如[类有明顯](../Page/类_\(计算机科学\).md "wikilink")下列其中一個成員函式，那麼[程序员必須寫入其他兩個](../Page/程序员.md "wikilink")[成員函式到類別內](../Page/方法_\(電腦科學\).md "wikilink")，也就是說下列三個成員函式缺一不可
\[1\]。

  - [解構子](../Page/解構子.md "wikilink")
  - [複製建構子](../Page/複製建構子.md "wikilink")
  - [設定運算子 (C++)](../Page/設定運算子_\(C++\).md "wikilink")

上述三個函式是，假如程式設計師沒有自行定義或宣告這三個函式，編譯器會自動地建立他們並且編譯到應用程式內。然而，如果程式設計師僅定義其中一個，其餘兩個函式仍然會由編譯器自動產生，這種混雜的情況非常容易產生程式設計師難以預期的錯誤。三法則的存在，正是提醒程式設計師避免那樣的陷阱。
三法則這個專有名詞是由馬歇爾·克來恩於1991年創立的\[2\]。

它的修正版本是，假如類別有用到[RAII](../Page/RAII.md "wikilink")，可以不必定義解構子，也就是所謂的二大定律\[3\]。
因為隱性產生的建構子與設定運算子可以很容易地複製類別內所有的資料成員\[4\]，當資料成員是指標型態時，指標位址會隨著類別而跟著被複製。要注意的是，直接地複製指標位址是一項非常危險的動作，所以只要類別有封裝指標型態的資料結構，或是類別有封裝外部參照的資料成員，例如指標型態的資料成員，程式設計師應該為此而定義顯性的複製建構子與設定運算子。

## 五法則

[C++11新增兩個法則](../Page/C++11.md "wikilink")，稱為**五法则**：

  - 解構子
  - 複製建構子
  - 設定運算子
  - 移動建構子
  - 移動指定運算子

## 範例

<table>
<caption>C/C++ 原始碼三法則範例</caption>
<thead>
<tr class="header">
<th><p><a href="../Page/头文件.md" title="wikilink">头文件</a> header.h</p></th>
<th><p><a href="../Page/主函式.md" title="wikilink">主函式</a> main.cpp |- valign = "top"</p></th>
<th><div class="sourceCode" id="cb1"><pre class="sourceCode cpp"><code class="sourceCode cpp"><a class="sourceLine" id="cb1-1" title="1"><span class="pp">#ifndef _HEADER_H_</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="pp">#define _</span>HEADER_H_</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="co">//</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="co">// 判斷是否為微軟編譯器</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="pp">#ifndef _MSC_VER</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="pp">#undef NULL</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="pp">#define NULL </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="pp">#endif</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="co">//</span></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="pp">#include </span><span class="im">&lt;limits&gt;</span></a>
<a class="sourceLine" id="cb1-12" title="12"><span class="co">//</span></a>
<a class="sourceLine" id="cb1-13" title="13"><span class="kw">using</span> <span class="bu">std::</span>cin;</a>
<a class="sourceLine" id="cb1-14" title="14"><span class="kw">using</span> <span class="bu">std::</span>cout;</a>
<a class="sourceLine" id="cb1-15" title="15"><span class="kw">using</span> <span class="bu">std::</span>endl;</a>
<a class="sourceLine" id="cb1-16" title="16"><span class="co">//</span></a>
<a class="sourceLine" id="cb1-17" title="17"><span class="co">// 類別：方塊</span></a>
<a class="sourceLine" id="cb1-18" title="18"><span class="kw">class</span> CCube</a>
<a class="sourceLine" id="cb1-19" title="19">{</a>
<a class="sourceLine" id="cb1-20" title="20"><span class="kw">public</span>:</a>
<a class="sourceLine" id="cb1-21" title="21">    <span class="co">// 建構子</span></a>
<a class="sourceLine" id="cb1-22" title="22">    CCube();</a>
<a class="sourceLine" id="cb1-23" title="23">    <span class="co">// 含有參數的建構子</span></a>
<a class="sourceLine" id="cb1-24" title="24">    CCube(<span class="dt">double</span> length, <span class="dt">double</span> width, <span class="dt">double</span> height);</a>
<a class="sourceLine" id="cb1-25" title="25">    <span class="co">// 三法則：解構子</span></a>
<a class="sourceLine" id="cb1-26" title="26">    ~CCube();</a>
<a class="sourceLine" id="cb1-27" title="27">    <span class="co">// 三法則：複製建構子</span></a>
<a class="sourceLine" id="cb1-28" title="28">    CCube(<span class="at">const</span> CCube &amp;sample);</a>
<a class="sourceLine" id="cb1-29" title="29">    <span class="co">// 三法則：設定運算子</span></a>
<a class="sourceLine" id="cb1-30" title="30">    CCube&amp; <span class="kw">operator</span>=(<span class="at">const</span> CCube &amp;sample);</a>
<a class="sourceLine" id="cb1-31" title="31">    <span class="co">// 設定長寬高</span></a>
<a class="sourceLine" id="cb1-32" title="32">    <span class="dt">void</span> setLength(<span class="dt">double</span> length);</a>
<a class="sourceLine" id="cb1-33" title="33">    <span class="dt">void</span> setWidth(<span class="dt">double</span> width);</a>
<a class="sourceLine" id="cb1-34" title="34">    <span class="dt">void</span> setHeight(<span class="dt">double</span> height);</a>
<a class="sourceLine" id="cb1-35" title="35">    <span class="co">// 取得長寬高</span></a>
<a class="sourceLine" id="cb1-36" title="36">    <span class="dt">double</span> getLength() <span class="at">const</span>;</a>
<a class="sourceLine" id="cb1-37" title="37">    <span class="dt">double</span> getWidth() <span class="at">const</span>;</a>
<a class="sourceLine" id="cb1-38" title="38">    <span class="dt">double</span> getHeight() <span class="at">const</span>;</a>
<a class="sourceLine" id="cb1-39" title="39">    <span class="co">// 計算體積</span></a>
<a class="sourceLine" id="cb1-40" title="40">    <span class="dt">double</span> getVolume() <span class="at">const</span>;</a>
<a class="sourceLine" id="cb1-41" title="41"><span class="kw">protected</span>:</a>
<a class="sourceLine" id="cb1-42" title="42"><span class="kw">private</span>:</a>
<a class="sourceLine" id="cb1-43" title="43">    <span class="co">// 長寬高</span></a>
<a class="sourceLine" id="cb1-44" title="44">    <span class="dt">double</span> <span class="va">m_Length</span>;</a>
<a class="sourceLine" id="cb1-45" title="45">    <span class="dt">double</span> <span class="va">m_Width</span>;</a>
<a class="sourceLine" id="cb1-46" title="46">    <span class="dt">double</span> <span class="va">m_Height</span>;</a>
<a class="sourceLine" id="cb1-47" title="47">};</a>
<a class="sourceLine" id="cb1-48" title="48"><span class="co">//</span></a>
<a class="sourceLine" id="cb1-49" title="49"><span class="dt">void</span> PAUSE(<span class="dt">void</span>);</a>
<a class="sourceLine" id="cb1-50" title="50"><span class="co">//</span></a>
<a class="sourceLine" id="cb1-51" title="51"><span class="pp">#endif</span></a></code></pre></div></th>
<th><div class="sourceCode" id="cb2"><pre class="sourceCode cpp"><code class="sourceCode cpp"><a class="sourceLine" id="cb2-1" title="1"><span class="pp">#include</span><span class="im">&quot;header.h&quot;</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="co">//</span></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="co">// 判斷是否為微軟編譯器</span></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="pp">#ifndef _MSC_VER</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="dt">int</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="pp">#else</span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="dt">void</span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="pp">#endif</span></a>
<a class="sourceLine" id="cb2-9" title="9">main(<span class="dt">int</span> argc, <span class="dt">char</span>* argv[])</a>
<a class="sourceLine" id="cb2-10" title="10">{</a>
<a class="sourceLine" id="cb2-11" title="11">    <span class="co">// 方塊零</span></a>
<a class="sourceLine" id="cb2-12" title="12">    CCube cube0(<span class="fl">4.3</span>, <span class="fl">5.2</span>, <span class="fl">6.1</span>);</a>
<a class="sourceLine" id="cb2-13" title="13">    <span class="co">// 第一個方塊</span></a>
<a class="sourceLine" id="cb2-14" title="14">    {</a>
<a class="sourceLine" id="cb2-15" title="15">        cout &lt;&lt; <span class="st">&quot;=== No.1 cube ===&quot;</span> &lt;&lt; endl;</a>
<a class="sourceLine" id="cb2-16" title="16">        CCube cube1 = cube0;</a>
<a class="sourceLine" id="cb2-17" title="17">        cout &lt;&lt; <span class="st">&quot;Volume of cube = &quot;</span> &lt;&lt; cube1.getVolume() &lt;&lt; endl;</a>
<a class="sourceLine" id="cb2-18" title="18">    }</a>
<a class="sourceLine" id="cb2-19" title="19">    <span class="co">// 第二個方塊</span></a>
<a class="sourceLine" id="cb2-20" title="20">    {</a>
<a class="sourceLine" id="cb2-21" title="21">        cout &lt;&lt; <span class="st">&quot;=== No.2 cube ===&quot;</span> &lt;&lt; endl;</a>
<a class="sourceLine" id="cb2-22" title="22">        CCube cube2;</a>
<a class="sourceLine" id="cb2-23" title="23">        cube2 = cube0;</a>
<a class="sourceLine" id="cb2-24" title="24">        cout &lt;&lt; <span class="st">&quot;Volume of cube = &quot;</span> &lt;&lt; cube2.getVolume() &lt;&lt; endl;</a>
<a class="sourceLine" id="cb2-25" title="25">    }</a>
<a class="sourceLine" id="cb2-26" title="26">    PAUSE();</a>
<a class="sourceLine" id="cb2-27" title="27">    <span class="cf">return</span></a>
<a class="sourceLine" id="cb2-28" title="28"><span class="pp">#ifndef _MSC_VER</span></a>
<a class="sourceLine" id="cb2-29" title="29">        EXIT_SUCCESS</a>
<a class="sourceLine" id="cb2-30" title="30"><span class="pp">#endif</span></a>
<a class="sourceLine" id="cb2-31" title="31">        ;</a>
<a class="sourceLine" id="cb2-32" title="32">}</a></code></pre></div></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><a href="../Page/头文件.md" title="wikilink">头文件實作</a> header.cpp</p></td>
<td><p>|- valign = "top"</p></td>
<td><div class="sourceCode" id="cb3"><pre class="sourceCode cpp"><code class="sourceCode cpp"><a class="sourceLine" id="cb3-1" title="1"><span class="pp">#include </span><span class="im">&quot;header.h&quot;</span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="co">//</span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="dt">void</span> PAUSE(<span class="dt">void</span>)</a>
<a class="sourceLine" id="cb3-4" title="4">{</a>
<a class="sourceLine" id="cb3-5" title="5">    cin.clear();</a>
<a class="sourceLine" id="cb3-6" title="6">    cin.ignore(<span class="bu">std::</span>numeric_limits&lt;<span class="bu">std::</span>streamsize&gt;::max(), <span class="ch">&#39;</span><span class="sc">\n</span><span class="ch">&#39;</span>);</a>
<a class="sourceLine" id="cb3-7" title="7">    cout &lt;&lt; <span class="st">&quot;press any key to continue...&quot;</span>;</a>
<a class="sourceLine" id="cb3-8" title="8">    cin.get();</a>
<a class="sourceLine" id="cb3-9" title="9">}</a>
<a class="sourceLine" id="cb3-10" title="10">CCube::CCube()</a>
<a class="sourceLine" id="cb3-11" title="11">{</a>
<a class="sourceLine" id="cb3-12" title="12">    cout &lt;&lt; <span class="st">&quot;Constructor: CCube()&quot;</span> &lt;&lt; endl;</a>
<a class="sourceLine" id="cb3-13" title="13">    <span class="kw">this</span>-&gt;<span class="va">m_Length</span> = <span class="fl">0.0</span>;</a>
<a class="sourceLine" id="cb3-14" title="14">    <span class="kw">this</span>-&gt;<span class="va">m_Width</span> = <span class="fl">0.0</span>;</a>
<a class="sourceLine" id="cb3-15" title="15">    <span class="kw">this</span>-&gt;<span class="va">m_Height</span> = <span class="fl">0.0</span>;</a>
<a class="sourceLine" id="cb3-16" title="16">}</a>
<a class="sourceLine" id="cb3-17" title="17">CCube::CCube(<span class="dt">double</span> length, <span class="dt">double</span> width, <span class="dt">double</span> height)</a>
<a class="sourceLine" id="cb3-18" title="18">{</a>
<a class="sourceLine" id="cb3-19" title="19">    cout &lt;&lt; <span class="st">&quot;Constructor: CCube(length, width, height)&quot;</span> &lt;&lt; endl;</a>
<a class="sourceLine" id="cb3-20" title="20">    <span class="kw">this</span>-&gt;<span class="va">m_Length</span> = length;</a>
<a class="sourceLine" id="cb3-21" title="21">    <span class="kw">this</span>-&gt;<span class="va">m_Width</span> = width;</a>
<a class="sourceLine" id="cb3-22" title="22">    <span class="kw">this</span>-&gt;<span class="va">m_Height</span> = height;</a>
<a class="sourceLine" id="cb3-23" title="23">}</a>
<a class="sourceLine" id="cb3-24" title="24">CCube::~CCube()</a>
<a class="sourceLine" id="cb3-25" title="25">{</a>
<a class="sourceLine" id="cb3-26" title="26">    cout &lt;&lt; <span class="st">&quot;Destructor: ~CCube()&quot;</span> &lt;&lt; endl;</a>
<a class="sourceLine" id="cb3-27" title="27">    <span class="kw">this</span>-&gt;<span class="va">m_Length</span> = <span class="fl">0.0</span>;</a>
<a class="sourceLine" id="cb3-28" title="28">    <span class="kw">this</span>-&gt;<span class="va">m_Width</span> = <span class="fl">0.0</span>;</a>
<a class="sourceLine" id="cb3-29" title="29">    <span class="kw">this</span>-&gt;<span class="va">m_Height</span> = <span class="fl">0.0</span>;</a>
<a class="sourceLine" id="cb3-30" title="30">}</a>
<a class="sourceLine" id="cb3-31" title="31">CCube::CCube(<span class="at">const</span> CCube &amp;sample)</a>
<a class="sourceLine" id="cb3-32" title="32">{</a>
<a class="sourceLine" id="cb3-33" title="33">    cout &lt;&lt; <span class="st">&quot;Copy constructor: CCube(const CCube &amp;sample)&quot;</span> &lt;&lt; endl;</a>
<a class="sourceLine" id="cb3-34" title="34">    <span class="co">//</span></a>
<a class="sourceLine" id="cb3-35" title="35">    <span class="co">// 保護：禁止設值給自己</span></a>
<a class="sourceLine" id="cb3-36" title="36">    <span class="cf">if</span> (<span class="kw">this</span> != &amp;sample)</a>
<a class="sourceLine" id="cb3-37" title="37">    {</a>
<a class="sourceLine" id="cb3-38" title="38">        <span class="kw">this</span>-&gt;<span class="va">m_Length</span> = sample.<span class="va">m_Length</span>;</a>
<a class="sourceLine" id="cb3-39" title="39">        <span class="kw">this</span>-&gt;<span class="va">m_Width</span> = sample.<span class="va">m_Width</span>;</a>
<a class="sourceLine" id="cb3-40" title="40">        <span class="kw">this</span>-&gt;<span class="va">m_Height</span> = sample.<span class="va">m_Height</span>;</a>
<a class="sourceLine" id="cb3-41" title="41">    }</a>
<a class="sourceLine" id="cb3-42" title="42">}</a>
<a class="sourceLine" id="cb3-43" title="43">CCube&amp; CCube::<span class="kw">operator</span>=(<span class="at">const</span> CCube &amp;sample)</a>
<a class="sourceLine" id="cb3-44" title="44">{</a>
<a class="sourceLine" id="cb3-45" title="45">    cout &lt;&lt; <span class="st">&quot;Assignment operator: operator=(const CCube &amp;sample)&quot;</span> &lt;&lt; endl;</a>
<a class="sourceLine" id="cb3-46" title="46">    <span class="co">//</span></a>
<a class="sourceLine" id="cb3-47" title="47">    <span class="co">// 保護：禁止設值給自己</span></a>
<a class="sourceLine" id="cb3-48" title="48">    <span class="cf">if</span> (<span class="kw">this</span> != &amp;sample)</a>
<a class="sourceLine" id="cb3-49" title="49">    {</a>
<a class="sourceLine" id="cb3-50" title="50">        <span class="kw">this</span>-&gt;<span class="va">m_Length</span> = sample.<span class="va">m_Length</span>;</a>
<a class="sourceLine" id="cb3-51" title="51">        <span class="kw">this</span>-&gt;<span class="va">m_Width</span> = sample.<span class="va">m_Width</span>;</a>
<a class="sourceLine" id="cb3-52" title="52">        <span class="kw">this</span>-&gt;<span class="va">m_Height</span> = sample.<span class="va">m_Height</span>;</a>
<a class="sourceLine" id="cb3-53" title="53">    }</a>
<a class="sourceLine" id="cb3-54" title="54">    <span class="cf">return</span> *<span class="kw">this</span>;</a>
<a class="sourceLine" id="cb3-55" title="55">}</a>
<a class="sourceLine" id="cb3-56" title="56"><span class="dt">double</span> CCube::getVolume() <span class="at">const</span></a>
<a class="sourceLine" id="cb3-57" title="57">{</a>
<a class="sourceLine" id="cb3-58" title="58">    <span class="cf">return</span> (<span class="kw">this</span>-&gt;<span class="va">m_Length</span> * <span class="kw">this</span>-&gt;<span class="va">m_Width</span> * <span class="kw">this</span>-&gt;<span class="va">m_Height</span>);</a>
<a class="sourceLine" id="cb3-59" title="59">}</a></code></pre></div></td>
<td></td>
</tr>
</tbody>
</table>

## 注釋

## 參考資料

## 相關條目

  - [C++類](../Page/C++類.md "wikilink")
  - [类 (计算机科学)](../Page/类_\(计算机科学\).md "wikilink")

[Category:C++](https://zh.wikipedia.org/wiki/Category:C++ "wikilink")
[Category:带有C++代码示例的条目](https://zh.wikipedia.org/wiki/Category:带有C++代码示例的条目 "wikilink")

1.
2.
3.
4.
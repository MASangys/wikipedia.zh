在[多元变量统计中](https://zh.wikipedia.org/wiki/多元变量统计 "wikilink")，如果
\(\varepsilon\) 为 \(n\)
维[随机向量](https://zh.wikipedia.org/wiki/随机向量 "wikilink")，
\(\Lambda\) 是一个 \(n\)
维[对称矩阵](../Page/對稱矩陣.md "wikilink")，则[随机变量](../Page/随机变量.md "wikilink")
\(\varepsilon^T\Lambda\varepsilon\) 称为 \(\varepsilon\) 的二次型。

## 期望

二次型的期望可表示为，\[1\]

\[\operatorname{E}\left[\varepsilon^T\Lambda\varepsilon\right]=\operatorname{tr}\left[\Lambda \Sigma\right] + \mu^T\Lambda\mu\]

其中，\(\mu\) 和 \(\Sigma\) 分别表示 \(\varepsilon\)
的[期望值](../Page/期望值.md "wikilink")
和[方差-协方差矩阵](../Page/协方差矩阵.md "wikilink")， tr
为矩阵的[迹](https://zh.wikipedia.org/wiki/迹 "wikilink")。其结果仅仅取决于是否存在
\(\mu\) 和
\(\Sigma\)；并且，\(\varepsilon\) 的[正态性不是必要条件](../Page/多元正态分布.md "wikilink")。

关于随机变量的二次型参考书籍 \[2\]

### 证明

由于二次型是标量，所以二次型的迹就是它本身\(\operatorname{E}\left[\varepsilon^T\Lambda\varepsilon\right] = \operatorname{tr}(\operatorname{E}[\varepsilon^T\Lambda\varepsilon])\)。

由于矩阵的迹是其对角线元素之和（即矩阵元素线性组合的结果），因此服从期望的线性，有

  -
    \(\operatorname{tr}(\operatorname{E} \left[ \varepsilon^T \Lambda \varepsilon \right]) = \operatorname{E}[\operatorname{tr}(\varepsilon^T\Lambda\varepsilon)].\)

利用[迹的可交换性](https://zh.wikipedia.org/wiki/迹 "wikilink")，

\[\operatorname{E}[\operatorname{tr}(\varepsilon^T\Lambda\varepsilon)] = \operatorname{E}[\operatorname{tr}(\Lambda\varepsilon\varepsilon^T)].\]

由期望的线性可得

  -
    \(\operatorname{E}[\operatorname{tr}(\Lambda\varepsilon\varepsilon^T)] = \operatorname{tr}(\Lambda \operatorname{E}(\varepsilon\varepsilon^T)).\)

由方差的标准属性可知：

  -
    \(\operatorname{tr}(\Lambda (\Sigma + \mu \mu^T)).\)

再次应用[迹的可交换性可得](https://zh.wikipedia.org/wiki/迹 "wikilink")：

  -
    \(\operatorname{tr}(\Lambda\Sigma) + \operatorname{tr}(\Lambda \mu \mu^T) = \operatorname{tr}(\Lambda\Sigma) + \operatorname{tr}(\mu^T\Lambda\mu) = \operatorname{tr}(\Lambda\Sigma) + \mu^T\Lambda\mu.\)

## 方差

通常情况下，二次型的方差在很大程度上取决于 \(\varepsilon\) 的分布。 然而，如果
\(\varepsilon\) 服从[多元正态分布](../Page/多元正态分布.md "wikilink")，则二次型的方差的求解非常容易。假设 \(\Lambda\)
是一个对称矩阵，则有，

\[\operatorname{var} \left[\varepsilon^T\Lambda\varepsilon\right] = 2\operatorname{tr}\left[\Lambda \Sigma\Lambda \Sigma\right] + 4\mu^T\Lambda\Sigma\Lambda\mu\]
\[3\].

事实上，这可以推广到同一向量 \(\varepsilon\) 的两个二次型的[协方差计算中](../Page/协方差.md "wikilink")
(注意, \(\Lambda_1\) 和 \(\Lambda_2\) 必须都是对称矩阵):

\[\operatorname{cov}\left[\varepsilon^T\Lambda_1\varepsilon,\varepsilon^T\Lambda_2\varepsilon\right]=2\operatorname{tr}\left[\Lambda _1\Sigma\Lambda_2 \Sigma\right] + 4\mu^T\Lambda_1\Sigma\Lambda_2\mu\]。

### 不对称矩阵的方差计算

在某些参考资料中，在 \(\Lambda\) 为非对称矩阵情况下，也错误地得到了上述方差/协方差的结果。 在一般情况下，\(\Lambda\)
可以通过下面方式得到：

\[\varepsilon^T\Lambda^T\varepsilon=\varepsilon^T\Lambda\varepsilon\]

因此

\[\varepsilon^T\tilde{\Lambda}\varepsilon=\varepsilon^T\left(\Lambda+\Lambda^T\right)\varepsilon/2\]

但是，这**是**一个二次型的对称矩阵
\(\tilde{\Lambda}=\left(\Lambda+\Lambda^T\right)/2\)，所以其[均值和](https://zh.wikipedia.org/wiki/均值 "wikilink")[方差表达式相同](../Page/方差.md "wikilink")，只是将
\(\Lambda\) 替换为 \(\tilde{\Lambda}\)。

## 二次型举例

设有观测值的集合 \(y\) 和运算矩阵 \(H\)，则 \(y\)
的[残差平方和可表示为其二次型](https://zh.wikipedia.org/wiki/残差平方和 "wikilink")：

<div class="_1BN1N Kzi1t _3OU5v _2DJZN" style="z-index: 2; transform: translate(314.297px, 2121px);">

<div class="_1HjH7">

</div>

</div>

\[\textrm{RSS}=y^T(I-H)^T (I-H)y.\]

其中，矩阵 \(H\) 为[对称和](../Page/對稱矩陣.md "wikilink")[等幂的](https://zh.wikipedia.org/wiki/等幂 "wikilink")，其误差为协方差矩阵为
\(\sigma^2I\) 的[高斯分布](https://zh.wikipedia.org/wiki/高斯分布 "wikilink"),
\(\textrm{RSS}/\sigma^2\) 为自由度是 \(k\)
的[卡方分布](https://zh.wikipedia.org/wiki/卡方分布 "wikilink")，参数为 \(\lambda\)，有

\[k=\operatorname{tr}\left[(I-H)^T(I-H)\right]\]

\[\lambda=\mu^T(I-H)^T(I-H)\mu/2\]

如果
\(Hy\) 在估计 \(\mu\) 时没有[偏差](https://zh.wikipedia.org/wiki/偏差 "wikilink")，则参数 \(\lambda\) 为零且 \(\textrm{RSS}/\sigma^2\)
服从[中心卡方分布](https://zh.wikipedia.org/wiki/中心卡方分布 "wikilink")。

## 参考文献

<div class="_1BN1N Kzi1t _2DJZN" style="z-index: 2; transform: translate(314.297px, 2592.81px);">

<div class="_1HjH7">

</div>

</div>

## 参看

<div class="_1BN1N Kzi1t _2DJZN" style="z-index: 2; transform: translate(314.297px, 2945.41px);">

<div class="_1HjH7">

</div>

</div>

  - [二次型](../Page/二次型.md "wikilink")
  - [协方差矩阵](../Page/协方差矩阵.md "wikilink")

<div class="_1BN1N Kzi1t _2DJZN" style="z-index: 2; transform: translate(314.297px, 3010.39px);">

<div class="_1HjH7">

</div>

</div>

[Category:二次型](https://zh.wikipedia.org/wiki/Category:二次型 "wikilink")
[Category:統計理論](https://zh.wikipedia.org/wiki/Category:統計理論 "wikilink")

1.
2.
3.
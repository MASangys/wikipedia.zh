在[随机分析中](https://zh.wikipedia.org/wiki/随机分析 "wikilink")，**伊藤引理**（Ito's
lemma）是一条非常重要的性质。發現者為日本數學家[伊藤清](../Page/伊藤清.md "wikilink")，他指出了对于一个[随机过程的函数作微分的规则](../Page/随机过程.md "wikilink")。

## 伊藤引理较早版本

### 第一引理

对于[布朗运动](../Page/布朗运动.md "wikilink")\(W_t\)和二次[可导](https://zh.wikipedia.org/wiki/可导 "wikilink")[函数](../Page/函数.md "wikilink")\(f(x)\)，以下等式成立：

\[df(W_t) = f'(W_t)dW_t + \frac{1}{2} f''(W_t)dt\]

其主要可通过对[多项式环到](../Page/多项式环.md "wikilink")[形式幂级数的拓展](../Page/形式幂级数.md "wikilink")，例如：

\[de^{W_t^2}= 2W_t e^{W_t^2} dW_t + (e^{W_t^2} + 2W_t^2 e^{W_t^2} )dt\]

### 第二引理

对于[布朗运动](../Page/布朗运动.md "wikilink")\(X_t\)和二次[可导](https://zh.wikipedia.org/wiki/可导 "wikilink")[函数](../Page/函数.md "wikilink")\(f(t,x)\)，以下等式成立

\[df(t,X_t) = \left(\frac{\partial f}{\partial t}  + \frac{1}{2} \frac{\partial^2 f}{\partial x^2}\right)d<X,X>_t + \frac{\partial f}{\partial x} dX_t\]

### 第三引理

定义[伊藤过程](https://zh.wikipedia.org/wiki/伊藤过程 "wikilink")\(X_t\)为满足下列[随机微分方程的随机过程](https://zh.wikipedia.org/wiki/随机微分方程 "wikilink")

\[dX_t= \mu_t \, dt + \sigma_t \, dW_t\]
对于伊藤过程\(X_t\)和二次[可导](https://zh.wikipedia.org/wiki/可导 "wikilink")[函数](../Page/函数.md "wikilink")\(f(t,x)\)，以下等式成立

\[df(t,X_t) =\left(\frac{\partial f}{\partial t} + \mu_t\frac{\partial f}{\partial x}  + \frac{1}{2}\sigma_t^2\frac{\partial^2f}{\partial x^2}\right)dt + \sigma_t\frac{\partial f}{\partial x} \,dW_t.\]

## 到[半鞅的拓展](https://zh.wikipedia.org/wiki/半鞅 "wikilink")

### 连续半鞅

\[df(X_t) = \sum_{i=1}^d f_{i}(X_t)\,dX^i_t + \frac{1}{2}\sum_{i,j=1}^df_{i,j}(X_t)\,d[X^i,X^j]_t.\]

### 不连续半鞅

\[\begin{align}
f(X_t)= & f(X_0)+\sum_{i=1}^d\int_0^t f_{i}(X_{s-})\,dX^i_s + \frac{1}{2}\sum_{i,j=1}^d \int_0^t f_{i,j}(X_{s-})\,d[X^i,X^j]_s\\
&{} + \sum_{s\le t}\left(\Delta f(X_s)-\sum_{i=1}^df_{i}(X_{s-})\,\Delta X^i_s-\frac{1}{2}\sum_{i,j=1}^d f_{i,j}(X_{s-})\,\Delta X^i_s \, \Delta X^j_s\right).
\end{align}\]

### 泊松过程

我们也可以定义非连续随机过程的函数。

定义跳跃强度*h*，根据跳跃的[泊松过程模型](../Page/泊松过程.md "wikilink")，在区间\([t,\ t + \Delta t]\)上出现一次跳跃的概率是\(h \Delta t\)
加上\(\Delta t\)的高阶无穷小量。*h*可以是常数、显含时间的确定性函数，或者是随机过程。在区间\([0,t]\)上没有跳跃的概率称为生存概率\(p_s(t)\)，其变化是：

\[d p_s(t) = -p_s(t) h(t) \, dt.\] 因此生存概率为：

\[p_s(t) = \exp \left(-\int_0^t h(u) \, du \right).\]

定义非连续随机过程\(S(t)\)，并把\(S(t^-)\)记为从左侧到达*t*时*S*的值，记\(d_j S(t)\)是一次跳跃导致\(S(t)\)的非无穷小变化。有：

\[d_j S(t)=\lim_{\Delta t \to 0}(S(t+\Delta t)-S(t^-))\]

\(\eta(S(t^-),z)\)是跳跃幅度*z*的[概率分布](../Page/概率分布.md "wikilink")，跳跃幅度的期望值是：

\[E[d_j S(t)]=h(S(t^-)) \, dt \int_z z \eta(S(t^-),z) \, dz.\]

定义补偿过程和[鞅](https://zh.wikipedia.org/wiki/鞅 "wikilink")\(d J_S(t)\)：

\[d J_S(t)=d_j S(t)-E[d_j S(t)]=S(t)-S(t^-)-(h(S(t^-)) \int_z z \eta(S(t^-),z) \, dz) \, dt.\]
因此跳跃的非无穷小变化，也就是随机过程的跳跃部分可以写为：

\[d_j S(t) = E[d_j S(t)] + d J_S(t) = h(S(t^-)) (\int_z z \eta(S(t^-),z) \, dz) dt + d J_S(t).\]

因此如果随机过程\(S\)同时包含漂移、扩散、跳跃三部分，可以写为：

\[d S(t) = \mu dt + \sigma dW(t) + d_j S(t).\]

考虑其函数\(g(S(t),t)\)。\(S(t)\)跳跃\(\Delta s\)的幅度，会导致\(g(t)\)跳跃\(\Delta g\)幅度。\(\Delta g\)取决于g的跳跃分布\(\eta_g()\)，有可能依赖于跳跃前的函数值\(g(t^-)\)，函数微分*dg*以及跳跃前的自变量值\(S(t^-)\)。\(g\)的跳跃部分是：

\[\begin{align}
g(t)-g(t^-) & =h(t) \, dt \int_{\Delta g} \, \Delta g \eta_g(\cdot) \, d\Delta g + d J_g(t).
\end{align}\]

函数\(g(S(t),t)\)的伊藤引理是：

\[\begin{align}
d g(t) & = \left( \frac{\partial g}{\partial t}+\mu \frac{\partial g}{\partial S}+\frac{1}{2} \sigma^2 \frac{\partial^2 g}{\partial S^2}+h(t)\int_{\Delta g} (\Delta g \eta_g(\cdot) \, d{\Delta}g) \, \right) dt + \frac{\partial g}{\partial S} \sigma \, d W(t) + d J_g(t).
\end{align}\]

可以看到，漂移-扩散过程与跳跃过程之和的伊藤引理，恰恰是各自部分伊藤引理的和。

## 应用例子

### 布莱克-舒尔兹模型

伊藤引理可以用于推导[布莱克-舒尔兹模型](../Page/布莱克-舒尔兹模型.md "wikilink")。假设一支股票的价格服从几何布朗运动\(dS=\mu Sdt +\sigma SdW\)，且其期权的价格是股票价格和时间的函数\(V=f(t,S)\)。根据伊藤引理，有

\[df = \left(\frac{\partial f}{\partial t} + \mu S\frac{\partial f}{\partial S} + \frac{1}{2}\sigma^2S^2\frac{\partial^2 f}{\partial S^2}\right)\,dt +\sigma S\frac{\partial f}{\partial S}\,dW\]
整理可得

\[df = \left(\frac{\partial f}{\partial t} + \frac{1}{2}\sigma^2S^2\frac{\partial^2 f}{\partial S^2}\right)\,dt +\frac{\partial f}{\partial S}\,dS\]
式中\(\frac{\partial f}{\partial S}\,dS\)项表明期权价格的波动等于持有\(\frac{\partial f}{\partial S}\)单位股票时的波动。在这个对应下，现金的部分应该以无风险利率\(r\)增长，即

\[df = r\left(f-S\frac{\partial f}{\partial S}\right)\,dt + \frac{\partial f}{\partial S}\,dS\]
比较两式\(dt\)项的系数，可得

\[\frac{\partial f}{\partial t} + \frac{1}{2}\sigma^2S^2\frac{\partial^2 f}{\partial S^2} + rS\frac{\partial f}{\partial S}-rf = 0\]

## 参看

  - [费曼－卡茨公式](../Page/费曼－卡茨公式.md "wikilink")

## 參考資料

  - Ito, K. (1944): Stochastic integral. Proc. Imp. Acad. Tokyo 20,
    519-524.
  - PROTTER, P. (1990): Stochastic Integration and Differential
    Equations. Springer-Verlag, Berlin.
  - Black, F. & Scholes, M. (1973) :The pricing of options and corporate
    liabilities. J. Polit. Economy

[Category:金融数学](https://zh.wikipedia.org/wiki/Category:金融数学 "wikilink")
[Category:随机过程](https://zh.wikipedia.org/wiki/Category:随机过程 "wikilink")
[Category:引理](https://zh.wikipedia.org/wiki/Category:引理 "wikilink")
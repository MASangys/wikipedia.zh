> 本文内容由[休眠 \(電腦\)](https://zh.wikipedia.org/wiki/休眠_\(電腦\))转换而来。


**休眠**（或**挂起到磁盘**）在[计算机科学](../Page/计算机科学.md "wikilink")中的含义指在关闭计算机的同时保持其运行状态。

通过休眠，電腦将[記憶體中的内容保存至](https://zh.wikipedia.org/wiki/記憶體 "wikilink")[硬碟或其它](https://zh.wikipedia.org/wiki/硬碟 "wikilink")[非揮發性記憶體](../Page/非揮發性記憶體.md "wikilink")中，并在下次开机时从硬碟中将这些内容重新载入，使電腦还原到与休眠前一致的状态。

当用作保存电池电量的手段时，休眠与睡眠模式类似，不过比后者节约更多的电量，代价则是从休眠中恢复时速度更慢（因为硬碟的速度比記憶體慢得多）。

## 用途

休眠可以节省电力，在休眠后，電腦硬體接近完全断电的状态，但又与一般的关机有所不同，一小部分电力继续为CMOS供电，以防止用户在下次开机恢复系统前进入BIOS設定。休眠的電腦耗电要比处于睡眠模式下少。休眠是一种减轻在关机前处理未保存数据并重新打开所有正在运行的程序的负担的手段。

休眠通常使用在[筆記型電腦](../Page/筆記型電腦.md "wikilink")中，因为筆記型電腦的电池容量通常是有限的，而休眠可以由操作系统在低电量报警时自动触发。大多数台式机亦同样支援休眠，主要是为了节省能源。

## 存在的问题

某些情况下休眠可能导致重新开机时出现错误，这是由于休眠的程序设计，或者存在不兼容的设备或软件所致。休眠通常也会导致外围设备的连接中断，从而在再次开机时引发与此相关的问题。

一些机构，主要是大型企业，通过各种手段（如网络策略等）强制要求计算机在一段时间无操作后进行自动休眠，主要是出于节省电费的考量，然而通常也会导致工作效率的下降，因为员工返回时必须等待机器从休眠中恢复，而机械硬盘的速度通常又很慢，导致恢复所需的时间延长。

休眠所导致的另一个问题（主要在Windows设备上）是系统会破坏全盘加密、甚至仅仅是加密文件系统（EFS）的安全性。当系统处于休眠模式下时，有条件物理接触机器的攻击者可以将硬盘卸下并安装到另一套系统中，使其在不用输入密码的情况下即可访问加密内容。

## 与睡眠模式的比较

许多系统也支持低能耗的睡眠模式（亦称为待机模式），将机器的处理能力关闭，只使用少量的能源来维持内存中的内容，并支持唤醒操作，而唤醒通常是即时的。

睡眠模式的优越性在于从睡眠中恢复要比从休眠中恢复快得多。对处于休眠中的系统进行恢复首先要开机，然后将儲存在硬盘中的数据重新写回内存（这一过程通常需要10秒或更长的时间）。而唤醒睡眠模式的机器只需要激活CPU和显示系统即可，差不多是即时性的。不过另一方面，处于睡眠模式的机器必须持续耗电（尽管比正常运行时低）来维持内存中的内容，而休眠模式比睡眠模式耗电更少（如前述，仅需给[CMOS供电以防止用户在重新开机时进入](https://zh.wikipedia.org/wiki/CMOS "wikilink")[BIOS](../Page/BIOS.md "wikilink")设置）。

## 混合休眠模式

睡眠模式和休眠模式可以联合进行：将記憶體中的数据复制到非揮發性記憶體中，然后電腦进入睡眠模式。这一方式可以获得睡眠和休眠的双重好处：電腦可以从睡眠中立刻恢复，而其运行状态（包含已打开的文件和未保存的工作）则可以逃过掉电带来的丢失。混合休眠模式的耗电与睡眠模式同等，而休眠模式完全不耗电。

## 操作系统支援情况

早期的休眠依赖BIOS功能，但现代操作系统通常接管了这一职责。休眠在高级配置与电源接口（[ACPI](https://zh.wikipedia.org/wiki/ACPI "wikilink")）中被定义为S4睡眠模式。

### Microsoft Windows

在Windows中，只有当**所有**的设备都支援ACPI及[即插即用时才能启用休眠模式](https://zh.wikipedia.org/wiki/即插即用 "wikilink")。休眠可以通过开始菜单或命令行（shutdown命令）进行激活。

[Windows 95](../Page/Windows_95.md "wikilink") 通过硬件制造商提供的驱动程序支援休眠，且只有系统中存在兼容的硬件和BIOS时才能使用。由于Windows 95只支持高级电源管理（[APM](https://zh.wikipedia.org/wiki/APM "wikilink")），休眠被称作待机至硬碟（Suspend to Disk）。[Windows 98及其后的系统支持ACPI](../Page/Windows_98.md "wikilink")，但由于当时的硬件并不完全与ACPI 1.0标准兼容，或没有[WDM驱动程式](https://zh.wikipedia.org/wiki/WDM "wikilink")，休眠常常引发问题。休眠也与FAT32文件系统兼容性不佳。

[Windows 2000](../Page/Windows_2000.md "wikilink") 是第一个在操作系统层面支援休眠的Windows系统（系统控制的ACPI S4睡眠状态），而不需要硬體制造商提供特殊驅動程式。一个被命名为`hiberfil.sys`的文件被用来在系统休眠时存储記憶體中的数据，其大小与总内存容量一致，该文件存储在系统分区下并具有隐藏和系统属性。

[Windows Me](../Page/Windows_Me.md "wikilink") 作为最后一个[Windows 9x家族成员同样支援系统控制的休眠](../Page/Windows_9x.md "wikilink")，所需的硬碟空间与总内存大小一致。

[Windows XP](../Page/Windows_XP.md "wikilink") 进一步改良了休眠，由于对内存页使用了改进后的算法进行压缩，进入休眠模式及从休眠中恢复比以前速度更快。改进后的算法可使休眠文件的压缩与写入同步进行，未使用的内存页得以释放以缩小硬碟占用，并且在重新开机写入内存时使用了[直接内存访问](https://zh.wikipedia.org/wiki/直接内存访问 "wikilink")（DMA）。

尽管Windows XP支援大于4GB的記憶體（限Windows XP 64-bit Edition和Windows XP Professional x64 Edition），这一操作系统以及Windows Server 2003、Windows Vista、Windows Server 2008（均为32位版本）在安装大于4GB的記憶體时并不支持休眠，因为存储大量的記憶體数据到硬碟时性能会受到影响。

[Windows Vista](../Page/Windows_Vista.md "wikilink") 引入了「混合式睡眠」，「混合式睡眠」将記憶體中的数据保存到硬碟，但接下来进入睡眠模式而不是断电。如果在下次开机前断电了，系统可以如进行休眠一般从硬碟恢复。

[Windows 7](https://zh.wikipedia.org/wiki/Windows_7 "wikilink") 引入了对休眠文件的压缩，默认的文件大小为总記憶體数的75%。同时微软推荐通过`powercfg.exe`命令增加休眠文件的文件大小，以应对記憶體数据量超出75%容量的场合。休眠文件相对总記憶體的大小可以从50%到100%进行调节，不过并不推荐缩小该比率。

[Windows 8](https://zh.wikipedia.org/wiki/Windows_8 "wikilink") 从休眠模式恢复的算法对多核处理器进行了优化。Windows 8还引入了*快速啟動（Fast Startup）*功能，当用户选择*关机*时，Windows实际上进行了休眠，不过关闭了所有打开的程序并将用户登出，从而使用户下次开机速度更快。

### Mac OS X

在Mac机上，被称作**安全睡眠**的功能将易失性記憶體中的数据写入系统硬碟，然后系统进入睡眠模式。在記憶體供电没有切断的情况下，Mac可以从睡眠模式中立刻唤醒。不过在記憶體供电被切断的场合下（例如在未接交流电的情况下移除电池），Mac可以将記憶體数据从硬碟中读出，进而从安全睡眠模式中恢复。

安全睡眠模式仅在2005年10月版本起的[PowerBook G4及更新的型号上存在](../Page/PowerBook_G4.md "wikilink")，同时需要[Mac OS X](https://zh.wikipedia.org/wiki/Mac_OS_X "wikilink") 10.4版或更高版本的支持。

### Linux

在Linux内核中，休眠功能通过[swsusp实现](https://zh.wikipedia.org/wiki/swsusp "wikilink")，并被内建在2.6版以后的内核中。替代性的实现是[TuxOnIce](https://zh.wikipedia.org/wiki/TuxOnIce "wikilink")，在3.4版以后的内核中作为补丁存在。另一个替代性的实现是[uswsusp](https://zh.wikipedia.org/wiki/uswsusp "wikilink")。現在可用[systemd的systemctl命令實現](https://zh.wikipedia.org/wiki/systemd "wikilink")。

[Category:操作系统技术](https://zh.wikipedia.org/wiki/Category:操作系统技术 "wikilink")
> 本文内容由[函式庫](https://zh.wikipedia.org/wiki/函式庫)转换而来。


在[计算机科学](../Page/计算机科学.md "wikilink")中，**库**（）是用于开发[软件](../Page/软件.md "wikilink")的[子程序](../Page/子程序.md "wikilink")集合。库和[可执行文件的区别是](https://zh.wikipedia.org/wiki/可执行文件 "wikilink")，库不是独立的[计算机程序](../Page/计算机程序.md "wikilink")，他们是向其他程序提供服务的代码。

## 链接

**库链接**（）是指把一个或多个库包括到程序中，有两种链接形式：**静态链接**和**动态链接**；相应的，前者链接的库叫做[静态库](../Page/静态库.md "wikilink")，后者的叫做[动态库](https://zh.wikipedia.org/wiki/动态库 "wikilink")。

## 静态库

**静态链接**是由[链接器](../Page/链接器.md "wikilink")在链接时将库的内容加入到可执行程序中的做法。链接器是一个独立程序，将一个或多个库或目标文件（先前由[编译器或](https://zh.wikipedia.org/wiki/编译器 "wikilink")[汇编器生成](https://zh.wikipedia.org/wiki/汇编器 "wikilink")）链接到一块生成可执行程序。

静态链接的最大缺点是生成的可执行文件太大，需要更多的系统资源，在装入内存时也会消耗更多的时间。

## 共享库

### 动态库

**动态链接**，在可执行文件[装载时或](https://zh.wikipedia.org/wiki/装载时 "wikilink")[运行时](https://zh.wikipedia.org/wiki/运行时 "wikilink")，由[操作系统](../Page/操作系统.md "wikilink")的[装载程序加载库](https://zh.wikipedia.org/wiki/装载程序 "wikilink")。大多数操作系统将解析外部引用（比如库）作为加载过程的一部分。在这些系统上，可执行文件包含一个叫做*import directory*的表，该表的每一项包含一个库的名字。根据表中记录的名字，装载程序在硬盘上搜索需要的库，然后将其加载到内存中预先不确定的位置，之后根据加载库后确定的库的地址更新可执行程序。可执行程序根据更新后的库信息调用库中的函数或引用库中的数据。这种类型的动态加载称为装载（load-time）时加载，被包括[Windows和](https://zh.wikipedia.org/wiki/Windows "wikilink")[Linux](../Page/Linux.md "wikilink")的大多数系统采用。装载程序在加载应用软件时要完成的最复杂的工作之一就是加载时链接。

其他操作系统可能在运行时解析引用。在这些系统上，可执行程序调用操作系统[API将库的名字](https://zh.wikipedia.org/wiki/API "wikilink")、函数在库中的编号和函数参数一同传递。操作系统负责立即解析然后代表应用调用合适的函数。这种动态链接叫做运行时链接。因为每个调用都会有系统开销，运行时链接要慢得多，对应用的性能有负面影响。现代操作系统已经很少使用运行时链接。

可以动态链接的函式庫，在[Windows上是](https://zh.wikipedia.org/wiki/Windows "wikilink")*dynamic link library（DLL）*，在[UNIX](../Page/UNIX.md "wikilink")或[Linux](../Page/Linux.md "wikilink")上是*Shared Library*。库文件是预先编译链接好的可执行文件，存储在[计算机的](https://zh.wikipedia.org/wiki/计算机 "wikilink")[硬盘](../Page/硬盘.md "wikilink")上。大多数情况下，同一时间多个应用可以使用一个库的同一份拷贝，操作系统不需要加载这个库的多个实例。

动态链接的最大缺点是可执行程序依赖分别存储的库文件才能正确执行。如果库文件被删除、移动、重命名或者被替换为不兼容的版本，那么可执行程序就可能工作不正常。这就是常说的[DLL-hell](https://zh.wikipedia.org/wiki/DLL地狱 "wikilink")。

[Category:電腦術語](https://zh.wikipedia.org/wiki/Category:電腦術語 "wikilink") [Category:计算机编程](https://zh.wikipedia.org/wiki/Category:计算机编程 "wikilink") [Category:计算机程序库](https://zh.wikipedia.org/wiki/Category:计算机程序库 "wikilink")
在[统计学中](../Page/统计学.md "wikilink")，**分层广义线性模型**（hierarchical generalized
linear models
(HGLM)）可视为[广义线性模型的推广](https://zh.wikipedia.org/wiki/广义线性模型 "wikilink")。在广义线性模型中，误差分量是[统计独立的](https://zh.wikipedia.org/wiki/统计独立性 "wikilink")，\[1\]
然而这一假设并非总是成立的。即在有些情况下，[误差项之间有函数关系](../Page/误差.md "wikilink")。分层广义线性模型允许有不同的误差分量，误差分量可以统计[相关的](../Page/相关.md "wikilink")，并不必要满足[正态分布](../Page/正态分布.md "wikilink")。当有不同的[聚类存在时](../Page/聚类分析.md "wikilink")，同一聚类中的观测值是相关的，并且是正相关的。在这种情况下，广义线性模型是不适用的，忽略这些关联会引起造成一些问题\[2\]
。

## 概论

### 模型

在分层模型中，观测值可进行聚类，并且观测值的分布不仅由所有聚类的共同结构决定，也由聚类的具体结构决定。于是，模型要引入随机效应分量，并且不同的聚类有不同的随机效应分量。设\(y\)为响应变量，\(u\)为随机效应，\(g\)
为连结函数。在分层广义线性模型中，需要假设\(y|u\) 和 \(u\)满足：\[3\]
\(y\mid u \sim\ f(\theta,\,\phi)\) and \(u \sim\ f_u(\alpha).\)

线性预测器形式为：

  -
    <math>

g(E(y)) = g(\\mu) = \\eta = X \\beta + v \\, </math> 其中，\(\mu = E(y)\)，
\(\eta = X \beta + v\)， \(v = v(u)\)
为\(u\)的严格[单调函数](../Page/单调函数.md "wikilink")。在分层广义线性模型中，固定效应为\(\beta\)，对所有观测值都相同。随机分量\(u\)
是不可观测的，不同聚类对应的随机分量取值是随机的。于是，同一聚类的观测值对应的\(u\)的取值相同，不同聚类的观测值对应的\(u\)的取值也不同。\[4\]

### 可识别性

为了进行参数推断，有必要保证满足\[5\] 。在以上模型中，v是不可识别的，因为

  -
    <math>

X \\beta + v = (X \\beta + a) + (v - a) \\, </math> 其中\(a\)为常数。\[6\]
要使模型可识别，需要对参数另加约束。约束常加在随机效应上，比如\(E(v)=0\)。\[7\]

### 不同分布函数和链接函数的模型

假设不同的分布函数\(y\mid u\) 和 \(u\)，采用不同的链接函数\(g\) 和
'\(v\)，可以得到不同的模型。另外，是分层广义线性模型的一个特例。在分层广义线性模型中，
随机效应的分布函数\(u\)不必要满足正态分布。如果\(u\)的分布为正态分布，\(v\)的链接函数为[恆等函數](https://zh.wikipedia.org/wiki/恆等函數 "wikilink")，此时的分层广义线性模型即为广义线性混合模型。\[8\]

\(y\mid u\)
和\(u\)的分布可取为共轭分布，此时分层广义线性模型有一些特殊的性质，并且易于计算和理解\[9\]。比如，如果\(y\mid u\)
的分布为平均值一定的[泊松分布](https://zh.wikipedia.org/wiki/泊松分布 "wikilink")，\(u\)的分布为[伽玛分布](../Page/伽玛分布.md "wikilink")，并取标准对数连接函数，则此时分层广义线性模型为泊松共轭分层广义线性模型。如果\(y\mid u\)的分布为平均值一定的[二项分布](https://zh.wikipedia.org/wiki/二项分布 "wikilink")，\(u\)
的分布为共轭[贝塔分布](https://zh.wikipedia.org/wiki/贝塔分布 "wikilink")，采用标准罗吉特连接函数，则此时分层广义线性模型为贝塔共轭模型。另外，广义线性混合模型其实就是正态共轭分层广义线性模型。\[10\]

常见的模型总结如下：\[11\]

<table>
<caption>Commonly used models</caption>
<thead>
<tr class="header">
<th><p>模型名字</p></th>
<th><p>y的分布</p></th>
<th><p>y 和 u的连接函数</p></th>
<th><p>u的分布</p></th>
<th><p>u 和 v 的连接函数</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>正态共轭</p></td>
<td><p><a href="../Page/正态分布.md" title="wikilink">正态分布</a></p></td>
<td><p><a href="https://zh.wikipedia.org/wiki/恒等函数" title="wikilink">恒等函数</a></p></td>
<td><p><a href="../Page/正态分布.md" title="wikilink">正态分布</a></p></td>
<td><p><a href="https://zh.wikipedia.org/wiki/恒等函数" title="wikilink">恒等函数</a></p></td>
</tr>
<tr class="even">
<td><p>二项共轭</p></td>
<td><p><a href="https://zh.wikipedia.org/wiki/二项分布" title="wikilink">二项分布</a></p></td>
<td></td>
<td><p><a href="https://zh.wikipedia.org/wiki/贝塔分布" title="wikilink">贝塔分布</a></p></td>
<td></td>
</tr>
<tr class="odd">
<td><p>泊松共轭</p></td>
<td><p><a href="https://zh.wikipedia.org/wiki/泊松分布" title="wikilink">泊松分布</a></p></td>
<td><p><a href="https://zh.wikipedia.org/wiki/对数" title="wikilink">对数</a></p></td>
<td><p><a href="../Page/伽玛分布.md" title="wikilink">伽玛分布</a></p></td>
<td><p><a href="https://zh.wikipedia.org/wiki/对数" title="wikilink">对数</a></p></td>
</tr>
<tr class="even">
<td><p>伽玛共轭</p></td>
<td><p><a href="../Page/伽玛分布.md" title="wikilink">伽玛分布</a></p></td>
<td><p><a href="../Page/倒数.md" title="wikilink">倒数</a></p></td>
<td><p><a href="https://zh.wikipedia.org/wiki/逆伽玛分布" title="wikilink">逆伽玛分布</a></p></td>
<td><p><a href="../Page/倒数.md" title="wikilink">倒数</a></p></td>
</tr>
<tr class="odd">
<td><p>二项GLMM</p></td>
<td><p><a href="https://zh.wikipedia.org/wiki/二项分布" title="wikilink">二项分布</a></p></td>
<td></td>
<td><p><a href="../Page/正态分布.md" title="wikilink">正态分布</a></p></td>
<td><p><a href="https://zh.wikipedia.org/wiki/恒等函数" title="wikilink">恒等函数</a></p></td>
</tr>
<tr class="even">
<td><p>泊松 GLMM</p></td>
<td><p><a href="https://zh.wikipedia.org/wiki/泊松分布" title="wikilink">泊松分布</a></p></td>
<td><p><a href="https://zh.wikipedia.org/wiki/对数" title="wikilink">对数</a></p></td>
<td><p><a href="../Page/正态分布.md" title="wikilink">正态分布</a></p></td>
<td><p><a href="https://zh.wikipedia.org/wiki/恒等函数" title="wikilink">恒等函数</a></p></td>
</tr>
<tr class="odd">
<td><p>伽玛 GLMM</p></td>
<td><p><a href="../Page/伽玛分布.md" title="wikilink">伽玛分布</a></p></td>
<td><p><a href="https://zh.wikipedia.org/wiki/对数" title="wikilink">对数</a></p></td>
<td><p><a href="../Page/正态分布.md" title="wikilink">正态分布</a></p></td>
<td><p><a href="https://zh.wikipedia.org/wiki/恒等函数" title="wikilink">恒等函数</a></p></td>
</tr>
</tbody>
</table>

## 拟合

分层广义线性模型适用条件是观测值可归为不同的聚类。[估计函数有两类](https://zh.wikipedia.org/wiki/估计函数 "wikilink")：固定效应估计函数和随机效应估计函数，分别相应于
\(\eta = \mathbf{x}\boldsymbol\beta\) 和 \(\mathbf{v(u)}\)
中的参数。有多种方法进行分层广义线性模型中的[参数估计](https://zh.wikipedia.org/wiki/参数估计 "wikilink")。如果只对固定效应估计函数感兴趣，可以采用总体平均模型。如果要推断个体，就需要估计随机效应。\[12\]
拟合分层广义线性模型有多种技术。

## 应用

分层广义线性模型在实际生活中有诸多应用。

### 工程

这一模型可用于分析半导体制造中相互关联的过程形成的负载的层级过程\[13\]\[14\]。工程师可以应用此模型发现和分析重要的次过程，同时评估这些次过程对最终性能的影响
\[15\]。

### 商业

市场问题也可以用分层广义线性模型来分析。研究者应用此模型研究了一国范围内的消费者，以解决国际市场研究中的嵌套数据结构问题\[16\]。

## 参考文献

[Category:回归分析](https://zh.wikipedia.org/wiki/Category:回归分析 "wikilink")
[Category:统计模型](https://zh.wikipedia.org/wiki/Category:统计模型 "wikilink")

1.

2.

3.
4.
5.

6.
7.
8.
9.
10.

11.

12.
13.

14.

15.
16.
在[密码学中](../Page/密码学.md "wikilink")，**分组加密**（），又称**分块加密**或**块密码**，是一种[对称密钥算法](https://zh.wikipedia.org/wiki/对称密钥算法 "wikilink")。它将明文分成多个等长的模块（block），使用确定的算法和[对称密钥对每组分别加密解密](https://zh.wikipedia.org/wiki/对称密钥 "wikilink")。分组加密是极其重要的加密协议组成，其中典型的如[DES和](https://zh.wikipedia.org/wiki/DES "wikilink")[AES作为美国政府核定的标准加密算法](../Page/高级加密标准.md "wikilink")，应用领域从电子邮件加密到银行交易转帐，非常广泛。

现代分组加密建立在[迭代的思想上产生密文](../Page/迭代.md "wikilink")。其思想由[克劳德·香农在他](../Page/克劳德·香农.md "wikilink")1949年的重要论文《保密系统的通信理论》（Communication
Theory of Secrecy Systems）中提出，作为一种通过简单操作如替代和排列等以有效改善保密性的方法。\[1\]
迭代产生的密文在每一轮加密中使用不同的**子密钥**，而子密钥生成自原始密钥。

[DES加密在](https://zh.wikipedia.org/wiki/DES "wikilink")1977年由前[美国国家标准局](https://zh.wikipedia.org/wiki/美国国家标准局 "wikilink")（今“美国国家标准与技术研究所”）颁布，是现代分组加密设计的基础思想。它同样也影响了[密码分析的学术进展](../Page/密码分析.md "wikilink")。

## 简述

分组加密包含两个成对的算法：加密算法*E*和解密算法*D*，两者互为[反函数](https://zh.wikipedia.org/wiki/反函数 "wikilink")。每个算法有两个输入：长度为*n*[位的组](../Page/位元.md "wikilink")，和长度为*k*位的密钥；两组输入均生成*n*位输出。将两个算法看作函数，*K*表示长度为*k*的密钥（密钥长度），*P*表示长度为*n*的分组，*P*也被表示为[明文](https://zh.wikipedia.org/wiki/明文 "wikilink")，*C*表示[密文](https://zh.wikipedia.org/wiki/密文 "wikilink")，则满足：

\[E_K(P) = C \; ; \quad E_K^{-1}(C)=P\]

\[E_K(P) := E(K,P): \{0,1\}^k \times \{0,1\}^n \rightarrow \{0,1\}^n,\]

对于任意密钥*K*，*E<sub>K</sub>(P)*是输入的组的一个[置换函数](../Page/双射.md "wikilink")，且不可逆地落在{0,1}<sup>*n*</sup>区间。*E*的反函数（解密算法）定义为：

\[E_K^{-1}(C) := D_K(C) = D(K,C): \{0,1\}^k \times \{0,1\}^n \rightarrow \{0,1\}^n,\]
例如，一个分组加密算法使用一段 128 位的分组作为明文，相应输出 128
位的密文；而其转换则受加密算法中第二个输入的控制，也就是密钥*k*。解密算法类似，使用
128 位的密文和对应的密钥，得到原 128 位的明文。

  - 每一个密钥实际上是选择了*n*位输入排列的\((2^n)!\)种组合中的一种\[2\]。

大多数的分组密码在在加密算法中会重复使用某一函数进行多轮运算，典型的轮数在4-32次之间，每一轮的函数*R*使用不同的子密钥*K<sub>i</sub>*，由原密钥生成，作为输入：

\[M_i = R_{K_i}(M_{i-1})\] 其中\(M_0\)是最初的明文，\(M_i\)是第*i*轮加密后的密文。

## 历史

[Lucifer一般被认为是第一个现代分组密码](https://zh.wikipedia.org/wiki/Lucifer "wikilink")，由[IBM在](../Page/IBM.md "wikilink")1970年代基于霍斯特·費斯妥（）的工作完成。它的一个修改版本是[数据加密标准](https://zh.wikipedia.org/wiki/DES "wikilink")，被美国政府纳入[联邦资料处理标准](https://zh.wikipedia.org/wiki/联邦资料处理标准 "wikilink")，并于1976年正式发布，至今仍被广泛应用。

当时设计DES密码的最初目的是为了抵抗某些[美国国家安全局](../Page/美国国家安全局.md "wikilink")（）和IBM知道的密码分析方法，直到1980年代末期，这种被称为[差分分析的方法才被毕汉姆](https://zh.wikipedia.org/wiki/差分分析 "wikilink")（）和萨莫尔（）独立重新发现\[3\]。[线性分析是另一种方法](https://zh.wikipedia.org/wiki/线性分析 "wikilink")，在[松井充发布这种实验性的密码分析方法](https://zh.wikipedia.org/wiki/松井充 "wikilink")\[4\]之前还并不知道。DES作为早期的分组密码，最早成为密码标准，由于在最初DES并未公布其实现细节，其S盒设计被怀疑包含后门，因此学界对其进行了大量的研究，提高了学界对分组密码的了解，客观上促进了密码学及密码分析的发展，引领了很多密码学和密码分析的研究。另一种分组密码标准[高级加密标准](../Page/高级加密标准.md "wikilink")（AES）被[美国国家标准与技术研究院](https://zh.wikipedia.org/wiki/美国国家标准与技术研究院 "wikilink")（NIST）采纳，即将逐渐取代DES目前的位置。

## 优缺点

## 设计原则

扩散（）和扰乱（）是影响密码安全的主要因素\[5\]。扩散的目的是让明文中的单个数字影响密文中的多个数字，从而使明文的统计特征在密文中消失，相当于明文的统计结构被扩散\[6\]。例如，最简单的方法让明文中的一个数字影响密文中的*k*个数字，可以用：

\[c_n = \sum^k_{i=1}m_{n+i}\]
扰乱是指让密钥与密文的统计信息之间的关系变得复杂，从而增加通过统计方法进行攻击的难度。扰乱可以通过各种代换算法实现。

设计安全的分组加密算法，需要考虑对现有密码分析方法的抵抗，如差分分析、线性分析等，还需要考虑密码安全强度的稳定性。此外，用软件实现的分组加密要保证每个组的长度适合软件编程（如8、16、32……），尽量避免位置换操作，以及使用加法、乘法、移位等处理器提供的标准指令；从硬件实现的角度，加密和解密要在同一个器件上都可以实现，即加密解密硬件实现的相似性\[7\]。

## 工作模式

## 参考文献

## 参见

  - [密码学](../Page/密码学.md "wikilink")
  - [流密码](../Page/流密码.md "wikilink")

{{-}}

[Category:分组密码](https://zh.wikipedia.org/wiki/Category:分组密码 "wikilink")

1.
2.
3.
4.
5.
6.
7.
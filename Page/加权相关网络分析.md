> 本文内容由[加权相关网络分析](https://zh.wikipedia.org/wiki/加权相关网络分析)转换而来。


**加权相关网络分析**也称为**加权基因共表达网络分析**，是一种广泛使用的[数据挖掘](../Page/数据挖掘.md "wikilink")方法，它用两两变量间[相关系数研究](../Page/皮尔逊积矩相关系数.md "wikilink")[生物网络](../Page/生物网络.md "wikilink")。它适用于[高维度数据集](https://zh.wikipedia.org/wiki/高维数据聚类 "wikilink")，在[基因組學](../Page/基因組學.md "wikilink")领域应用的最为广泛。

此分析假定基因网络服从[无尺度分布](https://zh.wikipedia.org/wiki/无尺度分布 "wikilink")，定义基因共表达相关矩阵，计算生成[邻接矩阵](../Page/邻接矩阵.md "wikilink")，然后计算各个节点的相异系数，建立分层聚类树。此树不同分支代表不同的基因模块，模块内基因有较高的共表达水平，从中可以鉴定出枢纽基因。可通过基因网络与表型之间联系，最终找到表型的靶点基因、基因网络\[1\]。此分析还可以用于研究共表达模块之间的关系、比较不同网络的网络拓扑学（差异网络分析）。加权基因共表达网络分析可以进行数据提炼（与斜交[因子分析相关](https://zh.wikipedia.org/wiki/因子分析 "wikilink")）、[聚类分析](../Page/聚类分析.md "wikilink")（模糊聚类）、[特征选择](../Page/特征选择.md "wikilink")方法（比如，进行基因筛选）、综合互补（基因组）数据的框架（根据数量变量之间的加权相关性）和探索性数据分析。\[2\]

虽然加权基因共表达网络分析结合了很多传统数据探索技术，易于理解的网络语言和分析框架使它优于任何标准的分析方法。由于使用网络方法，同时适合整合互补基因组的数据，它可认为是一种系统生物学或系统遗传数据的分析方法。加权基因共表达网络分析通过在相似的模块间选择模块间枢纽基因，也使基于网络的[元分析](../Page/元分析.md "wikilink")技术成为可能\[3\]。

## 历史

加权基因共表达网络分析方法是[加州大学洛杉矶分校大卫](https://zh.wikipedia.org/wiki/加州大学洛杉矶分校 "wikilink")·格芬医学院人类遗传学教授、[加州大学洛杉矶分校菲尔丁公共卫生学院](https://zh.wikipedia.org/wiki/加州大学洛杉矶分校 "wikilink")[生物統計學](../Page/生物統計學.md "wikilink")教授Steve Horvath、他在加州大学洛杉矶分校的同事、实验室成员（主要有Peter Langfelder、Bin Zhang、Jun Dong）联合创立的。研究的很大部分是应用领域的研究者合作产生的。加权相关网络是与癌症研究者Paul Mischel、Stanley F. Nelson和神经科学家Daniel H. Geschwind、Michael C. Oldham的讨论后发明的（根据\[4\]里的致谢章节）。存在很多关于依赖网络、自由尺度网络和共表达网络的研究文献。

## 方法

第一，指定基因共表达相似性指标来定义网络。我们用\(s_{ij}\)表示基因i和j之间的基因共表达相似性。很多共表达研究都使用相关性的绝对值，作为无符号共表达相似指标，

\(s^{unsigned}_{ij}=|cor(x_i,x_j)|\)

公式里，多个样本中基因表达量构成了基因表达谱\(x_{i}\)和\(x_{j}\)。然而，使用相关性的绝对值就不区分基因的抑制和激活，造成了生物学信息的损失。而在有符号网络中，基因之间的相似性表达了其表达谱的相关方向。为定义基因表达谱\(x_{i}\)和\(x_{j}\)之间一个有符号共表达指标，我们可以使用对相关性的简单转换：

\(s^{signed}_{ij}=0.5+0.5 cor(x_i,x_j)\)

与无符号指标\(s^{unsigned}_{ij}\)一样，有符号相似性\(s^{signed}_{ij}\)取0和1之间的值。请注意，两个表达量相反的基因在无符号时等于1，有符号时等于0；两个表达量无相关性的基因，无符号时等于0，有符号时等于0.5。

下一步，使用邻接矩阵（网络）\(A=[a_{ij}]\)定量确定两个基因相互连接的程度。将共表达相似性矩阵\(S = [s_{ij}]\)设定阈值定义为\(A\)。对相似性指标\(S\)设立固定的阈值会将数据分为两组，生成无权重基因共表达网络。如果\(s_{ij}>\tau\)，无权重网络邻接矩阵设定为1，否则设定为0。因为设定固定的阈值会将基因连接分成两组，对阈值的选择较为敏感，造成共表达信息的损失\[5\]。如果不设固定阈值，共表达信息连续的特性就得以保留。加权基因共表达网络分析使用以下的幂函数评估连接强度：

\(a_{ij} = (s_{ij})^\beta\),

幂\(\beta\)是不固定阈值的参数。无符号和有符号网络分别使用\(\beta=6\)和\(\beta=12\)作为默认值。\(\beta\)也可以使用无尺度拓扑标准进行选择，即选择\(\beta\)可达成[无尺度网络](../Page/无尺度网络.md "wikilink")的最小值 \[6\]。

由于\(log (a_{ij}) = \beta log (s_{ij})\)，加权网络邻接矩阵与共表达相似矩阵线性的对数值相关。\(\beta\)取高值，会将高度相似性转换为高度邻接矩阵、低相似度推向0。由于这种应用于成对相关矩阵的不固定阈值的步骤会产生加权邻接矩阵，随后的分析称为加权基因共表达网络分析。

模块中心分析的重要一步是：用网络拓扑指标将基因集聚为网络模块。简单来说，一对基因如果相互连接，距离会較近。按照惯例，两个基因的距离在0到1之间。通常来说，加权基因共表达网络分析使用拓扑重叠指标作为距离\[7\]\[8\]。

拓扑重叠指标将两个基因之间的邻接矩阵和两个基因与其他基因之间的连接强度混合，是网络相互连接性稳健的指标。将此指标输入平均连锁层级聚类。动态分支切割法生成的聚类结果中的分支，就成了模块\[9\]。之后，在特定模块内的基因与模块特征向量一起，可以被视为标准模块表达数据最好的总结\[10\]。标准化表达谱的第一个主成分定义为模块特征向量。为了寻找与感兴趣的临床性状相关的模块，模块特征向量之后与其进行相关性比较，得出特征向量显著指标。人们可以在模块特征向量之间建立共表达网络，即以节点为模块的网络\[11\]。

为了判断特定模块的模块间枢纽基因，可以使用两种连接指标。第一种称为\(kME_i=cor(x_i,ME)\)，是将基因与相关模块的特征向量进行相关定义的。第二种称为kIN，定义为邻接矩阵相关模块基因的和。实际运用中，两种指标是等同的\[12\]。为了测试一个模块是否存在于另一个数据集，可以使用多种网络统计量，如\(Zsummary\)\[13\]。

## 加权和未加权相关网络的比较

可以将加权相关网络理解成特殊形式的加权网络、依赖网络或者相关网络。加权相关网络分析由于以下几点，很具吸引力：

  - 网络建设（基于对[皮尔逊积矩相关系数](../Page/皮尔逊积矩相关系数.md "wikilink")设定不固定阈值）保留了背后相关信息的连续性特征。比如，根据数值变量的相关性建立的加权相关网络不需要选择固定阈值。设固定阈值将信息分为两组可能会导致信息削减\[14\]。
  - 对于设定不同的不固定阈值，网络建设十分稳健\[15\]。这与对称对相关性设定阈值的不加权网络的结果相反，其通常受阈值影响很大。
  - 可以根据相关性角度的解读对加权相关网络进行几何解读\[16\]。
  - 算出的网络统计结果可以用来提升标准的数据挖掘方法（如聚类分析），因为相似性指标通常可转换为加权网络。\[17\]\[18\]
  - 加权基因共表达网络分析提供强大的模块保留统计量，可用来定量预测，在其他条件下能否找到的可能性。模块保留统计量允许研究者研究网络间模块结构的差别\[19\]。
  - 加权网络和相关网络可以由“可因子分解”网络近似计算\[20\]\[21\]。稀疏的、无权重的网络通常难以进行此种近似。因此，加权（相关）网络允许吝啬参数化（就模块和模块资格而言）\[22\]\[23\]。

## 应用

加权基因共表达网络分析被广泛应用于在分析表达数据（即转录数据）。如，寻找模块间枢纽基因。\[24\]\[25\]

在系统遗传学应用中，此分析常用于数据提炼步骤，模块由“模块特征向量”表示\[26\]\[27\]。可用模块特征向量将模块与临床性状相关联。特征向量网络是模块特征向量之间的共表达网络（即节点为模块的网络）。 神经科学应用加权基因共表达网络分析\[28\]\[29\]，分析微阵列数据\[30\]、单细胞[RNA测序数据](https://zh.wikipedia.org/wiki/RNA测序 "wikilink")\[31\]\[32\]、[DNA甲基化](../Page/DNA甲基化.md "wikilink")数据\[33\]、miRNA数据、肽计数\[34\]、[人类微生物组计划](../Page/人类微生物组计划.md "wikilink")数据（16S rRNA基因序列）的基因组数据\[35\]。其他的应用包括：脑影像数据，如[功能性磁共振成像](../Page/功能性磁共振成像.md "wikilink")数据\[36\]。

## R软件包

加权基因共表达网络分析的[R软件包](../Page/R语言.md "wikilink")\[37\]提供了加权网络分析所有功能（模块建立、节点基因选择、模块保存统计、差异网络分析、网络统计）的函数。可以通过CRAN下载加权基因共表达网络分析包。

## 参考资料

[Category:生物信息学](https://zh.wikipedia.org/wiki/Category:生物信息学 "wikilink") [Category:数据挖掘](https://zh.wikipedia.org/wiki/Category:数据挖掘 "wikilink")

1.  宋长新,雷萍,王婷. 基于WGCNA算法的基因共表达网络构建理论及其R软件实现\[J\]. 基因组学与应用生物学,2013,(01):135-141.
2.
3.
4.
5.
6.
7.
8.
9.
10.
11.
12.
13.
14.
15.
16.
17.
18.
19.
20.
21.
22.
23.
24.
25.
26.
27.
28.
29.
30.
31.
32.
33.
34.
35.
36.
37.
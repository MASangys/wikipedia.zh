[最优控制中的](https://zh.wikipedia.org/wiki/最优控制 "wikilink")**哈密頓量**（Hamiltonian）是由[列夫·庞特里亚金所發展](../Page/列夫·庞特里亚金.md "wikilink")，是[庞特里亚金最小化原理的一部份](https://zh.wikipedia.org/wiki/庞特里亚金最小化原理 "wikilink")\[1\]。哈密頓量的概念是由[古典力學中的](https://zh.wikipedia.org/wiki/古典力學 "wikilink")[哈密顿力学所引發](../Page/哈密顿力学.md "wikilink")，但兩者是不同的概念。庞特里亚金證明了求解最优控制問題的必要條件，就是要選擇可使哈密頓量最小化的控制輸入。細節可參考[庞特里亚金最小化原理](https://zh.wikipedia.org/wiki/庞特里亚金最小化原理 "wikilink")。

## 問題的敘述

最佳控制的問題，是要選擇控制輸入\(u(t)\)，使以下的目標函數有最小值

\[J(u)=\Psi(x(T))+\int^T_0 L(x,u,t) dt\]

其中\(x(t)\)為系統狀態，滿足狀態方程式

\[\dot{x}=f(x,u,t) \qquad x(0)=x_0 \quad t \in [0,T]\]

控制需滿足以下的限制條件

\[a \le u(t) \le b \quad t \in [0,T]\]

## 哈密頓量的定義

  -
    <math>

H(x,\\lambda,u,t)=\\lambda^T(t)f(x,u,t)+L(x,u,t) \\, </math>

其中\(\lambda(t)\)為[協態變數組成的向量](../Page/協態方程.md "wikilink")，其維度和狀態變數\(x(t)\)相同。

若要進一步瞭解哈密頓量的性質，可參考[庞特里亚金最小化原理](https://zh.wikipedia.org/wiki/庞特里亚金最小化原理 "wikilink")。

## 離散時間下的哈密頓量

若問題是在離散時間下，其哈密頓量定義為：

\[H(x,\lambda,u,t)=\lambda^T(t+1)f(x,u,t)+L(x,u,t) \,\]

而[協態方程為](../Page/協態方程.md "wikilink")

\[\lambda(t+1)=-\frac{\partial H}{\partial x} + \lambda(t)\]
（注意此處提到，離散哈密頓量在時間\(t\)的值和協態變數在時間\(t+1\)的值有關\[2\]。這個小差異很重要，在對\(x\)微分後，可以在協態方程右邊得到和\(\lambda(t+1)\)有關的算式。若寫法有誤，所得的協態方程不是後向的差分方程，會帶來錯誤的結果。）

## 控制哈密頓量和力學哈密頓量的比較

[威廉·哈密頓定義力學中的](../Page/威廉·哈密頓.md "wikilink")[哈密頓量為三個變數的函數](https://zh.wikipedia.org/wiki/哈密頓量 "wikilink")：

\[\mathcal{H} = \mathcal{H}(p,q,t) = \langle p,\dot{q} \rangle -L(q,\dot{q},t)\]

其中\(\dot{q}\)定義如下

\[p = \frac{\partial L}{\partial \dot{q}}\]

哈密頓再將方程改為

\[\frac{ d}{ dt}p(t) = -\frac{\partial}{\partial q}\mathcal{H}\]

\[\frac{ d}{ dt}q(t) =~~\frac{\partial}{\partial p}\mathcal{H}\]

最佳控制中的哈密頓量則是四個變數的函數：

\[H(q,u,p,t)= \langle p,\dot{q} \rangle -L(q,u,t)\]

其要有最大值的相關條件為

\[\frac{dp}{dt} = -\frac{\partial H}{\partial q}\]

\[\frac{dq}{dt} = ~~\frac{\partial H}{\partial p}\]

\[\frac{\partial H}{\partial u} = 0\]

上述定義和Sussmann及Willems論文所提的一致\[3\]
。Sussmann及Willems證明了控制哈密頓量可以用在動力學上，例如[最速降線問題](../Page/最速降線問題.md "wikilink")，不過沒有提到[康斯坦丁·卡拉西奥多里較早時期在此領域的貢獻](../Page/康斯坦丁·卡拉西奥多里.md "wikilink")\[4\]。

## 參考資料

## 外部連結

  -
[Category:最佳控制](https://zh.wikipedia.org/wiki/Category:最佳控制 "wikilink")

1.
2.  Varaiya, Chapter 6
3.
4.  See
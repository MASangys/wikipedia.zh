> 本文内容由[哈尔特征](https://zh.wikipedia.org/wiki/哈尔特征)转换而来。


**哈尔特征**（）是用于[物体识别的一种](https://zh.wikipedia.org/wiki/物体识别 "wikilink")[数字图像](../Page/数字图像.md "wikilink")[特征](https://zh.wikipedia.org/wiki/特征\(计算机视觉\) "wikilink")。它们因为与[哈尔小波转换极为相似而得名](https://zh.wikipedia.org/wiki/哈尔小波转换 "wikilink")，是第一种即时的[人脸检测](../Page/人脸检测.md "wikilink")運算。

历史上，直接使用图像的强度（就是图像每一个像素点的RGB值）使得特征的计算强度很大。帕帕乔治奥等人提出可以使用基于哈尔小波的特征而不是图像强度\[1\] 。维奥拉和琼斯\[2\]进而提出了哈尔特征。哈尔特征使用检测窗口中指定位置的相邻矩形，计算每一个矩形的像素和并取其差值。然后用这些差值来对图像的子区域进行分类。

例如，当前有一个人脸图像集合。通过观察可以发现，眼睛的颜色要比两颊的深。因此，用于[人脸检测](../Page/人脸检测.md "wikilink")的哈尔特征是分别放置在眼睛和脸颊的两个相邻矩形。这些矩形的位置则通过类似于人脸图像的外接矩形的检测窗口进行定义。

在[维奥拉-琼斯目标检测框架](../Page/维奥拉-琼斯目标检测框架.md "wikilink")的检测阶段，一个与目标物体同样尺寸的检测窗口将在输入图像上滑动，在图像的每一个子区域都计算一个哈尔特征。然后这个差值会与一个预先计算好的阈值进行比较，将目标和非目标区分开来。因为这样的一个哈尔特征是一个[弱分类器](https://zh.wikipedia.org/wiki/弱分类器 "wikilink")（它的检测正确率仅仅比随机猜测强一点点），为了达到一个可信的判断，就需要一大群这样的特征。在[维奥拉-琼斯目标检测框架](../Page/维奥拉-琼斯目标检测框架.md "wikilink")中，就会将这些哈尔特征组合成一个[级联分类器](https://zh.wikipedia.org/wiki/级联分类器 "wikilink")，最终形成一个[强分类群](https://zh.wikipedia.org/wiki/强分类群 "wikilink")。

哈尔特征最主要的优势是它的计算非常快速。使用一个称为[积分图](../Page/积分图.md "wikilink")的结构，任意尺寸的哈尔特征可以在常数时间内进行计算。

## 矩形哈尔特征

[Prm_VJ_fig1_featureTypesWithAlpha.png](https://zh.wikipedia.org/wiki/File:Prm_VJ_fig1_featureTypesWithAlpha.png "fig:Prm_VJ_fig1_featureTypesWithAlpha.png") 一个矩形哈尔特征可以定义为矩形中几个区域的像素和的差值，可以具有任意的位置和尺寸。这种特质也被称为2矩形特征（*2-rectangle feature*）。 维奥拉和琼斯也定义了3矩形特征和4矩形特征。这个值表明了图像的特定区域的某些特性。每一个特征可以描述图像上特定特性的存在或不存在，比如边缘或者纹理的变化。例如，一个2-矩形特征可以表明一个边界位于一个亮区域和一个暗区域之间。

## 哈尔特征的快速计算

[Prm_VJ_fig3_computeRectangleWithAlpha.png](https://zh.wikipedia.org/wiki/File:Prm_VJ_fig3_computeRectangleWithAlpha.png "fig:Prm_VJ_fig3_computeRectangleWithAlpha.png") 维奥拉和琼斯的一个重要贡献是使用积分图\[3\] 。 积分图是一个二维矩形的查找表，与原始图像具有一样的尺寸。积分图的每一个元素是原始图像在对应位置左上角所有像素的和。这就使得在任意位置计算任意尺寸的矩形的像素和时，只需要进行四次查表：

  -
    \(\text{sum} = I(C) + I(A) - I(B) - I(D). \,\)

其中点 \(A, B, C, D\) 属于原始图像 \(I\)，如图所示。

每个哈尔特征的查找次数取决于它的定义。维奥拉和琼斯的2矩形特征需要六次查询，3矩形需要八次，而4矩形則需要九次。

## 倾斜的哈尔特征

蘭哈切和梅迪\[4\] 提出了倾斜的（45°）哈尔特征。这种对特征维度的扩充是为了提升对物体的检测。由于这些特征对一些物体的描述更为适合，这种扩充是有效的。例如，一个倾斜的特征可以描述一个倾斜45°的边缘。针对这种特征的计算，也提出了倾斜的积分图。

## 参考文献

[Category:生物识别技术](https://zh.wikipedia.org/wiki/Category:生物识别技术 "wikilink") [Category:计算机视觉](https://zh.wikipedia.org/wiki/Category:计算机视觉 "wikilink")

1.  Papageorgiou, Oren and Poggio, "A general framework for object detection", International Conference on Computer Vision, 1998.
2.  Viola and Jones, "Rapid object detection using a boosted cascade of simple features", Computer Vision and [Pattern Recognition](https://zh.wikipedia.org/wiki/Pattern_Recognition "wikilink"), 2001
3.  Crow, F, "Summed-area tables for texture mapping", in Proceedings of [SIGGRAPH](../Page/SIGGRAPH.md "wikilink"), 18(3):207–212, 1984
4.  Lienhart, R. and Maydt, J., "An extended set of Haar-like features for rapid object detection", ICIP02, pp. I: 900–903, 2002
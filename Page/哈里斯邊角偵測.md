**哈里斯邊角偵測**(Harris Corner
Detector)是被廣泛運用在電腦視覺的演算法，主要是用於從影像中找出代表邊角的特徵點。最早是由Chris
Harris 和Mike Stephens在1988年所提出，在當時是莫拉維克邊角偵測器的改進版本\[1\]。與
莫拉維克邊角偵測器相比，不是對局部小塊區域作45度角移動，而是考量了方向性值直接算出邊角的微分值，這個方法在當時已被證明可以更準確地去分辨出邊角。自從哈里斯邊角偵測器被提出後，後續有很多演算法試著去改良它，而這類的演算法也在很多影像處理的應用上被採用作為前處理。

## 概要介紹

角落的概念就是它相鄰的區域有兩條截然不同方向的邊，換句話說，角落也是兩條邊的接點，而這條邊的附近有劇烈的亮度變化\[2\]。邊角是影像重要的特徵，基本上邊角的特性不會受到旋轉、平移以及影像亮度的影響。雖然邊角只是一張影像中的一小部分，但是通常卻代表著一張影像中最重要的特徵，因為它們的資訊相較於整張影像，富有代表性且可以被應用在影像接合，動作追蹤，建立二維馬賽克，立體視覺，以及相關的電腦視覺領域。

為了找出影像中的邊角，科學家們提出了很多不同種的邊角測試器包含Kanade-Lucas-Tomasi (KLT)
算子，哈里斯算子是其中最簡單，有效，及可信賴的方法。這兩種受歡迎的方法均是以局部結構矩陣來當作基礎，相較於Kanade-Lucas-Tomasi
(KLT)邊角偵測，就算影像經過旋轉或者是亮度的調整，哈里斯邊角偵測具有良好的結果重現性，因此，它更被常使用在立體匹配及影像資料庫檢索。雖然仍有不少的缺點及限制，哈里斯邊角偵測依在電腦視覺的應用中然是相當重要且基礎的技術。

## 哈里斯邊角偵測的發展 \[3\]

  -
    <math>

M = \\underset{(x,y)\\in W}\\sum \\begin{bmatrix} I_x^2 & I_x I_y
\\\\ I_x I_y & I_y^2 \\end{bmatrix} = \\begin{bmatrix}
\\underset{(x,y)\\in W}\\sum I_x^2 &\\underset{(x,y)\\in W} \\sum I_x
I_y \\\\ \\underset{(x,y)\\in W}\\sum I_x I_y & \\underset{(x,y)\\in
W}\\sum I_y^2 \\end{bmatrix} </math>

  -
    在不失去一般性的狀況下，我們假設使用的是一張二維的灰階影像。在這裡以\(I\)代表這張影像，假設我們現在針對一小塊局度區域\((x, y)\)移動了\((\Delta x,\Delta y)\)，以\(f\)代表這兩塊小區域的加總平方差(SSD)，可以寫作
      -
        <math>

f(x,y) = \\underset{(x_k,y_k)\\in W}\\sum\\left(I(x_k,y_k) -
I(x_k+\\Delta x,y_k+\\Delta y)\\right)^2 </math>

\(I(x+\Delta x,y+\Delta y)\)
可以用泰勒展開去近似，以\(I_x\)和\(I_y\)分別代表\(I\)在x及y方向的偏微分，於是我們可以近似成

  -

      -
        <math>

I(x+\\Delta x,y+\\Delta y) \\approx I(x,y) + I_x(x,y)\\Delta
x+I_y(x,y)\\Delta y </math> 所以\(f(x,y)\)可以寫成下列

  -

      -
        <math>

f(x,y) \\approx \\underset{(x,y)\\in W}\\sum \\left( I_x(x,y)\\Delta x
+ I_y(x,y)\\Delta y \\right)^2, </math> 如果以矩陣的形式來表達,

  -

      -
        <math>

f(x,y) \\approx \\begin{pmatrix} \\Delta x & \\Delta y \\end{pmatrix} M
\\begin{pmatrix} \\Delta x \\\\ \\Delta y \\end{pmatrix}, </math>
在這裡M代表結構張量,

  -

      -
        <math>

M = \\underset{(x,y)\\in W}\\sum \\begin{bmatrix} I_x^2 & I_x I_y
\\\\ I_x I_y & I_y^2 \\end{bmatrix} = \\begin{bmatrix}
\\underset{(x,y)\\in W}\\sum I_x^2 &\\underset{(x,y)\\in W} \\sum I_x
I_y \\\\ \\underset{(x,y)\\in W}\\sum I_x I_y & \\underset{(x,y)\\in
W}\\sum I_y^2 \\end{bmatrix} </math>

## 哈里斯邊角偵測的流程\[4\]\[5\]

一般而言，哈里斯邊角偵測演算法可以分成下列幾個步驟:

1.  彩色影像轉換成灰階影像
2.  空間微分的計算
3.  建構結構張量
4.  計算哈里斯響應
5.  非極大值抑制

### 彩色影像轉換成灰階影像

如果輸入是一張彩色影像，第一步便是轉換成灰階影像，可以加快處理速度

### 空間微分的計算

第二步是計算整張圖的\(I_x( x, y), I_y( x, y)\) 。

### 建構結構張量

有了\(I_x( x, y), I_y( x, y)\)的資訊後，我們便可以建構結構張量\(M\)。

### 計算哈里斯響應

在這一步，我們會運用下列的近似的式子來計算結構張量矩陣的最小的特徵值:

\(\lambda _{min} \approx \frac{ \lambda _1 \lambda _2} {(\lambda _1+\lambda _2)} = \frac{det(M)} {trace(M)}\)

\(trace(M) = m_{11} + m_{22}\)

另外一種常見的哈里斯響應是

\(R = det(M) - k(trace(M))^2 = \lambda _1 \lambda _2 - k (\lambda _1 + \lambda _2)^2\)

而k是一個由經驗所訂出來的常數，\(k \in [0.04, 0.06]\)。

### 非極大值抑制

由於只靠前面的步驟選出的特徵點很可能會在一小塊區域有很多個，我們希望能在局部區域選出值最大的，因此會設定各個擁有局部最大值的特徵點的距離不能太接近，如此便可以有效選出比較分散在整張圖的特徵點。

## 改進的偵測演算法\[6\]\[7\]

1\. 哈里斯-拉普拉斯邊角偵測\[8\]

2\. Differential Morphological Decomposition Based Corner Detector\[9\]

3\. Multi-scale Bilatera Structure Tensor Based Corner Detector\[10\]

## 應用

1\. 影像對齊，影像縫合，影像配準\[11\]

2\. 建立二維馬賽克\[12\]

3\. 三維場景建模及重建\[13\]

4\. 動作偵測\[14\]

5\. 物體識別\[15\]

6\. 基于内容的影像檢索\[16\]

7\. 影片追蹤\[17\]

## 更多

  - [Structure
    tensor](https://zh.wikipedia.org/wiki/:en:Structure_tensor "wikilink")
  - [Harris affine region
    detector](https://zh.wikipedia.org/wiki/:en:Harris_affine_region_detector "wikilink")
  - [Corner
    detection](https://zh.wikipedia.org/wiki/:en:Corner_detection "wikilink")
  - [Feature detection (computer
    vision)](https://zh.wikipedia.org/wiki/:en:Feature_detection_\(computer_vision\) "wikilink")
  - [Computer
    vision](https://zh.wikipedia.org/wiki/:en:Computer_vision "wikilink")
  - [List of computer vision
    topics](https://zh.wikipedia.org/wiki/:en:List_of_computer_vision_topics "wikilink")

## 參考資料

<references>

\[18\] \[19\] \[20\]

</references>

## 外部連結

  - ["Learn OpenCV by Examples : Harris Corner
    Detection"](http://opencvexamples.blogspot.com/2013/10/harris-corner-detection.html)
  - ["Harris Corner Detection - OpenCV
    Documentation"](http://docs.opencv.org/2.4/doc/tutorials/features2d/trackingmotion/harris_detector/harris_detector.html)
  - ["Harris Corner Detection - OpenCV-Python
    Tutorials"](http://opencv-python-tutroals.readthedocs.org/en/latest/py_tutorials/py_feature2d/py_features_harris/py_features_harris.html)

[Category:影像科技](https://zh.wikipedia.org/wiki/Category:影像科技 "wikilink")

1.  <cite class="citation conference">Chris Harris and Mike Stephens
    (1988). "A Combined Corner and Edge Detector". *Alvey Vision
    Conference*.
    **15**.</cite><span title="ctx_ver=Z39.88-2004&rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Abook&rft.genre=conference&rft.atitle=A+Combined+Corner+and+Edge+Detector&rft.btitle=Alvey+Vision+Conference&rft.date=1988&rft.au=Chris+Harris+and+Mike+Stephens&rfr_id=info%3Asid%2Fen.wikipedia.org%3AHarris+Corner+Detector" class="Z3988"><span style="display:none;"> </span></span>

2.  <cite class="citation conference">Konstantinos G. Derpanis (2004).
    *The harris corner detector*. York
    University.</cite><span title="ctx_ver=Z39.88-2004&rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Abook&rft.genre=conference&rft.btitle=The+harris+corner+detector.&rft.pub=York+University&rft.date=2004&rft.au=Konstantinos+G.+Derpanis&rfr_id=info%3Asid%2Fen.wikipedia.org%3AHarris+Corner+Detector" class="Z3988"><span style="display:none;"> </span></span>

3.
4.

5.

6.

7.

8.

9.

10.

11.

12.

13.

14.

15.

16.

17.

18. <cite class="citation conference">Chris Harris and Mike Stephens
    (1988). "A Combined Corner and Edge Detector". *Alvey Vision
    Conference*.
    **15**.</cite><span title="ctx_ver=Z39.88-2004&rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Abook&rft.genre=conference&rft.atitle=A+Combined+Corner+and+Edge+Detector&rft.btitle=Alvey+Vision+Conference&rft.date=1988&rft.au=Chris+Harris+and+Mike+Stephens&rfr_id=info%3Asid%2Fen.wikipedia.org%3AHarris+Corner+Detector" class="Z3988"><span style="display:none;"> </span></span>

19. <cite class="citation conference">Dey, Nilanjan and; et al. (2012).
    "A Comparative Study between Moravec and Harris Corner Detection of
    Noisy Images Using Adaptive Wavelet Thresholding Technique". *arXiv
    preprint*.
    p. 1209.1558.</cite><span title="ctx_ver=Z39.88-2004&rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Abook&rft.genre=conference&rft.atitle=A+Comparative+Study+between+Moravec+and+Harris+Corner+Detection+of+Noisy+Images+Using+Adaptive+Wavelet+Thresholding+Technique&rft.btitle=arXiv+preprint&rft.pages=1209.1558&rft.date=2012&rft.au=Dey%2C+Nilanjan+and&rfr_id=info%3Asid%2Fen.wikipedia.org%3AHarris+Corner+Detector" class="Z3988"><span style="display:none;"> </span></span><span class="citation-comment" style="display:none; color:#33aa33; margin-left:0.3em">CS1
    maint: Explicit use of et al.
    ([link](https://zh.wikipedia.org/wiki/Category:CS1_maint:_Explicit_use_of_et_al. "wikilink"))
    </span>

20. <cite class="citation conference">Konstantinos G. Derpanis (2004).
    *The harris corner detector*. York
    University.</cite><span title="ctx_ver=Z39.88-2004&rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Abook&rft.genre=conference&rft.btitle=The+harris+corner+detector.&rft.pub=York+University&rft.date=2004&rft.au=Konstantinos+G.+Derpanis&rfr_id=info%3Asid%2Fen.wikipedia.org%3AHarris+Corner+Detector" class="Z3988"><span style="display:none;"> </span></span>
**均差**（Divided
differences）是[遞歸](https://zh.wikipedia.org/wiki/遞歸 "wikilink")[除法過程](../Page/除法.md "wikilink")。在[数值分析中](https://zh.wikipedia.org/wiki/数值分析 "wikilink")，可用於計算[牛頓多項式形式的](https://zh.wikipedia.org/wiki/牛頓多項式 "wikilink")[多項式插值的係數](https://zh.wikipedia.org/wiki/多項式插值 "wikilink")。在[微积分中](https://zh.wikipedia.org/wiki/微积分 "wikilink")，均差与[导数一起合称](../Page/导数.md "wikilink")[差商](https://zh.wikipedia.org/wiki/差商 "wikilink")，是对[函数在一个](../Page/函数.md "wikilink")[区间内的](https://zh.wikipedia.org/wiki/区间 "wikilink")[平均变化率的测量](https://zh.wikipedia.org/wiki/平均 "wikilink")\[1\]\[2\]\[3\]。

均差也是一种[算法](../Page/算法.md "wikilink")，[查尔斯·巴贝奇的](../Page/查尔斯·巴贝奇.md "wikilink")[差分机](https://zh.wikipedia.org/wiki/差分机 "wikilink")，是他在1822年发表的论文中提出的一种早期的，在历史上意图用来计算[对数表和](https://zh.wikipedia.org/wiki/对数 "wikilink")[三角函数表](../Page/三角函数.md "wikilink")，
它设计在其运算中使用这个算法\[4\]。

## 定義

給定n+1個數據點

\[(x_0, y_0),\ldots,(x_{n}, y_{n})\]

定義**前向均差**為：

\[\begin{align}
 \mathopen[y_\nu] &= y_\nu, \quad \nu \in \{ 0,\ldots,n\} \\
 \mathopen[y_\nu,\ldots,y_{\nu+j}] &= \frac{[y_{\nu+1},\ldots , y_{\nu+j}] - [y_{\nu},\ldots , y_{\nu+j-1}]}{x_{\nu+j}-x_\nu}, \quad \nu\in\{0,\ldots,n-j\},\ j\in\{1,\ldots,n\} \\
\end{align}\]

定義**後向均差**為：

\[\begin{align}
 \mathopen[y_\nu] &= y_{\nu},\quad \nu \in \{ 0,\ldots,n\} \\
 \mathopen[y_\nu,\ldots,y_{\nu-j}] &= \frac{[y_\nu,\ldots , y_{\nu-j+1}] - [y_{\nu-1},\ldots , y_{\nu-j}]}{x_\nu - x_{\nu-j}}, \quad \nu\in\{j,\ldots,n\},\ j\in\{1,\ldots,n\} \\
\end{align}\]

## 表示法

假定數據點給出為函數 ƒ，

\[(x_0, f(x_0)),\ldots,(x_{n}, f(x_{n}))\]

其均差可以寫為：

\[\begin{align}
 f[x_\nu] &= f(x_{\nu}), \qquad \nu \in \{ 0,\ldots,n \} \\
 f[x_\nu,\ldots,x_{\nu+j}] &= \frac{f[x_{\nu+1},\ldots , x_{\nu+j}] - f[x_\nu,\ldots , x_{\nu+j-1}]}{x_{\nu+j}-x_\nu}, \quad \nu\in\{0,\ldots,n-j\},\ j\in\{1,\ldots,n\}
\end{align}\]

對函數 ƒ 在節點 *x*<sub>0</sub>, ..., *x*<sub>*n*</sub> 上的均差還有其他表示法，如：

  -
    <math>\\begin{matrix}

`\mathopen [x_0,\ldots,x_n]f \\`

\\mathopen \[x_0,\\ldots,x_n;f\] \\\\ \\mathopen
D\[x_0,\\ldots,x_n\]f \\\\ \\end{matrix}</math>

## 例子

給定ν=0：

\[\begin{align}
  \mathopen[y_0] &= y_0 \\
  \mathopen[y_0,y_1] &= \frac{y_1-y_0}{x_1-x_0} \\
  \mathopen[y_0,y_1,y_2] &= \frac{\mathopen[y_1,y_2]-\mathopen[y_0,y_1]}{x_2-x_0} \\
  \mathopen[y_0,y_1,y_2,y_3] &= \frac{\mathopen[y_1,y_2,y_3]-\mathopen[y_0,y_1,y_2]}{x_3-x_0} \\
  \mathopen[y_0,y_1,\dots,y_n] &= \frac{\mathopen[y_1,y_2,\dots,y_n]-\mathopen[y_0,y_1,\dots,y_{n-1}]}{x_n-x_0}
\end{align}\]

為了使涉及的遞歸過程更加清楚，以列表形式展示均差的計算過程<ref>

\[\begin{array}{lcl}
{ \begin{matrix}
x_0 & x_0^2 &           &               \\
  &       &  x_0+x_1 &             & \\
x_1 & x_1^2 &         & 1 & \\
      & & x_1+x_2 &               & 0 \\
x_2 & x_2^2 &            & 1 &  \\
   & & x_2+x_3 &               &  & \\
x_3 & x_3^2 &           &       & \\
\end{matrix} } \\
 \\
{ \begin{matrix}
x_0 & x_0^n &    \\
  &       &  \sum_{i=0}^{n-1}x_0^{n-1-i}x_1^i \\
x_1 & x_1^n & \\
\end{matrix} } \\
\\
{ \begin{matrix}
x_0 & x_0^{n+1} &    \\
  &       &  \frac{x_1^{n+1}-x_1x_0^n+x_1x_0^n-x_0^{n+1}}{x_1-x_0} =x_1\frac {x_1^n-x_0^n}{x_1-x_0}+x_0^n=x_1\sum_{i=0}^{n-1}x_0^{n-1-i}x_1^i+x_0^n=\sum_{i=0}^{n}x_0^{n-i}x_1^i \\
x_1 & x_1^{n+1} & \\
\end{matrix} } \\
\\
{ \begin{matrix}
x_0 & x_0^{n+1} &  &  \\
  &       &  \sum_{i=0}^{n}x_0^{n-i}x_1^i & \\
x_1 & x_1^{n+1} &  & \frac {\sum_{i=0}^{n}x_1^{n-i}x_2^i - \sum_{i=0}^{n}x_0^{n-i}x_1^i}{x_2-x_0}=\frac{\sum_{i=0}^{n-1}x_1^{i}(x_2^{n-i}-x_0^{n-i})}{x_2-x_0}=\sum_{i+j+k=n-1}{x_0^{i}x_1^{j}x_2^{k}} \\
  &       &  \sum_{i=0}^{n}x_1^{n-i}x_2^i & \\
x_2 & x_2^{n+1} &  & \\
\end{matrix} } \\
\\
{ \begin{matrix}
x_0 & x_0^{n+1} &  &  & \\
  &       &  \sum_{i=0}^{n}x_0^{n-i}x_1^i & & \\
x_1 & x_1^{n+1} &  & \sum_{i+j+k=n-1}{x_0^{i}x_1^{j}x_2^{k}} & \\
  &       &  \sum_{i=0}^{n}x_1^{n-i}x_2^i & & \frac {\sum_{i+j+k=n-1}{x_1^{i}x_2^{j}x_3^{k}} - \sum_{i+j+k=n-1}{x_0^{i}x_1^{j}x_2^{k}}}{x_3-x_0}=\sum_{i+j+k+l=n-2}{x_0^{i}x_1^{j}x_2^{k}x_3^{l}} \\
x_2 & x_2^{n+1} &  &  \sum_{i+j+k=n-1}{x_1^{i}x_2^{j}x_3^{k}} &  \\
  &       &  \sum_{i=0}^{n}x_2^{n-i}x_3^i & & \\
x_3 & x_3^{n+1} &  & & \\
\end{matrix} } \\
\\
{ \begin{matrix}
x_0 & x_0^3 &           &               &  & \\
  &       & x_0^2+x_0x_1+x_1^2 &               & \\
x_1 & x_1^3 &           & x_0+x_1+x_2 &  & \\
      & & x_1^1+x_1x_2+x_2^2 &               & 1 & \\
x_2 & x_2^3 &           & x_1+x_2+x_3 &  & 0 \\
   & & x_2^2+x_2x_3+x_3^2 &               & 1 & \\
x_3 & x_3^3 &           &       x_2+x_3+x_4  &  & \\
    & & x_3^2+x_3x_4+x_4^2 &     &  & \\
x_4 & x_4^3 &           &               &  & \\
\end{matrix} } \\
 \\
{ \begin{matrix}
x_0 & x_0^4 &  &           &               &  & \\
    & &   x_0^3+x_0^2x_1+x_0x_1^2+x_1^3    &   &             & \\
x_1 & x_1^4 &  &      x_0^2+x_0x_1+x_1^2 +x_0x_2+x_1x_2+x_2^2   & &  & \\
      &  & x_1^3+x_1^2x_2+x_1x_2^2+x_2^3   &   & x_0+x_1+x_2+x_3  & \\
x_2 & x_2^4 &  &      x_1^2+x_1x_2+x_2^2 +x_1x_3 +x_2x_3+x_3^2     &  & 1 &  \\
   & & x_2^3+x_2^2x_3+x_2x_3^2+x_3^3  &  &  x_1+x_2+x_3+x_4    &  & 0 \\
x_3 & x_3^4 &  &     x_2^2+x_2x_3+x_3^2 +x_2x_4 +x_3x_4+x_4^2    &      & 1 & \\
   & &  x_3^3+x_3^2x_4+x_3x_4^2+x_4^3  &  & x_2+x_3+x_4+x_5     &  & \\
x_4 & x_4^4 &  &    x_3^2+x_3x_4+x_4^2  +x_3x_5 +x_4x_5+x_5^2      &     &  & \\
    & &  x_4^3+x_4^2x_5+x_4x_5^2+x_5^3  &  &     &  & \\
x_5 & x_5^4 & &         &               &  & \\
\end{matrix} } \\
\\
{ \begin{matrix}
x_0 & x_0^5 &  &           &               &  &  &\\
    & &  \sum_{i=0}^{4}x_0^{4-i}x_1^i  &   &             & &\\
x_1 & x_1^5 &  & \sum_{i+j+k=3}x_0^{i}x_1^jx_2^k    & &  & &\\
      &  & \sum_{i=0}^{4}x_1^{4-i}x_2^i  &   & \sum_{i+j+k+l=2}x_0^{i}x_1^jx_2^kx_3^l  & & &\\
x_2 & x_2^5 &  &     \sum_{i+j+k=3}x_1^{i}x_2^jx_3^k  &  & \sum_{i=0}^4x_i &  &\\
   & & \sum_{i=0}^{4}x_2^{4-i}x_3^i  &  &  \sum_{i+j+k+l=2}x_1^{i}x_2^jx_3^kx_4^l   &  & 1 &\\
x_3 & x_3^5 &  &     \sum_{i+j+k=3}x_2^{i}x_3^jx_4^k     &      &  \sum_{i=1}^5x_i & & 0\\
   & &  \sum_{i=0}^{4}x_3^{4-i}x_4^i  &  & \sum_{i+j+k+l=2}x_2^{i}x_3^jx_4^jx_5^l      &  &1 &\\
x_4 & x_4^5 &  &    \sum_{i+j+k=3}x_3^{i}x_4^jx_5^k     &     &  \sum_{i=2}^6x_i & &\\
    & &  \sum_{i=0}^{4}x_4^{4-i}x_5^i &  &   \sum_{i+j+k+l=2}x_3^{i}x_4^jx_5^kx_6^l   &  & &\\
x_5 & x_5^5 & &    \sum_{i+j+k=3}x_4^{i}x_5^jx_6^k    &               &  & &\\
    & &  \sum_{i=0}^{4}x_5^{4-i}x_6^i  &  &     &  & &\\
x_6 & x_6^5 & &         &               &  & &\\
\end{matrix} } \\
\end{array}\]</ref>：

\[\begin{matrix}
x_0 & [y_0] = y_0 &           &               & \\
        &       & [y_0,y_1] &               & \\
x_1 & [y_1] = y_1 &           & [y_0,y_1,y_2] & \\
        &       & [y_1,y_2] &               & [y_0,y_1,y_2,y_3]\\
x_2 & [y_2] = y_2 &           & [y_1,y_2,y_3] & \\
        &       & [y_2,y_3] &               & \\
x_3 & [y_3] = y_3 &           &               & \\
\end{matrix}\]

## 展開形式

用[數學歸納法可證明](https://zh.wikipedia.org/wiki/數學歸納法 "wikilink")<ref>

\[\begin{align}
\mathopen[y_0] &= y_0 \\
\mathopen[y_0,y_1] &= \frac{y_1-y_0}{x_1-x_0} = \frac{y_0}{x_0-x_1} + \frac{y_1}{x_1-x_0}\\
 &= \sum_{j=0}^{1}   \frac{y_j} { \prod_{k=0,k\neq j}^{1} (x_j-x_k)}  \\
\mathopen[y_0,y_1,y_2] &= \frac{\cfrac{y_1}{x_1-x_2} + \cfrac{y_2}{x_2-x_1} - \cfrac{y_0}{x_0-x_1} - \cfrac{y_1}{x_1-x_0}}{x_2-x_0} \\
 &= \frac{y_0}{(x_0-x_1)(x_0-x_2)} + \frac{y_1}{(x_1-x_0)(x_1-x_2)} + \frac{y_2}{(x_2-x_0)(x_2-x_1)} \\
 &= \sum_{j=0}^{2}    \frac{y_j} {\prod_{k=0,k\neq j}^{2} (x_j-x_k)} \\
\mathopen[y_0, y_1,\dots, y_n] &=\sum_{j=0}^{n}  \frac{y_j} {\prod_{k=0,k\neq j}^{n} (x_j-x_k)}  \\
\mathopen[y_0, y_1,\dots, y_{n+1}] &=\frac{\sum_{j=1}^{n+1} \frac{y_j}{\prod_{k=1,\, k\neq j}^{n+1} (x_j-x_k)} - \sum_{j=0}^{n} \frac{y_j}{\prod_{k=0,\, k\neq j}^{n} (x_j-x_k)}}{x_{n+1}-x_0} \\
 &= \frac{\frac {y_{n+1}}{\prod_{k=1}^{n} (x_{n+1}-x_k)} + \sum_{j=1}^{n} y_j\left(\frac{1}{\prod_{k=1,\, k\neq j}^{n+1} (x_j-x_k)}-\frac{1}{\prod_{k=0,\, k\neq j}^{n} (x_j-x_k)}\right)  - \frac{y_0}{\prod_{k=1}^{n} (x_0-x_k)}}{x_{n+1}-x_0} \\
 &= \frac{\frac {y_{n+1}}{\prod_{k=1}^{n} (x_{n+1}-x_k)} + \sum_{j=1}^{n} y_j\left(\frac{x_j-x_0}{\prod_{k=0,\, k\neq j}^{n+1} (x_j-x_k)}-\frac{x_j-x_{n+1}}{\prod_{k=0,\, k\neq j}^{n+1} (x_j-x_k)}\right)  - \frac{y_0}{\prod_{k=1}^{n} (x_0-x_k)}}{x_{n+1}-x_0} \\
 &= \frac{\frac {y_{n+1}}{\prod_{k=1}^{n} (x_{n+1}-x_k)} + \sum_{j=1}^{n} y_j\left(\frac{x_{n+1}-x_0}{\prod_{k=0,\, k\neq j}^{n+1} (x_j-x_k)}\right)  - \frac{y_0}{\prod_{k=1}^{n} (x_0-x_k)}}{x_{n+1}-x_0} \\
 &= \frac {y_{n+1}}{\prod_{k=0}^{n} (x_{n+1}-x_k)} + \sum_{j=1}^{n} \frac{y_j}{\prod_{k=0,\, k\neq j}^{n+1} (x_j-x_k)} + \frac{y_0}{\prod_{k=1}^{n+1} (x_0-x_k)}\\
 &=\sum_{j=0}^{n+1} \frac{y_j}{\prod_{k=0,\, k\neq j}^{n+1} (x_j-x_k)}
\end{align}\] </ref>：

\[\begin{align}
\mathopen[y_0] &= y_0 \\
\mathopen[y_0,y_1] &= \frac{y_0}{x_0-x_1} + \frac{y_1}{x_1-x_0} \\
\mathopen[y_0,y_1,y_2] &= \frac{y_0}{(x_0-x_1)(x_0-x_2)} + \frac{y_1}{(x_1-x_0)(x_1-x_2)} + \frac{y_2}{(x_2-x_0)(x_2-x_1)} \\
\mathopen[y_0, y_1,\dots, y_n] &=\sum_{j=0}^{n} \frac{y_j}{\prod_{k=0,\, k\neq j}^{n} (x_j-x_k)} \\
\end{align}\] 此公式體現了均差的對稱性質。\[5\]故可推知：任意调换數據點次序，其值不变。\[6\]

## 性质

  - 对称性：若\(\sigma : \{0, \dots, n\} \to \{0, \dots, n\}\)是一个[排列则](https://zh.wikipedia.org/wiki/排列 "wikilink")

<!-- end list -->

  -

      -
        \(f[x_0, \dots, x_n] = f[x_{\sigma(0)}, \dots, x_{\sigma(n)}]\)

<!-- end list -->

  - [線性](../Page/線性函數.md "wikilink")：

<!-- end list -->

  -

      -
        <math>\\begin{align}

(f+g)\[x_0,\\dots,x_n\] &= f\[x_0,\\dots,x_n\] +
g\[x_0,\\dots,x_n\] \\\\ (\\lambda\\cdot f)\[x_0,\\dots,x_n\] &=
\\lambda\\cdot f\[x_0,\\dots,x_n\] \\\\ \\end{align}</math>

  - ：

<!-- end list -->

  -

      -
        \((f\cdot g)[x_0,\dots,x_n] = f[x_0]\cdot g[x_0,\dots,x_n] + f[x_0,x_1]\cdot g[x_1,\dots,x_n] + \dots + f[x_0,\dots,x_n]\cdot g[x_n]\)

<!-- end list -->

  - ：

\[\exists \xi \in (\min\{x_0,\dots,x_n\},\max\{x_0,\dots,x_n\}) \quad  f[x_0,\dots,x_n] = \frac{f^{(n)}(\xi)}{n!}\]

## 等價定義

通過對換 n
阶均差中(x<sub>0</sub>,y<sub>0</sub>)与(x<sub>n-1</sub>,y<sub>n-1</sub>)，可得到等價定義：

\[\begin{align}
  \mathopen[y_0,y_1,\dots,y_{n-1},y_n] &= \frac{\mathopen[y_1,y_2,\dots,y_n]-\mathopen[y_0,y_1,\dots,y_{n-1}]}{x_n-x_0} \\
  &= \frac{\mathopen[y_1,\dots,y_{n-2},y_0,y_n]-\mathopen[y_{n-1},y_1,\dots,y_{n-2},y_0]}{x_n-x_{n-1}} \\
  &= \frac{\mathopen[y_0,\dots,y_{n-2},y_n]-\mathopen[y_0,y_1,\dots,y_{n-1}]}{x_n-x_{n-1}} \\
\end{align}\] 這個定義有著不同的計算次序：

\[\begin{align}
  \mathopen[y_0] &= y_0 \\
  \mathopen[y_0,y_1] &= \frac{y_1-y_0}{x_1-x_0} \\
  \mathopen[y_0,y_1,y_2] &=  \frac{\mathopen[y_0,y_2]-\mathopen[y_0,y_1]}{x_2-x_1} \\
  \mathopen[y_0,y_1,y_2,y_3] &= \frac{\mathopen[y_0,y_1,y_3]-\mathopen[y_0,y_1,y_2]}{x_3-x_2} \\
  \mathopen[y_0,y_1,\dots,y_n] &= \frac{\mathopen[y_0,\dots,y_{n-2},y_n]-\mathopen[y_0,y_1,\dots,y_{n-1}]}{x_n-x_{n-1}} \\
 \end{align}\] 以列表形式展示這個定義下均差的計算過程<ref>

\[\begin{matrix}
x_0 & x_0^3 &           &               &  & \\
  &       & x_0^2+x_0x_1+x_1^2 &               & \\
x_1 & x_1^3 &           & x_0+x_1+x_2 &  & \\
      & & x_0^2+x_0x_2+x_2^2 &               & 1 & \\
x_2 & x_2^3 &           & x_0+x_1+x_3 &  & 0 \\
   & & x_0^2+x_0x_3+x_3^2 &               & 1 & \\
x_3 & x_3^3 &           &       x_0+x_1+x_4  &  & \\
    & & x_0^2+x_0x_4+x_4^2 &     &  & \\
x_4 & x_4^3 &           &               &  & \\
\end{matrix}\]</ref>：

\[\begin{matrix}
x_0 & [y_0] = y_0 &           &               & \\
        &       & [y_0,y_1] &               & \\
x_1 & [y_1] = y_1 &           & [y_0,y_1,y_2] & \\
        &       & [y_0,y_2] &               & [y_0,y_1,y_2,y_3]\\
x_2 & [y_2] = y_2 &           & [y_0,y_1,y_3] & \\
        &       & [y_0,y_3] &               & \\
x_3 & [y_3] = y_3 &           &               & \\
\end{matrix}\]

## 牛頓插值法

[Principia1846-466.png](https://zh.wikipedia.org/wiki/File:Principia1846-466.png "fig:Principia1846-466.png")》的第三編“宇宙體系”的引理五的图例。這裡在橫坐標上有6個點H,I,K,L,M,N，對應著6個值A,B,C,D,E,F，生成一個多項式函數對這6個點上有對應的6個值，計算任意點S對應的值R。牛頓給出了間距為單位值和任意值的兩種情況。\]\]
牛頓插值公式，得名於[伊薩克·牛頓爵士](https://zh.wikipedia.org/wiki/伊薩克·牛頓 "wikilink")，最早发表为他在1687年出版的《[自然哲學的數學原理](https://zh.wikipedia.org/wiki/自然哲學的數學原理 "wikilink")》中第三編“宇宙體系”的引理五，此前[詹姆斯·格雷果里於](https://zh.wikipedia.org/wiki/詹姆斯·格雷果里 "wikilink")1670年和牛頓於1676年已經分別獨立得出這個成果。一般稱其為連續[泰勒展開的離散對應](https://zh.wikipedia.org/wiki/泰勒級數 "wikilink")。

使用均差的[牛顿插值法為](https://zh.wikipedia.org/wiki/牛顿插值法 "wikilink")\[7\]：

\[\begin{align}
N_n(x) &= y_0 + (x-{x}_{0})\left([{y}_{0}, {y}_{1}] + (x-{x}_{1})\left([{y}_{0}, {y}_{1},{y}_{2}] + \cdots\right)\right) \\
 &=[y_0]+[{y}_{0}, {y}_{1}](x-{x}_{0})+\cdots+[{y}_{0},{y}_{1},\ldots,{y}_{n}]\prod_{k=0}^{n-1} (x-{x}_{k})
\end{align}\]
可以在计算过程中任意增添节点如點(x<sub>n+1</sub>,y<sub>n+1</sub>)，只需計算新增的n+1階均差及其插值基函數，而无[拉格朗日插值法需重算全部插值基函数之虞](../Page/拉格朗日插值法.md "wikilink")。

對均差採用展開形式<ref>

\[\begin{array}{lcl}
\begin{align}
N_1(x) &=[y_0]+[{y}_{0}, {y}_{1}](x-{x}_{0}) = y_0 + y_0\frac{x-{x}_{0}}{x_0-x_1}+ y_1\frac{x-{x}_{0}}{x_1-x_0} = y_0(1 + \frac{x-{x}_{0}}{x_0-x_1})+ y_1\frac{x-{x}_{0}}{x_1-x_0} \\
&= y_0\frac{x-{x}_{1}}{x_0-x_1}+ y_1\frac{x-{x}_{0}}{x_1-x_0} = \sum_{j=0}^{1} y_j  \prod_{ k=0 ,k \neq j}^{1} \frac{x-{x}_{k}} { x_j-x_k}  \\
\end{align} \\
\begin{align}
N_n(x) &= \sum_{j=0}^{n} y_j  \prod_{k=0,k\neq j}^{n} \frac{x-{x}_{k}} { x_j-x_k}  \\
\end{align} \\
\begin{align}
N_{n+1}(x) &=N_n(x)+[{y}_{0},{y}_{1},\ldots,{y}_{n+1}]\prod_{k=0}^{n} (x-{x}_{k}) \\
&= \sum_{j=0}^{n} y_j  \prod_{k=0, k\neq j}^{n} \frac{x-{x}_{k}} { x_j-x_k} + \sum_{j=0}^{n+1} y_j  \frac{\prod_{k=0}^{n} (x-{x}_{k})} {\prod_{k=0,\, k\neq j}^{n+1} (x_j-x_k)} \\
&= \sum_{j=0}^{n} y_j \left(  \frac{\prod_{k=0, k\neq j}^{n}(x-{x}_{k})} {\prod_{k=0, k\neq j}^{n}(x_j-x_k)} + \frac{\prod_{k=0}^{n} (x-{x}_{k})} {\prod_{k=0,\, k\neq j}^{n+1} (x_j-x_k)} \right) +  y_{n+1}  \frac{\prod_{k=0}^{n} (x-{x}_{k})} {\prod_{k=0}^{n} (x_{n+1}-x_k)} \\
&= \sum_{j=0}^{n} y_j \left(  \frac{\left(\prod_{k=0, k\neq j}^{n}(x-{x}_{k})\right)(x_j-x_{n+1})} {\prod_{k=0, k\neq j}^{n+1}(x_j-x_k)} + \frac{\left(\prod_{k=0,k \neq j}^{n} (x-{x}_{k})\right)(x-x_j)} {\prod_{k=0,\, k\neq j}^{n+1} (x_j-x_k)} \right) +  y_{n+1}  \frac{\prod_{k=0}^{n} (x-{x}_{k})} {\prod_{k=0}^{n} (x_{n+1}-x_k)} \\
&= \sum_{j=0}^{n} y_j  \frac{\left(\prod_{k=0, k\neq j}^{n}(x-{x}_{k})\right)(x-x_{n+1})} {\prod_{k=0, k\neq j}^{n+1}(x_j-x_k)} +  y_{n+1}  \frac{\prod_{k=0}^{n} (x-{x}_{k})} {\prod_{k=0}^{n} (x_{n+1}-x_k)} \\
&= \sum_{j=0}^{n+1} y_j  \prod_{k=0,k\neq j}^{n+1} \frac{x-{x}_{k}} { x_j-x_k}  \\
\end{align} \\
\end{array}\]</ref>：

\[\begin{align}
 N_n(x) &= y_0 + y_0\frac{x-{x}_{0}}{x_0-x_1}+ y_1\frac{x-{x}_{0}}{x_1-x_0}+\cdots+ \sum_{j=0}^{n} y_j  \frac{\prod_{k=0}^{n-1} (x-{x}_{k})} {\prod_{k=0,\, k\neq j}^{n} (x_j-x_k)} \\
\end{align}\]

以2階均差牛頓插值為例：

\[\begin{align}
 N_2(x)&=y_0\left(1+ \frac{x-{x}_{0}}{x_0-x_1}+\frac{(x-x_0)(x-x_1)}{(x_0-x_1)(x_0-x_2)}\right) + y_1\left(\frac{x-{x}_{0}}{x_1-x_0}+\frac{(x-x_0)(x-x_1)}{(x_1-x_0)(x_1-x_2)}\right) + y_2\frac{(x-x_0)(x-x_1)}{(x_2-x_0)(x_2-x_1)} \\
 &=y_0\frac{(x-x_1)(x-x_2)}{(x_0-x_1)(x_0-x_2)} + y_1\frac{(x-x_0)(x-x_2)}{(x_1-x_0)(x_1-x_2)} + y_2\frac{(x-x_0)(x-x_1)}{(x_2-x_0)(x_2-x_1)} \\
 &= \sum_{j=0}^{2} y_j  \prod_{\begin{smallmatrix} k=0 \\ k\neq j \end{smallmatrix}}^{2} \frac{x-{x}_{k}} { x_j-x_k}  \\
\end{align}\]

## 前向差分

當數據點呈等距分佈的時候，這個特殊情況叫做“前向[差分](../Page/差分.md "wikilink")”。它們比計算一般的均差要容易。

### 定義

給定n+1個數據點

\[(x_0, y_0),\ldots,(x_{n}, y_{n})\]

有著

\[x_i = x_0 + ih , \quad  h > 0 \mbox{ , } 0 \le i \le n\]

定義前向[差分為](../Page/差分.md "wikilink")：

\[\begin{align}
 \triangle^{0}y_{i} &= y_{i} \\
 \triangle^{k}y_{i} &= \triangle^{k-1}y_{i+1} - \triangle^{k-1}y_{i} , \quad 1 \le k \le n-i\\
\end{align}\]

前向差分所对应的均差为\[8\]：

\[f[x_0, x_1, \ldots , x_k] = \frac{1}{k!h^k}\Delta^{(k)}f(x_0)\]

### 例子

\[\begin{matrix}
y_0 &               &                   &                  \\
    & \triangle y_0 &                   &                  \\
y_1 &               & \triangle^{2} y_0 &                  \\
    & \triangle y_1 &                   & \triangle^{3} y_0\\
y_2 &               & \triangle^{2} y_1 &                  \\
    & \triangle y_2 &                   &                  \\
y_3 &               &                   &                  \\
\end{matrix}\]

### 展開形式

差分的展開形式是均差展開形式的特殊情況<ref>

\[\begin{align}
 \triangle^{k}y_{i} &= \sum_{j = 0}^{k} \frac{k!}{\prod_{l=0,\, l\neq j}^{k} (j-l)} y_{i+j}, \quad 0 \le k \le n-i \\
  &= \sum_{j = 0}^{k} \frac{k!}{j!(-1)^{k-j}(k-j)!} y_{i+j}, \quad 0 \le k \le n-i \\
  &= \sum_{j = 0}^{k} (-1)^{k-j} \binom{k}{j} y_{i+j}, \quad 0 \le k \le n-i
\end{align}\]</ref>：

\[\begin{align}
  \triangle^{k}y_{i} &= \sum_{j = 0}^{k} (-1)^{k-j} \binom{k}{j} y_{i+j}, \quad 0 \le k \le n-i
\end{align}\] 這裡的表達式

\[{n \choose k} = \frac{(n)_k}{k!} \quad\quad (n)_k=n(n-1)(n-2)\cdots(n-k+1)\]
是[二項式係數](../Page/二項式係數.md "wikilink")，其中的(n)<sub>k</sub>是“[下降階乘冪](https://zh.wikipedia.org/wiki/下降階乘冪 "wikilink")”，[空積](https://zh.wikipedia.org/wiki/空積 "wikilink")(n)<sub>0</sub>被定義為1。

### 插值公式

其對應的牛頓插值公式為：

\[\begin{align}
f(x) &= y_0 + \frac {x-x_0} {h} \left( \Delta^1y_0 + \frac {x-x_0-h} {2h}\left(\Delta^2y_0 + \cdots \right) \right) \\
 &= y_0 + \sum_{k=1}^n \frac{\Delta^ky_0}{k!h^k} \prod_{i=0}^{n-1} (x-x_0-ih) \\
 &= y_0 + \sum_{k=1}^n \frac{\Delta^ky_0}{k!} \prod_{i=0}^{n-1} (\frac{x-x_0}{h}-i) \\
 &= \sum_{k=0}^n {\frac{x-x_0}{h} \choose k}~ \Delta^k y_0 \\
\end{align}\]

### 無窮級數

[牛頓在](https://zh.wikipedia.org/wiki/伊薩克·牛頓 "wikilink")1665年得出並在1671年寫的《流數法》中發表了ln(1+x)的[無窮級數](https://zh.wikipedia.org/wiki/無窮級數 "wikilink")，在1666年得出了arcsin(x)和arctan(x)的無窮級數，在1669年的《分析學》中發表了sin(x)、cos(x)、arcsin(x)和e<sup>x</sup>的無窮級數；[萊布尼茨在](https://zh.wikipedia.org/wiki/萊布尼茨 "wikilink")1673年大概也得出了sin(x)、cos(x)和arctan(x)的無窮級數。[布魯克·泰勒在](https://zh.wikipedia.org/wiki/布魯克·泰勒 "wikilink")1715年著作《[Methodus
Incrementorum Directa et
Inversa](http://www.17centurymaths.com/contents/taylorscontents.html)》中研討了“有限差分”方法，其中論述了他在1712年得出的[泰勒定理](https://zh.wikipedia.org/wiki/泰勒定理 "wikilink")，這個成果此前[詹姆斯·格雷果里在](https://zh.wikipedia.org/wiki/詹姆斯·格雷果里 "wikilink")1670年和[萊布尼茨在](https://zh.wikipedia.org/wiki/萊布尼茨 "wikilink")1673年已經得出，而[約翰·伯努利在](https://zh.wikipedia.org/wiki/約翰·伯努利 "wikilink")1694年已經在《教師學報》發表。

他對牛頓的均差的步長取趨於0的[極限](https://zh.wikipedia.org/wiki/極限_\(數學\) "wikilink")，得出：

  -
    <math>

\\begin{align} f(x) &= f(a) + \\lim_{h \\to 0}\\sum_{k=1}^\\infty
\\frac{\\Delta_h^k\[f\](a)}{k\!h^k} \\prod_{i=0}^{k-1} ((x-a)-ih) \\\\

`&= f(a) + \sum_{k=1}^\infty \frac{d^k}{dx^k}f(a) \frac{(x-a)^k}{k!} \\`

\\end{align} </math>

## 冪函數的均差

使用普通函數記號表示冪运算，\(p_n(x) = x^n\)，有：

\[\begin{align}
p_j[x_0,\dots,x_n] &= 0 \qquad \forall j<n\\
p_n[x_0,\dots,x_n] &= 1 \\
p_{n+1}[x_0,\dots,x_n] &= x_0 + \dots + x_n \\
p_{n+m}[x_0,\dots,x_n]&= \sum_{k_0+\cdots+k_n=m} \begin{matrix} \prod_{t=0}^nx_{t}^{k_{t}} \end{matrix} \\
\end{align}\]
此中n+1元m次[齊次多項式的記法同於](https://zh.wikipedia.org/wiki/齊次多項式 "wikilink")[多項式定理](https://zh.wikipedia.org/wiki/多項式定理 "wikilink")。

## 泰勒形式

[泰勒級數和任何其他的函數級數](https://zh.wikipedia.org/wiki/泰勒級數 "wikilink")，在原理上都可以用來逼近均差。將泰勒級數表示為:

\[f = f(0) p_0 + f'(0) p_1 + \frac{f''(0)}{2!} p_2 + \dots\]

均差的泰勒級數為：

\[f[x_0,\dots,x_n] = f(0)p_0[x_0,\dots,x_n] + f'(0) p_1[x_0,\dots,x_n] + \dots + \frac{f^{(n)}(0)}{n!} p_n[x_0,\dots,x_n] + \dots\]

前\(n\)項消失了，因為均差的階高於多項式的階。可以得出均差的泰勒級數本質上開始於：

\[\frac{f^{(n)}(0)}{n!}\] 依據，這也是均差的最簡單逼近。

## 皮亞諾形式

均差還可以表達為

\[f[x_0,\ldots,x_n] = \frac{1}{n!} \int_{x_0}^{x_n} f^{(n)}(t)B_{n-1}(t) \, dt\]
這裡的B<sub>n-1</sub>是數據點x<sub>0</sub>,...,x<sub>n</sub>的n-1次[B樣條](https://zh.wikipedia.org/wiki/B樣條 "wikilink")，而f<sup>(n)</sup>是函數f的n階[導數](https://zh.wikipedia.org/wiki/導數 "wikilink")。這叫做均差的**皮亞諾形式**，而B<sub>n-1</sub>是均差的[皮亞諾核](https://zh.wikipedia.org/wiki/皮亞諾 "wikilink")。

## 註釋與引用

## 参考书目

  -
  -
  -
## 參見

  - [差分](../Page/差分.md "wikilink")
  - [差商](https://zh.wikipedia.org/wiki/差商 "wikilink")
  - [插值](../Page/插值.md "wikilink")
  - [牛頓多項式](https://zh.wikipedia.org/wiki/牛頓多項式 "wikilink")

[Category:微分学](https://zh.wikipedia.org/wiki/Category:微分学 "wikilink")
[Category:数值分析](https://zh.wikipedia.org/wiki/Category:数值分析 "wikilink")

1.
2.
3.
4.
5.  《数值分析及科学计算》 薛毅（编） 第六章 第2节 Newton插值. P200.
6.  《数值分析及科学计算》 薛毅（编） 第六章 第2节 Newton插值. P201.
7.  [The Newton Polynomial
    Interpolation](http://fourier.eng.hmc.edu/e176/lectures/ch7/node4.html)
8.
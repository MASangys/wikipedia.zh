> 本文内容由[大衍求一术](https://zh.wikipedia.org/wiki/大衍求一术)转换而来。


**大衍求一术**，又名**求一术**，是中国数学史中通常被用来泛指[南宋](../Page/南宋.md "wikilink")数学家[秦九韶](../Page/秦九韶.md "wikilink")发明的求解[中国剩余定理](../Page/中国剩余定理.md "wikilink")的历史算法（不是中国剩余定理的现代算法）。秦九韶原来的《数书九章》求解一次同余式组的算法的总称叫做**大衍总数术**，或**大衍术**、而其中一个计算**乘率**的子程序，才是**大衍求一术**。

大衍术是秦九韶最得意的创作，特放在《数书九章》之首。欧洲直到18世纪德国数学家[高斯](https://zh.wikipedia.org/wiki/高斯 "wikilink")，才有相类的结果。秦九韶大衍术领先世界五百余年。

## 历史

一次同余式组问题，最早见于《[孙子算经](../Page/孙子算经.md "wikilink")》卷下第二十六问：

  -
    宋周密《志雅堂杂钞》述**鬼谷算**，又名**隔墙算**。
    [杨辉](../Page/杨辉.md "wikilink")《继古摘奇算法》记载**剪管术**解孙子物不知数的算法：

明严恭《通源算法》：\[1\]

明朝数学家[程大位](../Page/程大位.md "wikilink")有《孙子歌》如下：\[2\]

清代学者张敦仁在《求一算术》中提出大衍求一术源自《孙子算经》物不知数，后世学者，多从其说。但近年[李俨](../Page/李俨_\(现代学者\).md "wikilink")、[钱宝琮](../Page/钱宝琮.md "wikilink")等学者提出大衍求一术很可能源自西汉《[三统历](https://zh.wikipedia.org/wiki/三统历 "wikilink")》中计算[上元积年的](https://zh.wikipedia.org/wiki/上元积年 "wikilink")“通其率”近似法，其后《[古四分历](https://zh.wikipedia.org/wiki/古四分历 "wikilink")》和《[乾象历](https://zh.wikipedia.org/wiki/乾象历 "wikilink")》沿用此法。\[3\]\[4\]

事实上，秦九韶在《数书九章序》中就写道：“独大衍法不载《九章》，未有能推之者，历家推演法颇用之”，“历家虽用，其用不知，小试经世，姑推所为，述大衍第一。”

## 大衍总数术

[Shuxuejiuzhang-020-020.jpg](https://zh.wikipedia.org/wiki/File:Shuxuejiuzhang-020-020.jpg "fig:Shuxuejiuzhang-020-020.jpg")

秦九韶大衍总数术原载《数书九章》第一卷上 大衍类 《蓍卦发微》：

程序如下：\[5\]\[6\]\[7\]。

  -
    1。将问数（有关问题中的数字）\[\(m_{1}\)，\(m_{2}\)……\(m_{n}\)\]，分为四大类

<!-- end list -->

  - 元数：整数
  - 收数：带小数的有理数。
  - 通数：分数
  - 复数：10的倍数。

<!-- end list -->

  -
    2.如果问数\[\(m_{1}\)，\(m_{2}\)……\(m_{n}\)\]是收数，则以10的倍数乘之化为元数列，按元数计算。
    3：如果问数\[\(m_{1}\)，\(m_{2}\)……\(m_{n}\)\]包含分数，则化为元数列，按元数计算。

<!-- end list -->

  -
    4。当问数\[\(m_{1}\)，\(m_{2}\)……\(m_{n}\)\]是整数
    4.1:将问数成对以其最大公约数约化，约奇数不约偶数；如二数都是偶数，约化其中之一。如二数中一个数是10的倍数，另一数的个位是5，则约化偶数不约化奇数。最后得到一组

**定母**：\[\(m'_{1}\)，\(m'_{2}\)……\(m'_{n}\)\]。

**定母**之中避免过多1，得到一个“1”即可。各定母为相应问数的因子；定母两两互为质数。定母的乘积称为**衍母**，是问数的最小公倍数。

  -
    **衍母** v=∏ \(m'_{i}\); i=1…n;
    4.3：将各定母分别除衍母，得到一组**衍数**：\[\(M_{1}\)，\(M_{2}\)……\(M_{n}\)\]
    其中 **衍数** \(M_{i}=\) v/\(m'_{i}\)
    4.4 用**定母**\(m'_{i}\) 约化**衍数**\(M_{i}\) (i=1……n)；余数\(d_{i}\) 称为**奇数**。

<!-- end list -->

  -
    4.4 当**奇数**\(d_{i}\)=1时，**乘率**\(x_{i}\)=**定母**\(m'_{i}\)。
    4.5 当**奇数**\(d_{i}\)≠1时，从**定母**\(m'_{i}\)和**奇数**\(d_{i}\)，用**大衍求一术**计算**乘率**\(x_{i}\)；（i=1……n)；
    例一：《孙子算经》“物不知数”，

:\*问数：3，5，7；因两两互素，也即定母。

:\*定母：3，5，7

:\*衍母 =3\*5\*7=105

:\*衍数=35，21，15

:\*奇数：2，1，1

:\*乘率：?,5,7

  -
    例二：问数108，57，75，40
    定数：27，19，25，8
      - 衍母 =27\*19\*25\*8=102600
      - 衍数=3800，5400，4104，12825
      - 奇数：20， 4， 4， 1
      - 乘率：？，？，？，8

## 大衍求一术

### 求乘率

[Shuxuejiuzhang-028-028.jpg](https://zh.wikipedia.org/wiki/File:Shuxuejiuzhang-028-028.jpg "fig:Shuxuejiuzhang-028-028.jpg")

秦九韶用大衍求一术解：

  -
    乘率 \* 奇数≡1（mod 定母）

例一：定母 83，奇数 65，求乘率x\[8\]\[9\]

  -
    x\*65≡1 mod（83）
    答：乘率=23
    置天元一于左上角，置奇数于右上角，置定数右下角，置0于左下角。

|    |    |  |
| -- | -- |  |
| 大衍 | 奇数 |  |
| 0  | 定母 |  |

|   |    |  |
| - | -- |  |
| 1 | 65 |  |
| 0 | 83 |  |

  -
    83/65 =1， 置左下，余数 18 置右下。

|   |    |   |
| - | -- | - |
| 1 | 65 | 0 |
| 1 | 18 | 1 |

  -
    65/18 商=3，加于左上，余数11，置右上

|   |    |   |
| - | -- | - |
| 4 | 11 | 3 |
| 1 | 18 | 0 |

  -
    18/11，商=1，乘左上，加于左下，余数7，置右下。

|   |    |   |
| - | -- | - |
| 4 | 11 | 0 |
| 5 | 7  | 1 |

  -
    余类推，直到右上=1 为止。

|   |   |   |
| - | - | - |
| 9 | 4 | 1 |
| 5 | 7 | 0 |

|    |   |   |
| -- | - | - |
| 9  | 4 | 0 |
| 14 | 3 | 1 |

|    |   |   |
| -- | - | - |
| 23 | 1 | 1 |
| 14 | 3 | 0 |

  -
    右上=1，左上=23=乘率。

\(23 * 65=1495=\)1 (mod 83)

## 参考文献

### 引用

### 来源

  - [李俨](../Page/李俨_\(现代学者\).md "wikilink") ：《大衍求一术的过去和未来》《李俨钱宝琮科学史全集》卷6 121页《程大位的孙子歌》辽宁教育出版社. 1998
  - [钱宝琮](../Page/钱宝琮.md "wikilink")：《秦九韶数书九章研究》》《李俨钱宝琮科学史全集》卷9
  - [吴文俊](../Page/吴文俊.md "wikilink") 主编：《[中国数学史大系](https://zh.wikipedia.org/wiki/中国数学史大系 "wikilink")》 第五卷 第三、四、五编
  - 吴文俊 主编：《秦九韶与数书九章》 北京师范大学出版社 1987
  - ［比利时］李倍始（Ulrich Libbrecht）：*Chinese Mathematics in the Thirteen Century (The Shu-Shu-Chiu-Chang of Chin Chiu shao)* Dover Publication ISBN 0486446190
  - [秦九韶](../Page/秦九韶.md "wikilink") 原著，王守义 遗著，李俨 审校：《数书九章新释》 安徽科学技术出版社 1992 ISBN 7-5337-0788-5/O
  - 李继闵：《大衍求一术溯源》，吴文俊 主编 ：《秦九韶与数书九章》 138-158页 北京师范大学出版社 1987
  - 袁向东、李文林：《数书九章中的大衍类问题和大衍总数术》 ，吴文俊 主编 ：《秦九韶与数书九章》 159-179 北京师范大学出版社 1987

## 参见

  - [中国剩余定理](../Page/中国剩余定理.md "wikilink")
  - [秦九韶](../Page/秦九韶.md "wikilink")

{{-}}

[Category:宋朝数学](https://zh.wikipedia.org/wiki/Category:宋朝数学 "wikilink")

1.  李俨 118-120页
2.  李俨 《大衍求一术的过去和未来》
3.  钱宝琮 《秦九韶数书九章研究》 621页
4.  李继闵 145-155
5.  王守义 10-38
6.  李俨 123-133
7.  袁向东，李文林 159-179
8.  李俨 128-130页
9.  李倍始 p341
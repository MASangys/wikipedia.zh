**儲存程序**（），又稱為**-{zh-cn:存储过程;
zh-tw:預存程序;}-**，是一種在資料庫中儲存複雜程序，以便外部程式呼叫的一種[資料庫物件](../Page/資料庫物件.md "wikilink")，它可以視為資料庫中的一種函數或子程序。

## 優缺點

### 優點

預存程序具有下列的好處：

  - 預存程序可封裝，並隱藏複雜的商業邏輯。
  - 預存程序可以回傳值，並可以接受參數。
  - 預存程序無法使用 SELECT
    指令來執行，因為它是子程序，與[檢視表](../Page/視圖.md "wikilink")，[資料表或](../Page/資料庫表.md "wikilink")[使用者定義函數不同](../Page/使用者定義函數.md "wikilink")。
  - 預存程序可以用在資料檢驗，強制實行商業邏輯等。

### 缺點

  - 預存程序，往往客製化於特定的資料庫上，因為支援的程式語言不同。當切換到其他廠商的資料庫系統時，需要重寫原有的預存程序。
  - 預存程序的效能調校與撰寫，受限於各種資料庫系統。

## 支援預存程序的資料庫

| 資料庫系統                                                              | 預存程序使用的程式語言                                                                                                                     |
| ------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------- |
| [CUBRID](../Page/CUBRID.md "wikilink")                             | [Java](../Page/Java.md "wikilink")                                                                                              |
| [DB2](../Page/IBM_DB2.md "wikilink")                               | [SQL PL](../Page/SQL_PL.md "wikilink") or [Java](../Page/Java.md "wikilink")                                                    |
| [Firebird](../Page/Firebird_\(database_server\).md "wikilink")     | PSQL (Fyracle also supports portions of Oracle's PL/SQL)                                                                        |
| [Informix](../Page/Informix.md "wikilink")                         | SPL                                                                                                                             |
| [Microsoft SQL Server](../Page/Microsoft_SQL_Server.md "wikilink") | [Transact-SQL](../Page/Transact-SQL.md "wikilink") and various [.NET Framework](../Page/.NET_Framework.md "wikilink") languages |
| [MySQL](../Page/MySQL.md "wikilink")                               | own stored procedures, closely adhering to [SQL:2003](../Page/SQL:2003.md "wikilink") standard.                                 |
| [Oracle](../Page/Oracle_database.md "wikilink")                    | [PL/SQL](../Page/PL-SQL.md "wikilink") or [Java](../Page/Java.md "wikilink")                                                    |
| [PostgreSQL](../Page/PostgreSQL.md "wikilink")                     | [PL/pgSQL](../Page/PL/pgSQL.md "wikilink"), can also use own function languages such as pl/perl or pl/php                       |
| [SAP](../Page/HANA.md "wikilink")                                  | [SQLScript](../Page/SQLScript.md "wikilink"), or [R](../Page/R.md "wikilink")                                                   |
| [Sybase ASE](../Page/Adaptive_Server_Enterprise.md "wikilink")     | [Transact-SQL](../Page/Transact-SQL.md "wikilink")                                                                              |

## 範例

預存程序是資料庫物件之一，必須使用[資料定義語言來建立](../Page/資料定義語言.md "wikilink")，例如：

  - 以下範例，以Microsoft的[SQL
    Server所以採用的T](../Page/SQL_Server.md "wikilink")-SQL語法表示。

<!-- end list -->

``` sql
CREATE PROCEDURE usp_AddProduct
(
   @Barcode varchar(13),
   @Caption nvarchar(50)
)
AS
BEGIN

   IF LEN(@Barcode) < 13
      RAISERROR('Barcode length is too short.')

   INSERT INTO MyProducts (Barcode, Caption) VALUES (@Barcode, @Caption)

END
```

外部程序需要使用 EXECUTE 或 CALL 來呼叫預存程序。

``` sql
EXEC usp_AddProduct '2293891100011', 'MyProductCaption'
```

[Category:数据库管理系统](https://zh.wikipedia.org/wiki/Category:数据库管理系统 "wikilink")
[Category:计算机编程](https://zh.wikipedia.org/wiki/Category:计算机编程 "wikilink")
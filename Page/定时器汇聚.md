**定时器汇聚**是计算机系统的技术，通过降低[软件定时器的精度以允许进程唤醒同步来节约CPU被迫执行的昂贵的进入与退出](https://zh.wikipedia.org/wiki/定時器#軟體定時器 "wikilink")的次数，从而降低CPU能耗。\[1\]

  - [Linux内核](../Page/Linux内核.md "wikilink")通过从版本2.6.22开始支持可延迟定时器（deferrable timer）\[2\]\[3\]，从版本2.6.28支持可控的定时器松弛（timer slack）。\[4\]\[5\]
  - [Windows 7开始支持定时器汇聚](https://zh.wikipedia.org/wiki/Windows_7 "wikilink")。\[6\]
  - [Apple的基于](https://zh.wikipedia.org/wiki/Apple_Inc. "wikilink")[XNU](../Page/XNU.md "wikilink")内核的[OS X](https://zh.wikipedia.org/wiki/OS_X "wikilink")，称作[OS X Mavericks](../Page/OS_X_Mavericks.md "wikilink")，支持此功能。\[7\]\[8\]

## Windows的定时器汇聚

如果处理器的空闲周期非常短暂，处理器进入与退出低功率状态的能耗甚至会大于空闲状态所节约的能耗。**定时器汇聚**帮助改进了周期软件行为的能耗效率，这是通过把多个不同的软件定时器在同一时间到期，从而增加了处理器平均空闲周期的长度。

Microsoft建议软件开发者首先检查能否去除周期性行为，可用事件驱动或者基于中断的设计来代替。否则，应当使用定时器汇聚，至少使用32毫秒的定时器到期容限。\[9\]这对应于两个缺省系统时钟间隔（15.6毫秒）。建议软件定时器间隔与容限都应是50毫秒的倍数。

设备驱动程序应该使用新的内核态API函数`KeSetCoalescableTimer`替代`KeSetTimerEx`。它的参数`TolerableDelay`指出定时器到期容限的毫秒数。

用户态程序从[Windows Vista开始支持](../Page/Windows_Vista.md "wikilink")`SetThreadpoolTimer`。从[Windows 7开始使用Windows](https://zh.wikipedia.org/wiki/Windows_7 "wikilink") API函数`SetWaitableTimerEx`替代`SetWaitableTimer`。从[Windows 8开始](https://zh.wikipedia.org/wiki/Windows_8 "wikilink")，使用Windows API函数`SetCoalescableTimer`。

## Linux的低分辨率定时器

## 参见

  - [高级配置与电源接口](../Page/高级配置与电源接口.md "wikilink") (ACPI)

  - (APIC)

  - [高精度事件计时器](../Page/高精度事件计时器.md "wikilink") (HPET)

  -
  -
  -
  - [低功耗设计](../Page/低功耗设计.md "wikilink")

  - [效能功耗比](../Page/效能功耗比.md "wikilink")

  -
  - [實時時鐘](../Page/實時時鐘.md "wikilink") (RTC)

  - [系统时间](../Page/系统时间.md "wikilink")

  - (TSC)

  - [无嘀嗒内核](../Page/无嘀嗒内核.md "wikilink")

## 参考文献

[Category:作業系統核心](https://zh.wikipedia.org/wiki/Category:作業系統核心 "wikilink") [Category:同步](https://zh.wikipedia.org/wiki/Category:同步 "wikilink")

1.
2.
3.
4.
5.
6.

7.
8.
9.  [Windows Timer Coalescing,January 20, 2009](http://download.microsoft.com/download/9/C/5/9C5B2167-8017-4BAE-9FDE-D599BAC8184A/TimerCoal.docx)
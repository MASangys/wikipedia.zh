**差分密码分析**是一种[密码分析](../Page/密码分析.md "wikilink")的方法，主要用于破解[分组加密](https://zh.wikipedia.org/wiki/分组加密 "wikilink")，但也适用于[流加密和](https://zh.wikipedia.org/wiki/流加密 "wikilink")[加密哈希函数](https://zh.wikipedia.org/wiki/加密哈希函数 "wikilink")。广义上讲，其研究的是信息输入上的差别对输出结果变化的影响。对于分组密码，其指的是利用差异来获取密钥的技术，包括跟踪变换网络中的差异，以及寻找加密中的非[随机行为等](https://zh.wikipedia.org/wiki/随机 "wikilink")。

## 历史

1980年代后期，和[阿迪·萨莫尔](../Page/阿迪·萨莫尔.md "wikilink")发表了一系列针对多个块加密和哈希函数的攻击，包括对[資料加密標準](../Page/資料加密標準.md "wikilink")（DES）理论弱点的运用。因此，二者通常被认为是发现差分密码分析的元勋。比哈姆和萨莫尔表示，DES在抗差分密码分析方面表现意外的好，不过只要对加密算法稍加修改就能大幅减弱其抗攻击能力。\[1\]

1994年，IBM DES初始团队的成员发表论文称，IBM早在1974年就发现了差分密码分析法，并早已将抗差分分析纳入算法的设计目标中。\[2\]作家表示，IBM的确独立发现了差分密码分析方法，显然NSA也知道这项技术。\[3\]对于IBM选择保密的原因，库帕史密斯解释道：“IBM与NSA商讨后，认为若公布加密算法中抗差分密码分析的设计，那么差分密码分析这种能攻击多种加密算法的强力技术就会被暴露，这将削弱美国在密码学领域的领先优势。\[4\]IBM内部把差分分析称为“T-attack”\[5\]或“Tickle attack”。\[6\]

与内建抗差分密码分析的DES相比，同期其它加密算法在这方面被证实是脆弱的。是本分析方法的早期攻击目标。原始的4轮版本（FEAL-4）可以在仅利用八个[选择明文的情况下被破解](https://zh.wikipedia.org/wiki/选择明文攻击 "wikilink")，且31轮版本的FEAL的抗攻击性也不尽人意。相比之下，差分分析在使用2<sup>47</sup>数量级的选择明文后才能破解DES算法。

## 攻击原理

差分密码分析通常是[选择明文攻击](https://zh.wikipedia.org/wiki/选择明文攻击 "wikilink")，意思是攻击者可以自行选取一部分明文并取得相应密文。不过，一些扩展也能让此方法用在[已知明文攻击](https://zh.wikipedia.org/wiki/已知明文攻击 "wikilink")，甚至是[唯密文攻击上](https://zh.wikipedia.org/wiki/唯密文攻击 "wikilink")。差分分析的基本方法，是运用若干对有着常量差异的明文；差异可以用数种方法定义，最常见的是[逻辑异或](../Page/逻辑异或.md "wikilink")（XOR）。然后，攻击者计算相应密文的差异，尝试找出差异分布的统计特征。明文差异和密文差异所组成的差异对被称为**差分**，其统计性质由加密所使用的[S盒](../Page/S盒.md "wikilink")决定。也就是说，对于S盒子*S*，攻击者分析差分(Δ<sub>*X*</sub>, Δ<sub>*Y*</sub>)，其中Δ<sub>*Y*</sub> = *S*(*X* ⊕ Δ<sub>*X*</sub>) ⊕ *S*(*X*)（⊕表示异或）。在初等攻击中，攻击者希望某个密文差异出现的频率非常高，这样就能将[加密](../Page/加密.md "wikilink")和[随机过程区分开来](https://zh.wikipedia.org/wiki/随机 "wikilink")。更复杂的变体攻击能做到比[穷举更快地破解出密钥](../Page/蛮力攻击.md "wikilink")。

最基本的差分密码分析密钥破解形式中，攻击者首先取得大量明文对的密文，并假设差分在至少*r* − 1轮后有效，*r*即加密算法的总轮数。攻击者在倒数第二轮与最后一轮之间差异固定的假设下，去推测可能的轮密钥。如果轮密钥比较短，那么只需举可能的轮密钥，直到最后一轮运算结果和差异的*密文对*一致即可。当一个轮密钥看起来明显比其他密钥常出现时，其会被假设是正确的轮密钥。

针对特定的加密算法，输入差异要经过精心挑选才能使攻击成功。这需要研究算法的内部过程；标准的方法是在加密的不同阶段，跟踪一个高频差异经过的路径，术语上将这点称为*差分特征*。

自从差分密码分析进入公众视野，其就成了加密设计者的基本考量。新的加密设计通常需要举证其算法可以抗此类攻击。包括[AES在内的许多算法都被证明在差分分析攻击下是安全的](https://zh.wikipedia.org/wiki/AES "wikilink")。

## 攻击细则

攻击主要依赖于一点：给定输入/输出，差异特征仅在特定输入下出现。这种方法通常用于线性结构组成的加密方式，如差表结构或*S盒*。给定两个已知密问或明文后，观察其输出差异可猜测密钥的可能值。

举个例子，假设有一个差分：输入的最低位的变化时，引起输出最低的变化，记作*1 =\> 1*。

## 变体

  -
  -
  -
  -
## 另见

  - [密码学](../Page/密码学.md "wikilink")

  -
  -
## 参考

## 外部链接

  - [A tutorial on differential (and linear) cryptanalysis](http://www.engr.mun.ca/~howard/Research/Papers/ldc_tutorial.html)

  - [Helger Lipmaa's links on differential cryptanalysis](https://web.archive.org/web/20090129170430/http://research.cyber.ee/~lipmaa/crypto/link/block/dc.php)

  -
[Category:密码分析](https://zh.wikipedia.org/wiki/Category:密码分析 "wikilink")

1.  Biham and Shamir, 1993, pp. 8-9

2.   (subscription required)

3.

4.
5.
6.  Matt Blaze, , 15 August 1996, [Re: Reverse engineering and the Clipper chip"](https://groups.google.com/group/sci.crypt/msg/5cd14a329372cc5a?dmode=source)
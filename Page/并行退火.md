**并行退火**（Parallel tempering），也称作**replica exchange MCMC sampling**，是一种用于动态改进[蒙特卡罗方法的模拟算法](https://zh.wikipedia.org/wiki/蒙特卡罗方法 "wikilink")。该算法用于模拟物理过程。同时更普遍地应用于[蒙特卡罗马可夫链](https://zh.wikipedia.org/wiki/马尔科夫蒙特卡洛 "wikilink")（Markov chain Monte Carlo，MCMC）抽样方法。\[1\] Sugita和Okamoto数学定义了一种[分子动力学](../Page/分子动力学.md "wikilink")描述的并行退火算法：\[2\]通常被称为replica-exchange molecular dynamics（REMD）。

## 原理

一般的[蒙特卡洛模拟使用Metropolis抽样](../Page/蒙地卡羅方法.md "wikilink")，即接受概率\(P(acc) = min(1, e^{- \frac{\Delta U}{ k_B T}})\)，相同高度的势垒，温度越低越难以逾越，使得模拟需要相当长的模拟步长才能达到平衡，统计抽样满足[各态历经](https://zh.wikipedia.org/wiki/遍历性 "wikilink")。为了提高性能，采取如下策略：同时模拟一系列仅有温度不同的系统，在某些时刻随机选取相邻两个温度的系统，按如下接受概率置换两系统的温度：

\[p(acc) = \min \left( 1, \frac{ \exp \left( -\frac{E_j}{k_B T_i} - \frac{E_i}{k_B T_j} \right) }{ \exp \left( -\frac{E_i}{kT_i} - \frac{E_j}{kT_j} \right) } \right) = \min \left( 1, e^{(E_i - E_j) \left( \frac{1}{kT_i} - \frac{1}{kT_j} \right)} \right) ,\] 其中，E<sub>i</sub>和E<sub>j</sub>是两个系统的总能量，T<sub>i</sub>，T<sub>j</sub>是温度，k<sub>B</sub>是玻尔兹曼因子。温度置换的过程是非物理的，但只要在一步中选择普通Metropolis抽样和温度置换分别以一定概率择其一，此过程仍然遵守。\[3\]

## 推广

并行退火可以用于温度以外的变量以改进抽样。例如，[巨正则系综](../Page/巨正则系综.md "wikilink")下蒙特卡罗模拟[兰纳-琼斯势](../Page/兰纳-琼斯势.md "wikilink")粒子的气液相平衡时，如果系统条件远离临界温度，密度的涨落很小，模拟中难以观测相变。而同时模拟多个化学势的系统，并按相似的接受法则置换系统的化学势：

\[p(acc) = \min \left( 1, \exp \left[ (\beta_j \mu^{ex}_j - \beta_i \mu^{ex}_i)(N_i - N_j) - (\beta_j - \beta_i)(U_i - U_j) \right]  \right) ,\] 其中i,j是两个超额化学势（相对理想气体）分别为\(\mu_i, \mu_j\)的系统，它们的粒子个数分别为\(N_i, N_j\)，内能分别为\(U_i, U_j\). 此模拟得到的密度概率函数能准确地反映气相和液相两个峰。\[4\]

## 神经网络

并行退火在训练神经网络时也有相似的应用。将一个系统运行在**N**个不同温度的条件下，并根据[Metropolis法则](https://en.wikipedia.org/wiki/Metropolis%E2%80%93Hastings_algorithm)交换不同温度下的状态，因而可以用高温环境的参数去模拟低温环境，反之亦然。并行退火算法可用于[人工神经网络](../Page/人工神经网络.md "wikilink")训练，改进MCMC，虽然增加了计算复杂度，但提供了更快的马尔科夫链混合（mixing，指收敛）速度和更高的准确性。神经元之间的参数交换被描述为不同温度下分子状态的交换，随机交换的概率由Metropolis法则给出。尤其用于[约束波茨曼机训练](https://zh.wikipedia.org/wiki/约束波茨曼机 "wikilink")。\[5\]

## 参考

[Category:蒙地卡羅方法](https://zh.wikipedia.org/wiki/Category:蒙地卡羅方法 "wikilink") [Category:計算統計學](https://zh.wikipedia.org/wiki/Category:計算統計學 "wikilink") [Category:贝叶斯统计](https://zh.wikipedia.org/wiki/Category:贝叶斯统计 "wikilink") [Category:启发法](https://zh.wikipedia.org/wiki/Category:启发法 "wikilink")

1.  David J. Earl and Michael W. Deem (2005) ["Parallel tempering: Theory, applications, and new perspectives"](http://www.rsc.org/Publishing/Journals/CP/article.asp?doi=b509983h), *Phys. Chem. Chem. Phys.*, 7, 3910
2.
3.
4.
5.  [Parallel Tempering for Training of Restricted Boltzmann Machine.](http://jmlr.csail.mit.edu/proceedings/papers/v9/desjardins10a/desjardins10a.pdf) R.Salakhutdinov, 2009.
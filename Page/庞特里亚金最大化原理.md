**庞特里亚金最大化原理**（Pontryagin's maximum principle）也根据使用条件稱為**庞特里亚金最小化原理**或**最大值原理**及**最小值原理**，是[最优控制中的理論](https://zh.wikipedia.org/wiki/最优控制 "wikilink")，是在狀態或是輸入控制項有限制條件的情形下，可以找到將[动力系统](../Page/动力系统.md "wikilink")由一個狀態到另一個狀態的最優控制信號。此理論是蘇俄數學家[列夫·庞特里亚金](../Page/列夫·庞特里亚金.md "wikilink")及他的學生在1956年提出的\[1\]。這是[变分法](../Page/变分法.md "wikilink")中[歐拉-拉格朗日方程](../Page/歐拉-拉格朗日方程.md "wikilink")的特例。

簡單來說，此定理是指在所有可能的控制中，需讓「控制哈密頓量」（control Hamiltonian）取極值，極值是最大值或是最小值則依問題以及哈密頓量的符號定義而不同。正式的用法，也就是[哈密頓量中所使用的符號](../Page/哈密頓量_\(最佳控制\).md "wikilink")，會取到最大值，但是此條目中使用的符號定義方式，會讓極值取到最小值。

若\(\mathcal{U}\)是所有可能控制值的集合，則此原理指出，最優控制\(u^*\)必須滿足以下條件：

\[H(x^*(t),u^*(t),\lambda^*(t),t) \leq H(x^*(t),u,\lambda^*(t),t), \quad \forall u \in \mathcal{U}, \quad t \in [t_0, t_f]\] 其中\(x^*\in C^1[t_0,t_f]\)是最佳狀態軌跡，而\(\lambda^* \in BV[t_0,t_f]\)是最佳 [協態軌跡](../Page/協態方程.md "wikilink")\[2\]

此結果最早成功的應用在輸入控制有限制條件的最小時間問題中，不過也可以用在狀態有限制條件的問題中。

也可以推導控制哈密頓量的特殊條件。若最終時間\(t_f\)固定，且控制哈密頓量不是時間的顯函數\(\left(\tfrac{\partial H}{\partial t} \equiv 0\right)\)，則：

\[H(x^*(t),u^*(t),\lambda^*(t)) \equiv \mathrm{constant}\,\] 若最終時間沒有限制，則：

\[H(x^*(t),u^*(t),\lambda^*(t)) \equiv 0.\,\]

若在某一軌跡上滿足庞特里亚金最大化原理，此原理是最佳解的[必要条件](https://zh.wikipedia.org/wiki/必要条件 "wikilink")。[哈密顿-雅可比-贝尔曼方程](../Page/哈密顿-雅可比-贝尔曼方程.md "wikilink") 提供了最佳解的[充份必要條件](https://zh.wikipedia.org/wiki/充份必要條件 "wikilink")，但該條件須在整個狀態空間中都要成立。

## 最大化和最小化

此定理一開始的名稱是庞特里亚金最大化原理（Pontryagin's maximum principle），其證明也是以控制哈密頓量最大化為基礎。此原理最早的應用是要最大化火箭的終端速度。不過後來此定理大部份的應用是使性能指標最小化，因此常稱為庞特里亚金最小化原理。庞特里亚金的書解出了要讓性能指標最小化的問題\[3\]

## 符號

以下的內容會使用這些表示方式

\[\Psi_T(x(T))= \frac{\partial \Psi(x)}{\partial T}|_{x=x(T)} \,\]

\[\Psi_x(x(T))=\begin{bmatrix} \frac{\partial
\Psi(x)}{\partial x_1}|_{x=x(T)} & \cdots & \frac{\partial
\Psi(x)}{\partial x_n} |_{x=x(T)}
\end{bmatrix}\]

\[H_x(x^*,u^*,\lambda^*,t)=\begin{bmatrix} \frac{\partial H}{\partial x_1}|_{x=x^*,u=u^*,\lambda=\lambda^*}
& \cdots & \frac{\partial H}{\partial x_n}|_{x=x^*,u=u^*,\lambda=\lambda^*}
\end{bmatrix}\]

\[L_x(x^*,u^*)=\begin{bmatrix} \frac{\partial L}{\partial x_1}|_{x=x^*,u=u^*}
& \cdots & \frac{\partial L}{\partial x_n}|_{x=x^*,u=u^*}
\end{bmatrix}\]

\[f_x(x^*,u^*)=\begin{bmatrix} \frac{\partial f_1}{\partial x_1}|_{x=x^*,u=u^*} & \cdots & \frac{\partial f_1}{\partial x_n}|_{x=x^*,u=u^*} \\
\vdots & \ddots & \vdots \\ \frac{\partial f_n}{\partial x_1}|_{x=x^*,u=u^*} &
\ldots & \frac{\partial f_n}{\partial x_n}|_{x=x^*,u=u^*}
\end{bmatrix}\]

## 最小化問題必要條件的正式敘述

以下是讓泛函最小化的必要條件。令\(x\)為在輸入為\(u\)時，[動態系統的狀態](https://zh.wikipedia.org/wiki/動態系統 "wikilink")，且滿足以下條件

\[\dot{x}=f(x,u), \quad x(0)=x_0, \quad u(t) \in \mathcal{U}, \quad t \in
[0,T]\] 其中

\[\mathcal{U}\]為可行控制的集合

\[T\]為系統的結束時間。

控制\(u \in \mathcal{U}\)需在所有\(t \in [0,T]\)內使目標泛函\(J\)最小化，目標泛函\(J\)隨應用而定，可以寫成

\[J=\Psi(x(T))+\int^T_0 L(x(t),u(t)) \,dt\]

系統動態的限制可以用導入時變[拉格朗日乘数](../Page/拉格朗日乘数.md "wikilink")向量\(\lambda\)的方式和[拉格朗日量](../Page/拉格朗日力学.md "wikilink")\(L\)相加，而拉格朗日乘数向量\(\lambda\)的元素稱為系統的協態（costate）。因此可以建構在所有 \(t \in [0,T]\)的[哈密頓量為](../Page/哈密頓量_\(最佳控制\).md "wikilink")：

\[H(x(t),u(t),\lambda(t),t)=\lambda^{\rm T}(t)f(x(t),u(t))+L(x(t),u(t)) \,\] 其中\(\lambda^{\rm T}\)是\(\lambda\)的轉置。

庞特里亚金最小化原理提到最佳狀態軌跡\(x^*\)，最佳控制\(u^*\)及對應的拉格朗日乘数向量\(\lambda^*\)必需最小化哈密頓量\(H\)，因此

\[(1) \qquad H(x^*(t),u^*(t),\lambda^*(t),t)\leq H(x^*(t),u,\lambda^*(t),t) \,\]

針對所有\(t \in [0,T]\)時間，也針對所有可能的控制輸入\(u \in \mathcal{U}\)。以下的式子也必須成立

\[(2) \qquad \Psi_T(x(T))+H(T)=0 \,\]

而且也要滿足以下的[協態方程](../Page/協態方程.md "wikilink")

\[(3) \qquad -\dot{\lambda}^{\rm T}(t)=H_x(x^*(t),u^*(t),\lambda(t),t)=\lambda^{\rm T}(t)f_x(x^*(t),u^*(t))+L_x(x^*(t),u^*(t))\]

若最終狀態\(x(T)\)沒有固定（其微分變異不為0），最終協態也要滿足以下條件

\[(4) \qquad \lambda^{\rm T}(T)=\Psi_x(x(T)) \,\]

上述(1)-(4)的條件是最佳控制的必要條件。公式(4)只有在\(x(T)\)沒有固定時才需要成立。若\(x(T)\)是固定值，公式(4)不在必要條件中。

此解法可以應用在宇宙學和天體物理學中 \[4\]。

## 相關條目

  - ，變分法下中的拉格朗日法

## 腳註

## 參考資料

  -
  -
  -
  -
  - Slides are available at [1](http://www.utdallas.edu/~sethi/OPRE7320presentation.html)

  -
  -
  -
## 外部連結

  -
[fr:Commande optimale\#Principe du maximum](https://zh.wikipedia.org/wiki/fr:Commande_optimale#Principe_du_maximum "wikilink") [ru:Оптимальное управление\#Принцип максимума Понтрягина](https://zh.wikipedia.org/wiki/ru:Оптимальное_управление#Принцип_максимума_Понтрягина "wikilink")

[Category:數學最佳化](https://zh.wikipedia.org/wiki/Category:數學最佳化 "wikilink") [Category:最佳控制](https://zh.wikipedia.org/wiki/Category:最佳控制 "wikilink") [Category:原則](https://zh.wikipedia.org/wiki/Category:原則 "wikilink") [Category:变分法](https://zh.wikipedia.org/wiki/Category:变分法 "wikilink")

1.  參考資料中有最早發表的論文
2.  在[C<sup>1</sup>及](../Page/光滑函数.md "wikilink")[BV空間條目中有更多的資訊](../Page/有界变差.md "wikilink")
3.  參照 Pontryagin 1962年的書，第13頁
4.
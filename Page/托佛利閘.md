**托佛利閘**（[英文](https://zh.wikipedia.org/wiki/英文 "wikilink")：Toffoli gate），又被称作**控-控-非门**（[英文](https://zh.wikipedia.org/wiki/英文 "wikilink")：**controlled-controlled-not gate**，[縮寫](../Page/縮寫.md "wikilink")：**CCNOT**）是[计算机科学](../Page/计算机科学.md "wikilink")中，由托瑪索·托佛利（Tommaso Toffoli）提出的通用[可逆](https://zh.wikipedia.org/wiki/可逆計算 "wikilink")[邏輯閘](../Page/邏輯閘.md "wikilink")，其中任意可逆电路可由托佛利门构造得到。它具有三路输入和三路输出。如果前两位置一，它将倒置第三位，否则所有位保持不变。

## 背景

托佛利门的提出是从研究可逆计算发展而来的。自1960年代人们开始研究可逆逻辑门，初衷是减少计算过程的能量耗散，因为原则上可逆逻辑门在计算过程中不产生热量。对于一般逻辑门，输入状态在运算后会丢失，这导致输出的信息少于输入信息。根据[熵原理](https://zh.wikipedia.org/wiki/熵_\(資訊理論\) "wikilink")，信息的损失以热的形式耗散到环境中。而可逆逻辑门只将信息状态从输入搬移到输出，不会损失信息。

## 托佛利门

由[鸽巢原理可知](https://zh.wikipedia.org/wiki/鸽巢原理 "wikilink")，任何可逆逻辑门，需要具有相同数量的输入端与输出端。对于一个输入端，存在有两个可能的可逆逻辑门。一为[非门](https://zh.wikipedia.org/wiki/非门 "wikilink")（NOT），另一种为 YES 门，即输入与输出相同。对于两个输入端，存在的可逆逻辑门为[控非门](https://zh.wikipedia.org/wiki/控非门 "wikilink")，它把第一个输入对第二个输入进行异或操作，并保持第一个输入不变。

<table>
<thead>
<tr class="header">
<th><p>真值表</p></th>
<th><p>置换阵</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><table>
<thead>
<tr class="header">
<th><p>输入</p></th>
<th><p>输出</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p> 0 </p></td>
<td><p> 0 </p></td>
</tr>
<tr class="even">
<td><p>0</p></td>
<td><p>1</p></td>
</tr>
<tr class="odd">
<td><p>1</p></td>
<td><p>0</p></td>
</tr>
<tr class="even">
<td><p>1</p></td>
<td><p>1</p></td>
</tr>
</tbody>
</table></td>
<td><p><span class="math inline">$\begin{bmatrix}
 1 &amp; 0 &amp; 0 &amp; 0 \\
 0 &amp; 1 &amp; 0 &amp; 0 \\
 0 &amp; 0 &amp; 0 &amp; 1 \\
 0 &amp; 0 &amp; 1 &amp; 0 \\
\end{bmatrix}$</span></p></td>
</tr>
</tbody>
</table>

但是，只使用这两种逻辑门（非门和异或）并不能实现所有的布尔函数。如果要使用可逆逻辑门实现任意布尔函数，还需要额外的逻辑门。托瑪索·托佛利于1980年提出了 **托佛利门**。\[1\]

该逻辑门具有三个输入端和三个输出端。如果前两个比特置位，它将翻转第三个比特：

<table>
<thead>
<tr class="header">
<th><p>真值表</p></th>
<th><p>置换阵</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><table>
<thead>
<tr class="header">
<th><p>INPUT</p></th>
<th><p>OUTPUT</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p> 0 </p></td>
<td><p> 0 </p></td>
</tr>
<tr class="even">
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="odd">
<td><p>0</p></td>
<td><p>1</p></td>
</tr>
<tr class="even">
<td><p>0</p></td>
<td><p>1</p></td>
</tr>
<tr class="odd">
<td><p>1</p></td>
<td><p>0</p></td>
</tr>
<tr class="even">
<td><p>1</p></td>
<td><p>0</p></td>
</tr>
<tr class="odd">
<td><p>1</p></td>
<td><p>1</p></td>
</tr>
<tr class="even">
<td><p>1</p></td>
<td><p>1</p></td>
</tr>
</tbody>
</table></td>
<td><p><span class="math inline">$\begin{bmatrix}
1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 \\
\end{bmatrix}$</span></p></td>
</tr>
</tbody>
</table>

即，三路输入\(a\)、 \(b\)、\(c\)映射到输出端的结果为\(a\)、 \(b\)和\(c\oplus (a\cdot b)\)。Toffoli 门具有通用性，这意味着，通过托佛利Toffoli 门可以以可逆计算的方式实现任意布尔函数。

## 相关逻辑门

[Toffoli_BilliardBall.gif](https://zh.wikipedia.org/wiki/File:Toffoli_BilliardBall.gif "fig:Toffoli_BilliardBall.gif")

  - [Fredkin 门](https://zh.wikipedia.org/wiki/Fredkin_门 "wikilink") 是一种可逆三位逻辑门，输入端第一位为控制位，如果为1，输出将交换后两位。

<!-- end list -->

  - *n*位托佛利门是托佛利门的扩展。 它有 *n* 位输入 *x*<sub>1</sub>, *x*<sub>2</sub>, ..., *x*<sub>*n*</sub> 和 *n* 位输出。前 *n*−1 位输出等于 *x*<sub>1</sub>, ..., *x*<sub>*n*−1</sub>。 最后一个输出位为 (*x*<sub>1</sub> AND ... AND *x*<sub>*n*−1</sub>) XOR *x*<sub>*n*</sub>.
  - 可以使用五个两比特量子门构建托佛利门\[2\]

<!-- end list -->

  - 托佛利门可以通过撞球模型得到解释，如图所示。\[3\]

## 參見

  - [可逆計算](https://zh.wikipedia.org/wiki/可逆計算 "wikilink")
  - [量子電腦](https://zh.wikipedia.org/wiki/量子電腦 "wikilink")
  - [量子閘](../Page/量子閘.md "wikilink")

## 参考

[Category:逻辑门](https://zh.wikipedia.org/wiki/Category:逻辑门 "wikilink") [Category:量子閘](https://zh.wikipedia.org/wiki/Category:量子閘 "wikilink")

1.  Technical Report MIT/LCS/TM-151 (1980) and an adapted and condensed version:
2.
3.
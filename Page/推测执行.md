**推测执行**（亦作**预测执行**、**投机性执行**，英语：**Speculative
execution**）是优化技术的一类，采用这个技术的[计算机系统会根据现有信息](https://zh.wikipedia.org/wiki/计算机系统 "wikilink")，利用空转时间提前执行一些将来可能用得上，也可能用不上的指令。如果指令执行完成后发现用不上，系统会抛弃计算结果，并回退执行期间造成的副作用（如缓存）。

推测执行的目标是在处理器[系统资源过剩的情况下](https://zh.wikipedia.org/wiki/資源_\(計算機科學\) "wikilink")[并行处理其他任务](../Page/并发性.md "wikilink")。推测执行无处不在。流水处理器的[分支预测](../Page/分支預測器.md "wikilink")、数值预测、\[1\]
预读取内存和[文件](../Page/文件系统.md "wikilink")、以及[数据库系统的](https://zh.wikipedia.org/wiki/關聯式資料庫管理系統 "wikilink")[乐观并发控制等机能中都采用到了推测执行](../Page/乐观并发控制.md "wikilink")。\[2\]\[3\]

## 举例

假设某程序的结构如下：

  - 从网络上下载一个数据A，耗时30秒。
  - 如果下载A成功，则直接给出A的答案。
  - 如果下载A失败，则计算30秒的算数B，并给出这个答案。

如果没有推测执行功能，那么当A下载后发现失败，那么就要再花30秒做算术B，总共耗时1分钟。但是，由于下载过程中CPU是空转，CPU可以认识到反正闲着也是闲着，不如暫時把A當作失败，並根據此提前算出B。这样如果将来需要到B，就节省了30秒的时间。就算不需要，也没有浪费处理器时间。

## 参见

  - [分支预测器](https://zh.wikipedia.org/wiki/分支预测器 "wikilink")

## 参考文献

[Category:指令处理](https://zh.wikipedia.org/wiki/Category:指令处理 "wikilink")

1.  "[A Survey of Value Prediction Techniques for Leveraging Value
    Locality](https://www.academia.edu/33619227/A_Survey_of_Value_Prediction_Techniques_for_Leveraging_Value_Locality)",
    S. Mittal, Concurrency and Computation, 2017
2.  [Lazy and Speculative
    Execution](http://research.microsoft.com/en-us/um/people/blampson/slides/LazyAndSpeculative.pdf)
    \[//en.wikipedia.org/wiki/Butler_Lampson Butler Lampson\]
    \[//en.wikipedia.org/wiki/Microsoft_Research Microsoft Research\]
    OPODIS, Bordeaux, France 12 December 2006
3.
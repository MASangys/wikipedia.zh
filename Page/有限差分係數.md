下表列出使用[有限差分法进行数值微分时](../Page/有限差分法.md "wikilink")，各项的系数。按计算中自变量取值方向，分为**中心差分**，**前向差分**和**后向差分**。

## 中心差分

中心差分估算一阶至高阶微分按照下式：

\[f^{(n)}(x) = \frac{1}{h_x^n}\sum_{i=-m}^{m} k_{i} f(x+ih) + O(h_x^p)\]
其中\(h_x\)为自变量取等距格点计算函数值时的间隔。

下表列出不同计算精度下，等间距的一阶至高阶中心差分系数。\[1\]

| 阶次 | 精度     | −4     | −3       | −2      | −1      | 0       | 1       | 2     | 3      | 4 |
| -- | ------ | ------ | -------- | ------- | ------- | ------- | ------- | ----- | ------ | - |
| 1  | 2      |        |          |         | −1/2    | 0       | 1/2     |       |        |   |
| 4  |        |        | 1/12     | −2/3    | 0       | 2/3     | −1/12   |       |        |   |
| 6  |        | −1/60  | 3/20     | −3/4    | 0       | 3/4     | −3/20   | 1/60  |        |   |
| 8  | 1/280  | −4/105 | 1/5      | −4/5    | 0       | 4/5     | −1/5    | 4/105 | −1/280 |   |
| 2  | 2      |        |          |         | 1       | −2      | 1       |       |        |   |
| 4  |        |        | −1/12    | 4/3     | −5/2    | 4/3     | −1/12   |       |        |   |
| 6  |        | 1/90   | −3/20    | 3/2     | −49/18  | 3/2     | −3/20   | 1/90  |        |   |
| 8  | −1/560 | 8/315  | −1/5     | 8/5     | −205/72 | 8/5     | −1/5    | 8/315 | −1/560 |   |
| 3  | 2      |        |          | −1/2    | 1       | 0       | −1      | 1/2   |        |   |
| 4  |        | 1/8    | −1       | 13/8    | 0       | −13/8   | 1       | −1/8  |        |   |
| 6  | −7/240 | 3/10   | −169/120 | 61/30   | 0       | −61/30  | 169/120 | −3/10 | 7/240  |   |
| 4  | 2      |        |          | 1       | −4      | 6       | −4      | 1     |        |   |
| 4  |        | −1/6   | 2        | −13/2   | 28/3    | −13/2   | 2       | −1/6  |        |   |
| 6  | 7/240  | −2/5   | 169/60   | −122/15 | 91/8    | −122/15 | 169/60  | −2/5  | 7/240  |   |
| 5  | 2      |        | −1/2     | 2       | −5/2    | 0       | 5/2     | −2    | 1/2    |   |
| 6  | 2      |        | 1        | −6      | 15      | −20     | 15      | −6    | 1      |   |

例如，\(h_x^2\)精度的三阶导的中心差分式为

  -
    \(\displaystyle f'''(x_{0}) \approx \displaystyle \frac{-\frac{1}{2}f(x_{-2}) + f(x_{-1}) -f(x_{+1}) +\frac{1}{2}f(x_{+2})}{h^3_x} + O\left(h_x^2  \right)\)

## 前向与后向差分

下表列出不同精度下，等间距的一阶至高阶前向差分系数。\[2\]

| 阶次 | 精度       | 0        | 1          | 2       | 3        | 4        | 5         | 6       | 7        | 8 |
| -- | -------- | -------- | ---------- | ------- | -------- | -------- | --------- | ------- | -------- | - |
| 1  | 1        | −1       | 1          |         |          |          |           |         |          |   |
| 2  | −3/2     | 2        | −1/2       |         |          |          |           |         |          |   |
| 3  | −11/6    | 3        | −3/2       | 1/3     |          |          |           |         |          |   |
| 4  | −25/12   | 4        | −3         | 4/3     | −1/4     |          |           |         |          |   |
| 5  | −137/60  | 5        | −5         | 10/3    | −5/4     | 1/5      |           |         |          |   |
| 6  | −49/20   | 6        | −15/2      | 20/3    | −15/4    | 6/5      | −1/6      |         |          |   |
| 2  | 1        | 1        | −2         | 1       |          |          |           |         |          |   |
| 2  | 2        | −5       | 4          | −1      |          |          |           |         |          |   |
| 3  | 35/12    | −26/3    | 19/2       | −14/3   | 11/12    |          |           |         |          |   |
| 4  | 15/4     | −77/6    | 107/6      | −13     | 61/12    | −5/6     |           |         |          |   |
| 5  | 203/45   | −87/5    | 117/4      | −254/9  | 33/2     | −27/5    | 137/180   |         |          |   |
| 6  | 469/90   | −223/10  | 879/20     | −949/18 | 41       | −201/10  | 1019/180  | −7/10   |          |   |
| 3  | 1        | −1       | 3          | −3      | 1        |          |           |         |          |   |
| 2  | −5/2     | 9        | −12        | 7       | −3/2     |          |           |         |          |   |
| 3  | −17/4    | 71/4     | −59/2      | 49/2    | −41/4    | 7/4      |           |         |          |   |
| 4  | −49/8    | 29       | −461/8     | 62      | −307/8   | 13       | −15/8     |         |          |   |
| 5  | −967/120 | 638/15   | −3929/40   | 389/3   | −2545/24 | 268/5    | −1849/120 | 29/15   |          |   |
| 6  | −801/80  | 349/6    | −18353/120 | 2391/10 | −1457/6  | 4891/30  | −561/8    | 527/30  | −469/240 |   |
| 4  | 1        | 1        | −4         | 6       | −4       | 1        |           |         |          |   |
| 2  | 3        | −14      | 26         | −24     | 11       | −2       |           |         |          |   |
| 3  | 35/6     | −31      | 137/2      | −242/3  | 107/2    | −19      | 17/6      |         |          |   |
| 4  | 28/3     | −111/2   | 142        | −1219/6 | 176      | −185/2   | 82/3      | −7/2    |          |   |
| 5  | 1069/80  | −1316/15 | 15289/60   | −2144/5 | 10993/24 | −4772/15 | 2803/20   | −536/15 | 967/240  |   |

例如，\(h_x^3\)精度一阶导的前向差分式为 For example, the first derivative with a
third-order accuracy and the second derivative with a second-order
accuracy are

  -
    \(\displaystyle f'(x_{0}) \approx \displaystyle \frac{-\frac{11}{6}f(x_{0}) + 3f(x_{+1}) -\frac{3}{2}f(x_{+2}) +\frac{1}{3}f(x_{+3}) }{h_{x}} + O\left(h_{x}^3  \right),\)

\(h_x^2\)精度二阶导的前向差分式为

  -
    \(\displaystyle f''(x_{0}) \approx \displaystyle \frac{2f(x_{0}) - 5f(x_{+1}) + 4f(x_{+2}) - f(x_{+3}) }{h_{x}^2} + O\left(h_{x}^2  \right),\)

对应的后向差分式分别为

  -
    \(\displaystyle f'(x_{0}) \approx \displaystyle \frac{\frac{11}{6}f(x_{0}) - 3f(x_{-1}) +\frac{3}{2}f(x_{-2}) -\frac{1}{3}f(x_{-3}) }{h_{x}} + O\left(h_{x}^3  \right),\)
    \(\displaystyle f''(x_{0}) \approx \displaystyle \frac{2f(x_{0}) - 5f(x_{-1}) + 4f(x_{-2}) - f(x_{-3}) }{h_{x}^2} + O\left(h_{x}^2  \right),\)

实际上，奇数阶后向差分式相对前向差分，各系数q取相反数；而偶数阶的则不变。如下表：

| 阶次 | 精度 | −8 | −7 | −6 | −5  | −4  | −3  | −2  | −1  | 0 |
| -- | -- | -- | -- | -- | --- | --- | --- | --- | --- | - |
| 1  | 1  |    |    |    |     |     |     |     | −1  | 1 |
| 2  |    |    |    |    |     |     | 1/2 | −2  | 3/2 |   |
| 2  | 1  |    |    |    |     |     |     | 1   | −2  | 1 |
| 2  |    |    |    |    |     | −1  | 4   | −5  | 2   |   |
| 3  | 1  |    |    |    |     |     | −1  | 3   | −3  | 1 |
| 2  |    |    |    |    | 3/2 | −7  | 12  | −9  | 5/2 |   |
| 4  | 1  |    |    |    |     | 1   | −4  | 6   | −4  | 1 |
| 2  |    |    |    | −2 | 11  | −24 | 26  | −14 | 3   |   |

## 参见

  - [有限差分法](../Page/有限差分法.md "wikilink")
  - [數值微分](../Page/數值微分.md "wikilink")

## 参考资料

[Category:数值微分方程](https://zh.wikipedia.org/wiki/Category:数值微分方程 "wikilink")

1.  .

2.
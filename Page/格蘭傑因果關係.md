**格蘭傑因果關係檢驗**（）是一種[假設檢定的統計方法](../Page/假設檢定.md "wikilink")，檢驗一組[時間序列](../Page/時間序列.md "wikilink")\(x\)是否為另一組時間序列\(y\)的原因。它的基礎是[迴歸分析當中的](../Page/迴歸分析.md "wikilink")[自迴歸模型](../Page/自迴歸模型.md "wikilink")。迴歸分析通常只能得出*不同*
[變量間的](https://zh.wikipedia.org/wiki/變量 "wikilink")*同期*
[相關性](https://zh.wikipedia.org/wiki/相關性 "wikilink")；自迴歸模型只能得出*同一*
變量*前後期*
的相關性；但[諾貝爾經濟學獎得主](https://zh.wikipedia.org/wiki/諾貝爾經濟學獎 "wikilink")[克萊夫·格蘭傑](https://zh.wikipedia.org/wiki/克萊夫·格蘭傑 "wikilink")（Clive
Granger）於1969年論證\[1\] ，在自迴歸模型中透過一系列的檢定進而揭示不同變量之間的時間落差相關性是可行的。

格蘭傑本人在其2003年獲獎演說中強調了其引用的局限性，以及“很多荒謬論文的出現”（Of course, many ridiculous
papers
appeared）。格蘭傑因果關係檢驗的結論只是一種統計估計，不是真正意義上的因果關係，不能作爲肯定或否定因果關係的根據。同時，格蘭傑因果關係檢驗也有一些不足之處，如並未考慮[干擾因素的影響](https://zh.wikipedia.org/wiki/:en:Confounding_factor "wikilink")，也未考慮時間序列間非線性的相互關係。一些基於格蘭傑因果關係檢驗的方法一定程度上解決了這些問題\[2\]。

## 核心概念

**過去值**（lag
value，或稱滯後值）：同一變項比當期**時間上**更早的值。例如：當期為\(y_{10}\)，它的滯後值為\(y_{i<10}\)。

格蘭傑因果關係檢驗的基本觀念在於：**未來的事件不會對目前與過去產生因果影響，而過去的事件才可能對現在及未來產生影響**。\[3\]\[4\]
也就是說，如果我們試圖探討變數\(x\)是否對變數\(y\)有因果影響，那麼只需要估計\(x\)的滯後值是否會影響\(y\)的現在值，因為\(x\)的未來值不可能影響\(y\)的現在值。**假如在控制了\(y\)變數的過去值以後，\(x\)
變數的過去值仍能對Y 變數有顯著的解釋能力**，我們就可以稱\(x\)能「Granger
影響」（Granger-cause）\(y\)。\[5\]

### 侷限性和改進

最初版的格蘭傑因果測試，有時候無法發現真正的[因果關係](https://zh.wikipedia.org/wiki/因果 "wikilink")。因為雖然對於認定因果關係而言，理論上還必須控制其他可能的[干擾因素](../Page/偽關係.md "wikilink")，但在
Granger
最初提出這套因果測試的版本中，並未納入干擾變數的分析，而是假設其他可能解釋變數的資訊包含在\(y\)的落後值中。如果事實上帶來因果關係的是第三變數（干擾變數），亦即若事實上操控
\(x\) 並無法改變 \(y\)
，格蘭傑因果關係的[零假設仍然可能被拒絕](https://zh.wikipedia.org/wiki/零假設 "wikilink")。因此標準版的格蘭傑因果測試結果可能會產生誤導性。

1980年代由其他的計量經濟學家對Granger測試加以修改、擴充，將可能的第三（以上）變數納入測試，成為使用的[向量自迴歸模型](https://zh.wikipedia.org/wiki/向量自迴歸模型 "wikilink")（）。相較於最初版的
Granger 測試，擴充版可以產生更有效的估計結果。\[6\]

## 步驟描述

1.  準備工作：一開始要用幾個落後期來建立模型，需要研究者的評估，通常使用
    [赤池信息量準則](https://zh.wikipedia.org/wiki/赤池信息量準則 "wikilink")（）
    或 （）來判斷。
2.  格蘭傑因果關係檢驗的第一步是建立用\(y\)的滯後值來預測\(y\)的自迴歸模型。此際，如果時間序列\(y\)是[廣義平穩的](https://zh.wikipedia.org/wiki/平穩過程 "wikilink")，則可以直接使用滯後值。如果不平穩，就必須對不平穩的時間序列先做（一階或更多階）[差分](../Page/差分.md "wikilink")，直到得出平穩時間數列。
3.  如果發現 \(y\) 的某期滯後值 (1) 在迴歸分析中具有顯著性（根據
    [t檢定的](../Page/學生t檢驗.md "wikilink")[p值來判斷](https://zh.wikipedia.org/wiki/p值 "wikilink")），且
    (2)
    這期滯後值加入模型後可提高迴歸模型的解釋力（根據迴歸分析的[F檢定](../Page/迴歸分析.md "wikilink")），這個滯後值便被留在模型中。
4.  然後進一步加入\(x\)（或Δ\(x\)）的滯後期來擴充迴歸模型。關於平穩時間序列的要求、某期滯後值留在模型中的條件，同上述\(y\)的處理。
5.  若且唯若（充分必要）沒有任何解釋變項\(x\)（或Δ\(x\)）的滯後值被留在模型中，便無法拒絕無格蘭傑因果關係的[零假設](https://zh.wikipedia.org/wiki/零假設 "wikilink")。

研究人員希望發現明顯的證據，比如\(x\)是\(y\)的格蘭傑原因但反之不成立，便能做出因果關係的推論。然而在實際操作中也可能會發現沒有變量是對方的格蘭傑原因，或者\(x\)和\(y\)兩個變量互為格蘭傑原因。

### 數學定義

1\.
令\(x\)和\(y\)為[廣義平穩序列](https://zh.wikipedia.org/wiki/平穩過程#廣義平穩（弱平穩） "wikilink")。如要檢測\(x\)非\(y\)的格蘭傑原因之[零假設](https://zh.wikipedia.org/wiki/零假設 "wikilink")，首先引入\(y\)的滯後值建立\(y\)的[自迴歸模型](../Page/自迴歸模型.md "wikilink")（AR
model on \(y\)）：

\[y_t = a_0 + a_1y_{t-1} + a_2y_{t-2} + ... + a_my_{t-m} + residual_t.\]

  -
    所有的\(y\)滯後值中：(1)
    在迴歸分析中具有顯著性（根據[t-統計值的](../Page/學生t檢驗.md "wikilink")[p值來判斷](https://zh.wikipedia.org/wiki/p值 "wikilink")）的，且
    (2)
    這期滯後值加入模型後可提高迴歸模型的解釋力（根據迴歸分析的[F檢定](../Page/迴歸分析.md "wikilink")）的－－將被留在模型中。\(m\)表示的是\(y\)變量滯後期中檢定為顯著的時間上最早一個。

2\. 接著，引入\(x\)的滯後值建立增廣迴歸模型：

\[y_t = a_0 + a_1y_{t-1} + a_2y_{t-2} + ... a_my_{t-m} + b_px_{t-p} + ... + b_qx_{t-q} + residual_t.\]

  -
    所有的\(x\)滯後值中：(1)
    在迴歸分析中具有顯著性（根據[學生t檢驗的](../Page/學生t檢驗.md "wikilink")[p值來判斷](https://zh.wikipedia.org/wiki/p值 "wikilink")）的，且
    (2)
    這期滯後值加入模型後可提高迴歸模型的解釋力（根據迴歸分析的[F檢定](../Page/迴歸分析.md "wikilink")）的－－將被留在模型中。在以上增廣迴歸模型中，\(p\)代表\(x\)變量滯後值中檢定為顯著的時間上最早一個，\(q\)則是\(x\)變量滯後值中檢定為顯著的時間上最近一個。

3\. 如果**沒有任何\(x\)的滯後值**被留在模型中，無格蘭傑因果關係的零假設就成立。

### 軟件運行

一些統計軟體可以執行Granger causality
test。例如：[Stata](https://zh.wikipedia.org/wiki/Stata "wikilink")、[SPSS](../Page/SPSS.md "wikilink")\[7\]、[EViews](https://zh.wikipedia.org/wiki/EViews "wikilink")\[8\]、[R語言](https://zh.wikipedia.org/wiki/R語言 "wikilink")。

這裡舉個R語言中lmtest程序庫裡grangertest()指令的例子：

    Granger causality test

    Model 1: fii ~ Lags(fii, 1:5) + Lags(rM, 1:5)
    Model 2: fii ~ Lags(fii, 1:5)
      Res.Df  Df      F  Pr(>F)
    1    629
    2    634   5 2.5115 0.02896 *
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    Granger causality test

    Model 1: rM ~ Lags(rM, 1:5) + Lags(fii, 1:5)
    Model 2: rM ~ Lags(rM, 1:5)
      Res.Df  Df      F Pr(>F)
    1    629
    2    634   5 1.1804 0.3172

模型1檢驗將滯後的rM從解釋FII的回歸模型中移除是否可行，答案是不可行的（因為p值 =
0.02896）。但由模型1和模型2的組合可發現從解釋rM的模型中移除FII的滯後值是可能的。我們可以由此斷定rM是FII的格蘭傑原因，反之則不成立。

## 延伸

承繼著回歸模型的基本性質，格蘭傑因果關係分析也假設實際值與預測值之間的誤差呈常態分佈，若實際現象不呈常態分佈將嚴重影響推論的有效性。

Hacker & Hatemi-J
(2006)發展出一種不必在乎誤差項是否呈正態分佈的格蘭傑因果關係研究方法\[9\]。這種方法在財金分析上特别實用，
因為許多金融變量不服從常態分佈。\[10\]

近來，Hacker & Hatemi-J
(2012)又進一步改善之，提出一種非對稱的因果關係檢驗模型，據說可以區分正向與負向影響的因果影響。\[11\]

## 註腳

<references/>

## 相關條目

  - [自迴歸模型](../Page/自迴歸模型.md "wikilink")（AR model）
  - [向量自迴歸模型](https://zh.wikipedia.org/wiki/向量自迴歸模型 "wikilink")（VAR
    model）
  - [差分自回歸滑動平均模型](../Page/ARIMA模型.md "wikilink")（ARIMA模型）

[de:Kausalität\#Ökonometrie
(Granger)](https://zh.wikipedia.org/wiki/de:Kausalität#Ökonometrie_\(Granger\) "wikilink")

[Category:时间序列](https://zh.wikipedia.org/wiki/Category:时间序列 "wikilink")
[Category:因果律](https://zh.wikipedia.org/wiki/Category:因果律 "wikilink")

1.

2.

3.
4.

5.

6.
7.

8.

9.  Hacker R.S. and Hatemi-J A. (2006) ["Tests for causality between
    integrated variables using asymptotic and bootstrap distributions:
    theory and
    application"](http://ideas.repec.org/a/taf/applec/v38y2006i13p1489-1500.html),
    Applied Economics, Vol. 38(13), pp. 1489–1500.

10.

11.
**模型預測控制**（Model predictive
control、MPC）是[过程控制中](../Page/过程控制.md "wikilink")，在滿足特定限制條件時，控制過程的進階控制方式，自1980年代起已用在[化學工廠及](../Page/化學工廠.md "wikilink")[煉油廠的工業過程中](../Page/煉油廠.md "wikilink")。近年來也用在[電力系統的平衡模型](../Page/電力系統.md "wikilink")\[1\]以及[电力电子学中](../Page/电力电子学.md "wikilink")\[2\]。模型預測控制是以過程的動態模型為基礎，多半是透過得到的線性模型。模型預測控制的特點是每一次針對目前的時間區塊內作最佳化，然後下一個時間再針對時間區塊內作最佳化，這和[LQR控制器不同](../Page/LQR控制器.md "wikilink")。模型預測控制可以預測未來事件並且進行對應的處理。[PID控制器沒有這樣的預測功能](../Page/PID控制器.md "wikilink")。模型預測控制幾乎都是用數位控制來實現，不過也有研究指出若使用特殊設計的類比電路，其反應時間可以更快\[3\]。

[广义预测控制](https://zh.wikipedia.org/wiki/广义预测控制 "wikilink")（Generalized
predictive
control，簡稱GPC）以及[动态矩阵控制](https://zh.wikipedia.org/wiki/动态矩阵控制 "wikilink")（dynamic
matrix control，簡稱DMC）都是典型模型預測控制的例子\[4\]。

## 簡介

會用到模型預測控制的模型一般都是用來呈現複雜[动力系统的特性](../Page/动力系统.md "wikilink")。若是針對簡單系統的精準控制，多半不需要用到複雜的模型預測控制演算法，可能用泛用的[PID控制器即可處理](../Page/PID控制器.md "wikilink")，若是系統有很長的時間延遲或是高階系統，其控制特性才會複雜到超過PID控制器可控制的程度。

模型預測控制會預測建模的系統在[自变量變化時](https://zh.wikipedia.org/wiki/自变量 "wikilink")，對應的[因变量變化](../Page/自变量和因变量.md "wikilink")。在化學製程中，控制器可以調整的自变量可能是PID控制器的目標值（壓力、流量、溫度等），或是最終控制單元（閥、加濕器等）的輸出。若是不能被控制器調整的自变量，會視為干擾來處理。製程中的因變量一般是對於控制目標的量測，或是一些製程限制條件的量測。

模型預測控制會用目前受控體的量測數值、目前製程的動態狀態、模型預測控制的模型，以及製程變數目標以及限制來計算因变量未來的變化。計算變化的目的是讓因变量儘量接近目標，並且讓因变量及自變量都在限制條件範圍內。模型預測控制一般會針對自變量先送出一個控制需要的變化，重複計算，一直到需要下一個變化時再送出下一個指令。

許多實際的製程不是線性的，不過在小的操作範圍內可以視為是線性的。大部份的應用可以使用線性模型預測控制，模型預測控制的回授機制會補償因為模型及實際製程之間的結構不一定所產生的估測誤差。假如預測控制器中的模型都是線性模型，根據[线性代数中的](../Page/线性代数.md "wikilink")[叠加原理可以讓幾個獨立變數變化的效果加成](../Page/叠加原理.md "wikilink")，並且可以預測到應變量的變加。因此可以將控制問題簡化成一連串直接的矩陣代數計數，速度快，而且有強健性。

假如線性模型已經無法描述實際系統的非線性特性，有許多不同的作法。有些情形下，制程變數可以在模型預測控制器前後進行轉換，以減少其非線性的特性。也可以直接用非線性的模型預測控制來控制，直接用非線性的模型來符合實際的應用。非線性模型可以是由實際資料所合成（例如用人工智慧的類神經網路）），或是以質量平衡及能量平衡為基礎的高保真動態模型。非線性模型可以線性化以得到[卡尔曼滤波](../Page/卡尔曼滤波.md "wikilink")，或是其他可以用在線性模型預測控制的模型。

El-Gherwi、Budman及El
Kamel的演算法研究指出，利用雙模式的方法，可以讓即時計算量顯著下降，而其性能和調整前相當。此演算法會以各控制器之間交換資訊為基礎，平行求解N個凸優化問題\[5\]

### 模型預測控制背後的理論

[MPC_scheme_basic.svg](https://zh.wikipedia.org/wiki/File:MPC_scheme_basic.svg "fig:MPC_scheme_basic.svg")
模型預測控制是以針對受控體模型的迭代式、有限時域滾動（finite-horizon）最佳化為基礎。在時間\(t\)時針對受控體的狀態取樣，並且針對未來一段很短的滾動時域\([t,t+T]\)，計算使費用最小化的控制策略（數值最小化演算化）。特別會使用在線或是on
the
fly的計算來探索由目前狀態演進的狀態軌跡，並且（透過[歐拉-拉格朗日方程](../Page/歐拉-拉格朗日方程.md "wikilink")）計算在時間\(t+T\)之前的費用最小化策略。控制策略只會實現其中的第一步，之後會再取樣系統的狀態，再由新的狀態去計算新的控制策略，並且預測新的狀態路徑。預測的時間域會漸漸前進，因此模型預測控制也稱為滾動域控制（receding
horizon
control）。雖然此方法不一定是最佳化的，但在實務上有不錯的效果。有計多的學術研究致力於找到歐拉-拉格朗日形式方程的快速求解方式、找到MPC局部最佳解的全域穩定性，以提昇模型預測控制的效果。有些情形下，理論學家在模型預測控制上的成果已差不多要趕上控制工程師的水準了\[6\]。

### 模型預測控制的原則

模型預測控制（MPC）是多變數的控制演算法，利用：

  - 程序的內在動態模型
  - 過去的控制訊號
  - 針對滾動預測域的最佳化費用函數J

來計算最佳化的控制訊號

以下是一個最佳化非線性費用函數的例子：

\[J=\sum_{i=1}^N w_{x_i} (r_i-x_i)^2 + \sum_{i=1}^N w_{u_i} {\Delta u_i}^2\]

沒有限制條件（上下限），而一些變數定義如下

\[x_i\]：第\(i\)個受控變數（例如量測溫度）

\[r_i\]：第\(i\)個參考變數（例如目標溫度）

\[u_i\]：第\(i\)個輸出控制變數（例如控制閥）

\[w_{x_i}\]：反映\(x_i\)相對重要性的加權係數

\[w_{u_i}\]: 懲罰\(u_i\)相對大幅變化的加權係數

## 非線性模型預測控制

非線性模型預測控制（NMPC）是模型預測控制的一種變形，在預測時使用非線性的系統模型。非線性模型預測控制也需要在一個有限的預測時間區間內反覆計算最佳解。這些問題可能在線性模型預測控制中有convex的性質，而在非線性模型預測控制中就沒有convex性質。因此在非線性模型預測控制的穩定性理論以及數值解上都具有挑戰性\[7\]。

非線性模型預測控制的數值解一般是用直接式的最佳控制方式，利用牛頓式的最佳化架構，多半是利用以下方式的變體：[打靶法](../Page/打靶法.md "wikilink")、或是\[8\]。非線性模型預測控制演算法一般會用連續最佳控制的解會彼此相似的特生，因為可以用牛頓式的方式有效的求解，作法是用以下計算過的最佳解經適當調整，作為猜測值，因此可以節省許多的運算時間。這類問題的相似性更進一步的被路径跟踪算法（或是實時迭代法）所使用，路径跟踪算法中，不會針對某一個最佳化問題計算到收斂，而是在開始新的一步之前
，針對最新的非線性模型預測問題進行幾次的迭代\[9\]。

非線性模型預測控制以往主要應用在化工等取様速度較慢的產業，不過隨著控制器硬體以及計算演算法的進步（例如）\[10\]，非線性模型預測控制也用在一些高取樣速度的應用中，例如車輛產生，或是狀態是分散在空間中不同位置的系統（[分佈式參數系統](../Page/分佈式參數系統.md "wikilink")）\[11\]。在航天產業上，非線性模型預測控制也已用在最佳地形跟踪/回避轨迹的實時跟踪\[12\]。

## 顯式模型預測控制

顯式模型預測控制（eMPC）允許對某些系統快速的評估其控制律，這一點和在線MPC有明顯的不同。顯式模型預測控制是以技術為基礎，其中MPC控制問題的解（最佳化問題的目標）已在離線時先行計算\[13\]。離線計算的解（控制律）會以（PWA）的形式表示，因此eMPC控制器會儲存在狀態空間中每一個子集（控制區間）內PWA的係數，並令在同一子集內的係數為定值，而所有的區間中的係數可以用某種參數化的方式來表示。若是線性模型預測控制。每個控制區間在幾何上會變成，一般會用其各個面的係數來參數化，因此需要[量化](https://zh.wikipedia.org/wiki/量化_\(信號處理\) "wikilink")[精度分析](../Page/準確與精密.md "wikilink")\[14\]。因此求得最佳控制解的作法會簡化為先決定包括目前狀態的區間，再來是用所有區間內的PWA係數來計算PWA。若區間數量不多，eMPC的實現（相較於線上MPC）不會需要很大的計算量，也特別適合有快速動態特性的控制系統\[15\]。不過eMPC有一個嚴重的缺點，其運算量會隨區間總數以及控制系統的一些重要參數（例如狀態數量）呈[指數增長](../Page/指數增長.md "wikilink")，此時需要的記憶體會大幅增加，也讓PWA評估的第一部份（尋找目前的控制區間）需要很大的計算量。

## 強健模型預測控制

模型預測控制（MPC）的強健版本可以在存在有界擾動的情形下，仍確保符合狀態的限制條件。有三種主要的強健模型預測控制作法：

  - Min-max模型預測控制。在此作法下，會考慮擾動的所有可能演變來進行最佳化\[16\]。這是線性強健控制問題的最佳解，不過其計算成本很高。
  - 约束集紧缩模型預測控制（Constraint
    Tightening）。此處的狀態限制加大到一定範圍，以確保在任何擾動的演變下，都可以找到解的軌跡\[17\]
  - Tube模型預測控制。此作法會用一個獨立的系統主要模型，再利用回授控制器來確保實際狀態會收斂到主要狀態\[18\]。狀態限制需要區分的數量會由強健正不變（RPI）集來決定，是回授控制器的擾動帶來所有可能狀態偏差的集合。
  - 多階段模型預測控制。使用场景树公式，用一組取樣數據來近似不確定空間，此作法是non-conservative的，因為在預測時，會考慮每一時間下可能有的量測資訊，每個階段的決策可能是不同的，可以作為抵制不確定性影響的手段。此作法的缺點是問題的大小會隨不確定性的數量以及預測范围呈指數成長\[19\]

## 商品化的模型預測控制軟體

目前已可購得商品化的模型預測控制軟體，一般也會包括模型識別及分析、控制器設計及調適的工具，也會有控制器性能評估的工具。

S.J. Qin and T.A. Badgwell在Control Engineering
Practice期刊中（2003年，733–764）有針對商品化軟體的調查\[20\]。

## 模型預測控制器 vs. LQR控制器

模型預測控制器和[LQR控制器的主要差異是LQR控制器針對固定的時間區間進行最佳化](../Page/LQR控制器.md "wikilink")，而模型預測控制器針對不同的時間區間分別進行最佳化\[21\]，因此在不同時間區間內，模型預測控制器可能會產生新的解，而LQR控制器會使用針對所有時間區間下的最佳解。因此模型預測控制器可以在存在硬约束的情形下進行實時的最佳化\[22\]，不過多半是在較小的時間區域中求解最佳化問題，而不是在整個時間區域內求解，因此有時只能徥到次佳的解。

## 相關條目

  - [控制工程](../Page/控制工程.md "wikilink")

  - [控制理论](../Page/控制理论.md "wikilink")

  - [前馈控制](../Page/前馈控制.md "wikilink")

  -
## 參考資料

## 延伸閱讀

  -
  -
  -
  -
  -
  -
  -
  -
  -
  - James B. Rawlings, David Q. Mayne and Moritz M. Diehl: ”Model
    Predictive Control: Theory, Computation, and Design”（2nd Ed.）, Nob
    Hill Publishing, LLC,  (Oct. 2017).

  - Tobias Geyer: Model predictive control of high power converters and
    industrial drives, Wiley, London, , Nov. 2016

## 外部連結

  - [Case
    Study](https://web.archive.org/web/20111008140805/http://viewer.zmags.co.uk/publication/c87cd4eb?page=48#/c87cd4eb/48/).
    Lancaster Waste Water Treatment Works, optimisation by means of
    Model Predictive Control from Perceptive Engineering
  - [ACADO Toolkit](http://www.acadotoolkit.org) - Open Source Toolkit
    for Automatic Control and Dynamic Optimization providing linear and
    non-linear MPC tools. (C++, MATLAB interface available)
  - [μAO-MPC](http://ifatwww.et.uni-magdeburg.de/syst/muAO-MPC/) - Open
    Source Software package that generates tailored code for model
    predictive controllers on embedded systems in highly portable C
    code.

[Category:控制理论](https://zh.wikipedia.org/wiki/Category:控制理论 "wikilink")

1.  Michèle Arnold, Göran Andersson. "Model Predictive Control for
    energy storage including uncertain forecasts"

2.  Tobias Geyer: Model predictive control of high power converters and
    industrial drives, Wiley, London, , Nov. 2016.

3.

4.
5.

6.  Michael Nikolaou, Model predictive controllers: A critical synthesis
    of theory and industrial needs, Advances in Chemical Engineering,
    Academic Press, 2001, Volume 26, Pages 131-204

7.  An excellent overview of the state of the art (in 2008) is given in
    the proceedings of the two large international workshops on NMPC, by
    Zheng and Allgower (2000) and by Findeisen, Allgöwer, and Biegler
    (2006).

8.

9.

10.

11.

12.

13.

14.

15.

16.

17.

18.

19.

20. [A survey of industrial model predictive control
    technology](https://www.scribd.com/doc/16955545/MPC-CEP-Qin-Badgwell)

21.

22.
[缩略图](https://zh.wikipedia.org/wiki/File:NShield_Connect_45_left.jpg "fig:缩略图") **硬件安全模块**（，缩写**HSM**）是一种用于保障和管理强认证系统所使用的[数字密钥](../Page/數位簽章.md "wikilink")，并同时提供相关[密码学](../Page/密码学.md "wikilink")操作的[计算机](https://zh.wikipedia.org/wiki/计算机 "wikilink")[硬件设备](https://zh.wikipedia.org/wiki/硬件设备 "wikilink")。硬件安全模块一般通过[扩展卡或外部设备的形式直接连接到电脑或](https://zh.wikipedia.org/wiki/扩展卡 "wikilink")[网络服务器](https://zh.wikipedia.org/wiki/网络服务器 "wikilink")。

## 设计

HSM提供[篡改留证](https://zh.wikipedia.org/wiki/篡改留证 "wikilink")（tamper evidence/proof）、[篡改抵抗](https://zh.wikipedia.org/wiki/篡改抵抗 "wikilink")（tamper evidence）两种方式的[防篡改](../Page/防篡改.md "wikilink")功能，前者设计使得篡改行为会留下[痕迹](https://zh.wikipedia.org/wiki/痕迹 "wikilink")，后者设计使得篡改行为会令HSM销毁密钥一类的受保护信息。\[1\]每种HSM都会包括一个或多个安全[协处理器](https://zh.wikipedia.org/wiki/协处理器 "wikilink")，用于阻止篡改或[总线](../Page/总线.md "wikilink")探测。

许多HSM系统提供安全备份-{}-外部密钥的机制。密钥可以以封包形式备份并存储在计算机磁盘或其他介质上，或安全的便携式设备（如[智能卡或其他安全令牌](https://zh.wikipedia.org/wiki/智能卡 "wikilink")）存储于外部。\[2\]

由于HSM通常是[公钥基础设施](https://zh.wikipedia.org/wiki/公钥基础设施 "wikilink")（PKI）或[网上银行一类关键](https://zh.wikipedia.org/wiki/网上银行 "wikilink")[基础设施](../Page/基础设施.md "wikilink")的一部分，一般会同时使用多个HSM以实现高可用性。一些HSM具备双电源、无需停机更换配件（如冷却风扇）等设计，以确保在[数据中心](../Page/数据中心.md "wikilink")等环境中的高可用性要求。

少数HSM可以让用户在其内部处理器上运行专门开发的模块。在一些场景下，这种设计相当实用，例如用户可以在这种安全、受控的环境下运行一些特殊的[算法](../Page/算法.md "wikilink")或者业务逻辑，哪怕攻击者取得了计算机的完全控制权限，存储在HSM（连接到计算机）中的程序也无法被提取或篡改。一般HSM允许用户使用[C](https://zh.wikipedia.org/wiki/C语言 "wikilink")、[.NET](https://zh.wikipedia.org/wiki/.NET "wikilink")、[Java](../Page/Java.md "wikilink")等[编程语言](../Page/编程语言.md "wikilink")开发这种专用程序。值得注意的是，用户自定义的程序与HSM本身的程序之间存在隔离，这使程序的存在不会影响到HSM本身的安全。 [缩略图](https://zh.wikipedia.org/wiki/File:Keyper_Plus_HSM.png "fig:缩略图")

## 安全性

考虑到硬件安全模块（HSM）在[应用程序](../Page/应用程序.md "wikilink")与基础设施的安全中扮演的关键角色，此类密码学模块通常都会经过、等受到国际承认的认证。这将为用户提供产品设计与实现上的保障，同时确保相应的密码学算法能按预期方式正确工作。FIPS 140安全认证最高认证等级为Level 4（整体），目前仅有极少数HSM成功通过这一等级的认证，大部分设备处于Level 3等级。

## 使用

硬件安全模块可在任何涉及到[密钥](../Page/密钥.md "wikilink")的场景下使用。通常来说，这些密钥具有较高的价值，一旦泄露会导致严重的后果。

硬件安全模块的功能通常包括：

  - 板载密码学安全密钥生成
  - 板载密码学安全密钥存储与管理
  - 加密且敏感资料的使用
  - 卸载（代办）应用程序服务器的[对称与](../Page/對稱密鑰加密.md "wikilink")[非对称加密计算](../Page/公开密钥加密.md "wikilink")。

HSM也用于数据库[透明加密](../Page/透明加密.md "wikilink")的密钥管理。

对于密钥在内的敏感信息，HSM同时提供逻辑层面与物理层面的保护，以防止未经授权的访问或者可能的入侵。\[3\]

尽管HSM主要用于处理[公钥密码学使用的密钥对](https://zh.wikipedia.org/wiki/公钥密码学 "wikilink")（可能以数字证书的形式存在，如[X.509](../Page/X.509.md "wikilink")格式证书），一些情况下也处理[对称密码学使用的对称密钥或者任意类型的数据](https://zh.wikipedia.org/wiki/对称密钥 "wikilink")。

一些HSM系统也用作硬件[密码学加速器](https://zh.wikipedia.org/wiki/wikipedia:Cryptographic_accelerator "wikilink")。尽管此类HSM在对称密码学相关的运算性能上不如那些为对称密码学加速特化设计的硬件，但它们在进行公钥密码学操作时能大大减轻连接到的主机的CPU运算负荷。它们一般每秒能完成1\~10,000次1024位[RSA签名操作](../Page/RSA加密演算法.md "wikilink")。由于自2010年起，[NIST推荐选取](../Page/國家標準技術研究所.md "wikilink")2048位及以上的RSA密钥长度，\[4\] 在更长密钥下保证速度就变得越来越重要了。对此，有些HSM已经支持同等安全程度仅需更短密钥的[椭圆曲线密码学](../Page/椭圆曲线密码学.md "wikilink")（ECC） 。

### PKI应用场景 (证书颁发机构硬件安全模块)

在[PKI场景下](../Page/公開金鑰基礎建設.md "wikilink")，[证书颁发机构](https://zh.wikipedia.org/wiki/数字证书认证机构 "wikilink")（CA）及注册机构（RA）可能使用HSM生成、储存、使用密钥对。此时，设备必须具备以下的基本特性：

  - 高等级的逻辑及物理安全保护
  - 需要多用户同时参与的授权方案 (参见Blakley-Shamir方案)
  - 日志记录及审计
  - 密钥安全备份

另一方面，由于线上或线下的PKI操作一般都需要注册机构人工审核（DV验证除外），处理速度瓶颈在于人工流程，因此该场景下设备性能相对次要。

### 卡交易应用场景 (银行硬件安全模块)

[缩略图](https://zh.wikipedia.org/wiki/File:LunaEFT.jpg "fig:缩略图") 用于卡交易系统的HSM一般会比用于CA的HSM更加轻量，同时通常也不会提供标准[API](../Page/应用程序接口.md "wikilink")。此类设备主要可被分为以下两类：

[ATM](../Page/自動櫃員機.md "wikilink")、[POS终端中的HSM用于](https://zh.wikipedia.org/wiki/POS机 "wikilink")：

  - 当用户使用卡时，加密输入的[PIN码](https://zh.wikipedia.org/wiki/PIN碼 "wikilink")
  - 加载密钥到受保护的内存区域

授权与自定义模块用于：

  - 使用在线数据验证加密的PIN数据块
  - 与ATM控制器共同使用，以便通过检查[CVV2码或调用](https://zh.wikipedia.org/wiki/信用卡安全码 "wikilink")[EMV](../Page/EMV.md "wikilink")卡内组件，验证借记卡/信用卡的交易合法性
  - 支持智能卡（例如[EMV](../Page/EMV.md "wikilink")卡）的安全操作API
  - 重复加密PIN数据块以便发送至其它授权设备
  - 支持POS ATM网络管理协议
  - 支持基于de facto标准的设备间密钥/数据交换API
  - 生成并打印包含PIN的密码卡
  - 生成磁条卡数据 (PVV, [CVV](https://zh.wikipedia.org/wiki/信用卡安全码 "wikilink"))
  - 生成卡密钥集并支持[智能卡的自定义处理过程](../Page/智慧卡.md "wikilink")

[PCI安全标准委员会是负责制定并维护卡交易系统HSM标准的主要机构](https://zh.wikipedia.org/wiki/PCI安全标准委员 "wikilink")。

### SSL链接建立

需要使用[HTTPS](../Page/超文本传输安全协议.md "wikilink")（[SSL](https://zh.wikipedia.org/wiki/傳輸層安全協議 "wikilink")/[TLS](https://zh.wikipedia.org/wiki/傳輸層安全協議 "wikilink")）的性能敏感应用，通过使用带SSL加速功能的HSM, 可以获得一定的性能提升。SSL的[RSA操作需要进行大整数乘法等操作](../Page/RSA加密演算法.md "wikilink")，不同于通用CPU，HSM通过针对这些操作的特化设计，能以更高的效率完成这些操作。一般HSM每秒可完成1\~10,000次的1024位RSA操作。\[5\] 随着RSA密钥长度不断增加，因此而导致的速度下降已经成为一个重要问题。对此，有些HSM\[6\] 已经支持同等安全程度仅需更短密钥的[椭圆曲线密码学](../Page/椭圆曲线密码学.md "wikilink")（ECC） 。特定型号的HSM的操作速度已经可以达到20,000次每秒。\[7\]

### DNSSEC

越来越多的域名注册商开始使用HSM来存储签名DNS区域文件使用的密钥。OpenDNSSEC是一个可在HSM环境下管理DNS区域文件签名的开源工具。

DNS根区的DNSSEC部署于2007年1月27日正式开始，该任务由[ICANN与](https://zh.wikipedia.org/wiki/ICANN "wikilink")[VeriSign在](https://zh.wikipedia.org/wiki/VeriSign "wikilink")[美国商务部](../Page/美国商务部.md "wikilink")的支持下共同完成。\[8\] 详情可参见[Root DNSSEC's website](http://www.root-dnssec.org/)。

## 参见

  - [電子金融轉帳](https://zh.wikipedia.org/wiki/電子金融轉帳 "wikilink")

  -
  - [公開金鑰基礎建設](../Page/公開金鑰基礎建設.md "wikilink")

  -
  - [安全令牌](https://zh.wikipedia.org/wiki/安全令牌 "wikilink")

  -
## 参考资料

## 外部链接

  - [Current NIST FIPS-140 certificates](https://web.archive.org/web/20141226152243/http://csrc.nist.gov/groups/STM/cmvp/documents/140-1/140val-all.htm)
  - [A Review of Hardware Security Modules](https://www.opendnssec.org/wp-content/uploads/2011/01/A-Review-of-Hardware-Security-Modules-Fall-2010.pdf)

[Category:密码硬件](https://zh.wikipedia.org/wiki/Category:密码硬件 "wikilink") [Category:银行技术](https://zh.wikipedia.org/wiki/Category:银行技术 "wikilink")

1.
2.
3.
4.
5.
6.
7.
8.
**置信域方法**（**Trust-region
methods**）又称为**信赖域方法**，它是一种[最优化](../Page/最优化.md "wikilink")方法，能够保证[最优化](../Page/最优化.md "wikilink")方法总体收敛。

## 算法发展

置信域方法的历史可以追溯到Levenberg(1944)，Marquardt(1963)，Goldfeld，Quandt and
Trotter(1966)，但现代置信域方法是Powell(1970)提出来的。他明确提出了置信域子问题，接受方向步\(s_k\)的准则，校正置信域半径\(\nabla _k\)的准则，及收敛性定理。这些措施使置信域方法比[线搜索](../Page/线搜索.md "wikilink")方法具有更大的优越性。

## 思想框架

考虑\(\underset{x\in {{R}^{n}}}{\mathop{\min }}\,f(x)\)，其中*ƒ*(*x*)是定义在**R**<sup>n</sup>上的二阶连续可微[函数](../Page/函数.md "wikilink")。
定义当前点的[邻域](../Page/邻域.md "wikilink")\({{\Omega }_{k}}\)

<div style="text-align: center;">

\({{\Omega }_{k}}=\{x\in {{R}^{n}}|\left\| x-{{x}_{k}} \right\|\le {{\Delta }_{k}}\},\)

</div>

这里\({\Delta }_{k}\)称为置信域半径。假定在这个[邻域](../Page/邻域.md "wikilink")中，二次模型是目标函数*ƒ*(*x*)的一个合适的近似，则在这个[邻域](../Page/邻域.md "wikilink")（称为置信域）中极小化二次模型，得到近似极小点\(s_k\)，并取
，其中\(\left\| {{s}_{k}} \right\|\le {{\Delta }_{k}}\)。

置信域方法的模型子问题是

<div style="text-align: center;">

\(\left\{ \begin{align}
  & \min \ {{q}^{(k)}}(s)=f({{x}_{k}})+g_{k}^{T}s+\frac{1}{2}{{s}^{T}}{{B}_{k}}s \\
 & s.t.\quad \left\| s \right\|\le {{\Delta }_{k}} \\
\end{align} \right.\)

</div>

其中，\(s=x-x_k\)，\({{g}_{k}}=\nabla f({{x}_{k}})\)，\(B_k\)是一个[对称矩阵](https://zh.wikipedia.org/wiki/对称矩阵 "wikilink")，它是[黑塞矩阵](https://zh.wikipedia.org/wiki/黑塞矩阵 "wikilink")\({{\nabla }^{2}}f({{x}_{k}})\)或其近似，\({{\Delta }_{k}}>0\)为置信域半径，\(\left\| \ \centerdot \  \right\|\)为某一[范数](../Page/范数.md "wikilink")，通常我们采用\(l_2\)[范数](../Page/范数.md "wikilink")。

选择\({{\Delta }_{k}}\)的方法：根据模型函数\({{q}^{(k)}}(s)\)对目标函数*ƒ*(*x*)的拟合程度来调整置信域半径\({{\Delta }_{k}}\)。
对于置信域方法的模型子问题的解\({{s}_{k}}\)，设目标函数的下降量

<div style="text-align: center;">

\(Are{{d}_{k}}=f({{x}_{k}})-f({{x}_{k}}+{{s}_{k}})\)

</div>

为实际下降量，设模型函数的下降量

<div style="text-align: center;">

\(Pre{{d}_{k}}={{q}^{(k)}}(0)-{{q}^{(k)}}({{s}_{k}})\)

</div>

为预测下降量。 定义比值

<div style="text-align: center;">

\({{r}_{k}}=\frac{Are{{d}_{k}}}{Pre{{d}_{k}}}=\frac{f({{x}_{k}})-f({{x}_{k}}+{{s}_{k}})}{{{q}^{(k)}}(0)-{{q}^{(k)}}({{s}_{k}})}\),

</div>

它用来衡量模型函数\({{q}^{(k)}}\)与目标函数*ƒ* 的一致性程度。

## 置信域算法

  - 步1. 给出初始点*x*<sub>*0*</sub>
    ，置信域半径的上界\(\bar{\Delta }\)，\({{\Delta }_{0}}\in (0,\bar{\Delta })\)，\(\varepsilon \ge 0\)，\(0<{{\eta }_{1}}\le {{\eta }_{2}}<1\)，\(0<{{\gamma }_{1}}<1<{{\gamma }_{2}}\)，\(k\ :=0\)
  - 步2. 如果\(\left\| {{g}_{k}} \right\|\le \varepsilon\)，停止
  - 步3. （近似地）求解置信域方法的模型子问题，得到 *s*<sub>*k*</sub>
  - 步4. 计算*ƒ*(*x*<sub>*k*</sub>+*s*<sub>*k*</sub>) 和 *r*<sub>*k*</sub>。令

<div style="text-align: center;">

\({{x}_{k+1}}=\left\{ \begin{align}
  & {{x}_{k}}+{{s}_{k}},\quad \text{if }{{r}_{k}}\ge {{\eta }_{1}} \\
 & {{x}_{k}},\quad \quad \quad \text{else} \\
\end{align} \right.\)

</div>

  - 步5. 校正置信域半径，令

<div style="text-align: center;">

<math>\\begin{align}

` & {{\Delta }_{k+1}}\in (0,{{\gamma }_{1}}{{\Delta }_{k}}],\quad \quad \quad \quad \ \ \ \text{if }``<{{\eta }_{1}}; \\ `
`& {{\Delta }_{k+1}}\in [{{\gamma }_{1}}{{\Delta }_{k}},{{\Delta }_{k}}],\quad \quad \quad \quad \ \text{if }``\in [{{\eta }_{1}},{{\eta }_{2}}); `
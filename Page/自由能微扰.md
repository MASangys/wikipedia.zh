**自由能微扰** （,
[縮寫](../Page/縮寫.md "wikilink")：**FEP**）是用来计算[自由能的一种常用方法](https://zh.wikipedia.org/wiki/自由能 "wikilink")。最早由R.
W.
Zwanzig在1954年提出\[1\]。以[正则系综为例](https://zh.wikipedia.org/wiki/正则系综 "wikilink")，从状态A到状态B的[自由能变化可以由下式算出](https://zh.wikipedia.org/wiki/自由能 "wikilink")：

\[\Delta F(A \rightarrow B) = F_B - F_A = -k_B T \ln \left \langle \exp \left ( - \frac{H_B - H_A}{k_B T} \right ) \right \rangle _A\]
其中T为温度，\(H_A\)和
\(H_B\)分别为状态A和状态B的[哈密顿量](https://zh.wikipedia.org/wiki/哈密顿量 "wikilink")，\(k_B\)为[玻尔兹曼常数](https://zh.wikipedia.org/wiki/玻尔兹曼常数 "wikilink")，\(\langle\rangle\)表示在状态A的[系综中取系综平均](../Page/系综.md "wikilink")。简单而言，为了计算状态A与状态B之间的自由能差，只需通过在状态A的系综中对两状态之间的能量差采样，然后求平均即可。采样可以使用[分子动力学或者](../Page/分子动力学.md "wikilink")[蒙特卡洛方法模拟](https://zh.wikipedia.org/wiki/蒙特卡洛方法 "wikilink")。

## 原理

以正则系综为例，已知状态A的[配分函数为](../Page/配分函数.md "wikilink")\(Q_A\)

\[Q_A = \int d\textbf{r}^N \textbf{p}^N e^{-\beta H_A(\textbf{r}^N,\textbf{p}^N)},\]
其中\(\beta = 1/k_BT\)。那么状态B的[配分函数](../Page/配分函数.md "wikilink")\(Q_B\)可以做如下改写

\[\begin{align}
                  Q_B& = \int d\textbf{r}^N \textbf{p}^N e^{-\beta H_B(\textbf{r}^N,\textbf{p}^N)}  \\
                        & =  \int d\textbf{r}^N \textbf{p}^N e^{-\beta H_A(\textbf{r}^N,\textbf{p}^N)}
                                    e^{-\beta [H_B(\textbf{r}^N,\textbf{p}^N) - H_A(\textbf{r}^N,\textbf{p}^N)]} \\
                         & = Q_A \int d\textbf{r}^N \textbf{p}^N\frac{e^{-\beta [H_B(\textbf{r}^N,\textbf{p}^N) - H_A(\textbf{r}^N,\textbf{p}^N)]}}{Q_A}\\
                         & = Q_A \langle e^{-\beta [H_B- H_A]}\rangle_A

                 \end{align}\] 即

\[\frac{Q_B}{Q_A} = \langle e^{-\beta [H_B- H_A]}\rangle_A\].
而状态B与A之间的自由能差

\[\begin{align}
\Delta F(A \rightarrow B) &= F_B - F_A \\
              & = - (k_BT \ln Q_B - k_BT\ln Q_A) \\
              & = -k_BT \ln \frac{Q_B}{Q_A}
\end{align}\] 故有

\[\Delta F(A \rightarrow B) = F_B - F_A = -k_B T \ln \left \langle \exp \left ( - \frac{H_B - H_A}{k_B T} \right ) \right \rangle _A\]。

## 应用

自由能微扰被广泛应用于各种自由能的计算，并被集成到各种分子模拟软件中，包括：

  - [AMBER](https://zh.wikipedia.org/wiki/AMBER "wikilink")\[2\]
  - [BOSS](https://zh.wikipedia.org/wiki/BOSS_\(molecular_mechanics\) "wikilink")
  - [CHARMM](../Page/CHARMM.md "wikilink")
  - [Desmond](https://zh.wikipedia.org/wiki/Desmond_\(software\) "wikilink")
  - [GROMACS](../Page/GROMACS.md "wikilink")
  - [MacroModel](https://zh.wikipedia.org/wiki/MacroModel "wikilink")
  - [MOLARIS](https://zh.wikipedia.org/wiki/MOLARIS "wikilink")
  - [NAMD](https://zh.wikipedia.org/wiki/NAMD "wikilink")
  - [Tinker](https://zh.wikipedia.org/wiki/Tinker "wikilink")

在使用自由能微扰进行自由能计算的时候，需要注意由于状态A与B之间能量差太大而导致的采样不足问题\[3\]。在这种情况下，需要把A到B之间划分成多个窗口进行采样，或者采用其他自由能计算方法，比如
以及。

## 参考资料

<references />

[Category:计算化学](https://zh.wikipedia.org/wiki/Category:计算化学 "wikilink")
[Category:统计力学](https://zh.wikipedia.org/wiki/Category:统计力学 "wikilink")

1.  Zwanzig, R. W. J. Chem. Phys. 1954, 22, 1420-1426.
2.  <http://www.ambermd.org>
3.  Pohorille A, Jarzynski C, Chipot C J Phys Chem B. 2010 Aug
    19;114(32):10235-53. .
**认证加密**（，**AE**）和**用于关联数据的认证加密**（**authenticated encryption with associated data**，**AEAD**，AE的变种）是一种能够同时保证数据的[保密性](https://zh.wikipedia.org/wiki/保密 "wikilink")、 [完整性和](https://zh.wikipedia.org/wiki/数据完整性 "wikilink")的一种[加密](../Page/加密.md "wikilink")模式。这些属性都是在一个易于使用的[编程接口下提供的](../Page/应用程序接口.md "wikilink")。

人们观察发现安全地将[保密模式与认证模式组合可能是容易出错和困难的](https://zh.wikipedia.org/wiki/分组密码工作模式 "wikilink")，于是认证加密应运而生。\[1\]\[2\] 这一点已由许多实际攻击证实，这些攻击通过对身份验证（包括SSL与TLS）的不正确实现或缺失，引入到了生产协议和应用程序中。\[3\]

在2000年左右，围绕这个概念进行了一些努力。特别是，2000年[Charanjit Jutla发表IACBC和](https://zh.wikipedia.org/wiki/Charanjit_Jutla "wikilink")模式，引发了人们对这些模式的强烈兴趣。\[4\] ISO/IEC 19772:2009已经对六种不同的认证加密模式（即 2.0, , , , Encrypt-then-MAC (EtM)和）进行了标准化。\[5\] 在[NIST的征集下开发了更多的模式](../Page/國家標準技術研究所.md "wikilink")。\[6\] [海綿函數](../Page/海綿函數.md "wikilink")可以在双工模式下使用，提供经过认证的加密。\[7\]

## 认证加密的方法

### Encrypt-then-MAC (EtM)

[Authenticated_Encryption_EtM.png](https://zh.wikipedia.org/wiki/File:Authenticated_Encryption_EtM.png "fig:Authenticated_Encryption_EtM.png") 首先对明文进行加密，然后根据得到的密文生成MAC。密文和它的MAC一起发送。用于例如[IPsec](../Page/IPsec.md "wikilink")中。EtM是ISO/IEC 19772:2009规定的六种认证加密方法中的一种。\[8\]这是唯一可以达到认证加密安全性最高定义的方法，但这只有在使用的MAC“强不可伪造”时才能实现。\[9\]2014年11月，EtM的[傳輸層安全性協定](../Page/傳輸層安全性協定.md "wikilink")（TLS）和[資料包傳輸層安全](https://zh.wikipedia.org/wiki/資料包傳輸層安全 "wikilink")（DTLS）扩展已经作为RFC 7366发布。各种EtM密码套件也存在于SSHv2中（例如`hmac-sha1-etm@openssh.com`）。

### Encrypt-and-MAC (E\&M)

[Authenticated_Encryption_EaM.png](https://zh.wikipedia.org/wiki/File:Authenticated_Encryption_EaM.png "fig:Authenticated_Encryption_EaM.png") 基于明文生成MAC，并且明文在没有MAC的情况下被加密。明文的MAC和密文一起发送。用于例如[SSH](../Page/Secure_Shell.md "wikilink")。E\&M方法本身并未被证明是“强不可伪造”的。\[10\]

### MAC-then-Encrypt (MtE)

[Authenticated_Encryption_MtE.png](https://zh.wikipedia.org/wiki/File:Authenticated_Encryption_MtE.png "fig:Authenticated_Encryption_MtE.png") 基于明文生成MAC，然后将明文和MAC一起加密以基于两者生成密文。密文（包含加密的MAC）被发送。MtE方法本身并未被证明是“强不可伪造”的。用于例如[SSL/TLS](../Page/傳輸層安全性協定.md "wikilink")。\[11\]尽管有理论上的安全性，但对SSL/TLS进行更深入的分析将保护模型化为MAC-then-pad-then-encrypt，即明文先填充到加密函数的块大小。填充错误通常会导致接收方发现可检测到的错误，从而导致，如[Lucky Thirteen attack](https://zh.wikipedia.org/wiki/Lucky_Thirteen_attack "wikilink")。

## 参见

  - [分组密码工作模式](https://zh.wikipedia.org/wiki/分组密码工作模式 "wikilink")

  -
  -
  -
  -
  -
  -
  -
## 参考文献

  - 一般性

<!-- end list -->

  -
## 外部链接

  - [NIST: Modes Development](http://csrc.nist.gov/groups/ST/toolkit/BCM/modes_development.html)
  - [How to choose an Authenticated Encryption mode](http://blog.cryptographyengineering.com/2012/05/how-to-choose-authenticated-encryption.html)

[Category:对称密码学](https://zh.wikipedia.org/wiki/Category:对称密码学 "wikilink")

1.  *"people had been doing rather poorly when they tried to glue together a traditional (privacy-only) encryption scheme and a message authentication code (MAC)"*, in:

2.  *"it is very easy to accidentally combine secure encryption schemes with secure MACs and still get insecure authenticated encryption schemes"*, in:

3.

4.

5.

6.

7.

8.
9.

10.
11.
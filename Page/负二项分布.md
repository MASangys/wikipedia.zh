> 本文内容由[负二项分布](https://zh.wikipedia.org/wiki/负二项分布)转换而来。


\\\!</math> |kurtosis =\(\frac{6}{r} + \frac{p^2}{r\,(1-p)}\!\) |entropy = |mgf =\(\left(\frac{p}{1-(1-p) e^t}\right)^r \!\) |char =\(\left(\frac{p}{1-(1-p) e^{i\,t}}\right)^r \!\) }}

**負二項分布**是[統計學上一種描述在一系列独立同分布的伯努利试验中](https://zh.wikipedia.org/wiki/統計學 "wikilink")，失败次数到达指定次数（记为r）时成功次数的[離散概率分布](https://zh.wikipedia.org/wiki/離散概率分布 "wikilink")。比如，如果我们定义掷骰子随机变量x值为x=1时为失败，所有x≠1为成功，这时我们反复掷骰子直到1出现3次（失败次数r=3），此时非1数字出现次数的概率分布即为负二项分布。

[帕斯卡分布](https://zh.wikipedia.org/wiki/帕斯卡分布 "wikilink")（**Pascal distribution，**来自Blaise Pascal）和[波利亚分布](https://zh.wikipedia.org/wiki/波利亚分布 "wikilink")（**Polya distribution**，又称罐子模型，来自George Pólya）均是负二项分布的特例。在工程，气候等领域中经常用“负二项分布”或“帕斯卡分布”来描述变量r为整数的情况，而使用“波利亚分布”来描述r取到实数值R的情况。

对于“传染性的”（"contagious"）的离散事件，例如龙卷风爆发，相比泊松分布，波利亚分布由于允许其平均值和方差不同，而能够给出更精确的模型。“传染性”的事件中，如果事件发生率相互独立，其发生率间的正相关性（即发生率间存在正协方差项）会导致变量分布有更大的方差。

“负二项分布”与“二项分布”的区别在于：“二项分布”是固定试验总次数N的独立试验中，成功次数k的分布；而“负二项分布”是所有到失败r次时即终止的独立试验中，成功次数k的分布。

## 定义

若每次伯努利试验有两种可能的结果，分别为成功或者失败。在每次试验中，成功的概率为p，失败的概率为（1-p）。反复进行该伯努利试验，直到观察到第r次失败发生。此时试验成功次数*\(X\)*的分布即为负二项分布（或称帕斯卡分布），那么：

  -
    **若随机变量\(\mathit{X}\)服从参数为\(\mathit{r}\)和\(\mathit{p}\)的负二项分布，则记为\(X \sim NB(r,p)\).**

在实际生活中，我们可以使用负二项分布描述某种机器在坏掉前，能够工作的天数的分布。此时，“成功”的事件可以指机器正常工作一天，“失败”的事件可以指机器故障的一天。如果我们使用负二项分布来描述运动员在获取r个奖牌前尝试的次数的分布，此时，“成功”的事件指运动员的一次尝试，“失败”的事件指运动员获取一枚奖牌。如果使用负二项分布来描述掷一枚硬币出现r次反面前，出现硬币正面的次数的分布，“成功”的事件指出现硬币的正面，“失败”的事件指出现硬币的反面。

## 概率质量函数

### 帕斯卡分布

當\(r\)是整數時的負二項分布又稱**帕斯卡分布**，其[概率質量函數為](https://zh.wikipedia.org/wiki/概率質量函數 "wikilink")：

\(f(k; r, p) \equiv \Pr(X = k) = \binom{k+r-1}{k} p^k(1-p)^r
\quad\text{for }k = 0, 1, 2, \dotsc\)

其中*k*是成功的次数，*r*是失败的次数，*p*是事件成功的概率。在负二项分布的概率质量函数中，由于*k+r*次伯努利试验为独立同分布，每个失败*r*次、成功*k*次的事件的概率为。由于第r次失败一定是最后一次试验，所以应该在k+r-1次试验中选择k次成功，使用排列组合二项系数获取所有可能的选择数。

#### 二项系数与负二项名称来源

括号中为[二项式系数表达式](../Page/二項式係數.md "wikilink")：

  -
    <math>

`   \binom{k+r-1}{k} = \frac{(k+r-1)!}{(k)!\,(r-1)!} = \frac{(k+r-1)(k+r-2)\dotsm(r)}{(k)!}`
` `</math>

该表达式可以写成带负值参数的二项系数的形式，如下式所示，解释了“负二项”名称的来源：

  -
    <math>

\\begin{align} & \\frac{(k+r-1)\\dotsm(r)}{k\!} \\\\\[6pt\]

# {}& (-1)^k \\frac{(-r)(-r-1)(-r-2)\\dotsm(-r-k+1)}{k\!}

(-1)^k\\binom{-r}{k}. \\end{align} </math>

#### 概率密度函数对所有可能k值求和为1

帕斯卡分布概率质量函数f(k;r,p)对所有可能k值求和，一定等于1：

\(\sum_{k=0}^\infty \binom{k+r-1}{k}p^r q^k = 1\)

证明如下：

\(1= p^r p^{-r}
 = p^r(1-q)^{-r}
 = p^r\sum_{k=0}^\infty\binom{-r}{k}(-q)^k
 = p^r\sum_{k=0}^\infty(-1)^k\binom{-r}{k}q^k
 = \sum_{k=0}^\infty \binom{k+r-1}{k}p^r q^k\)

其中第三步用到了[二项序列展开](https://zh.wikipedia.org/wiki/二项序列 "wikilink")。

### 几何分布

取\(r=1\)，負二項分布等於幾何分布。其概率質量函數為\(f(k;1,p) =  p \cdot (1-p)^k \!\)。

### 例子

舉例說，若我們擲骰子，擲到一即視為成功。則每次擲骰的成功率是1/6。要擲出三次一，所需的擲骰次數屬於集合{ 3, 4, 5, 6, ... }。擲到三次一的擲骰次數是負二項分布的隨機變數。要在第三次擲骰時，擲到第三次一，則之前兩次都要擲到一，其機率為\((1/6)^3\)。注意擲骰是伯努利試驗，之前的結果不影響隨後的結果。

若要在第四次擲骰時，擲到第三次一，則之前三次之中要有剛好兩次擲到一，在三次擲骰中擲到2次1的機率為\({3 \choose 3-1}({5\over6})({1\over6})^2\)。第四次擲骰要擲到一，所以要將前面的機率再乘（1/6）：\({1+3-1 \choose 3-1}({1\over6})^3 ({5\over6})\)。

[Category:离散分布](https://zh.wikipedia.org/wiki/Category:离散分布 "wikilink") [Category:阶乘与二项式主题](https://zh.wikipedia.org/wiki/Category:阶乘与二项式主题 "wikilink")
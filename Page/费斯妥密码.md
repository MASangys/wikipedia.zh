在[密码学](../Page/密码学.md "wikilink")中，**费斯妥密码**（）是用于构造[分组密码](../Page/分组密码.md "wikilink")的对称结构，以[德国](../Page/德国.md "wikilink")出生的[物理学家](../Page/物理学家.md "wikilink")和密码学家[霍斯特·费斯妥](https://zh.wikipedia.org/wiki/霍斯特·费斯妥 "wikilink")（Horst Feistel）命名，他在美国[IBM](../Page/IBM.md "wikilink")工作期间完成了此项开拓性研究。通常也称为**费斯妥网络**（Feistel network）。大部分分组[密码使用该方案](https://zh.wikipedia.org/wiki/密码 "wikilink")，包括[数据加密标准](https://zh.wikipedia.org/wiki/数据加密标准 "wikilink")（DES）。费斯妥结构的优点在于[加密](../Page/加密.md "wikilink")和[解密操作非常相似](https://zh.wikipedia.org/wiki/解密 "wikilink")，在某些情况下甚至是相同的，只需要逆转[密钥编排](https://zh.wikipedia.org/wiki/密钥编排 "wikilink")。因此，实现这种密码所需的代码或电路大小能几乎减半。

费斯妥网络是一种迭代密码，其中的内部函数称为轮函数。\[1\]

## 历史

Feistel网络最初在IBM的[Lucifer密码中商业化](https://zh.wikipedia.org/wiki/Lucifer_\(密码学\) "wikilink")，这种密码由[霍斯特·费斯妥和](https://zh.wikipedia.org/wiki/霍斯特·费斯妥 "wikilink")[Don Coppersmith于](https://zh.wikipedia.org/wiki/Don_Coppersmith "wikilink")1973年设计。美国联邦政府在设计[DES](https://zh.wikipedia.org/wiki/数据加密标准 "wikilink")（基于Lucifer密码，由[NSA进行修改](../Page/美国国家安全局.md "wikilink")）时采用了Feistel网络。像DES的其他组件一样，Feistel构造中的迭代特性使得在硬件中（特别是在设计DES时已有的硬件上）实现密码系统更容易。

## 理论工作

许多现代及一些较旧的对称分组密码基于Feistel网络（例如[GOST 28147-89分组密码](https://zh.wikipedia.org/wiki/GOST_28147-89 "wikilink")），且[密码学家已经深入研究了Feistel密码的结构和性质](https://zh.wikipedia.org/wiki/密码学家 "wikilink")。具体而言，[Michael Luby和](https://zh.wikipedia.org/wiki/Michael_Luby "wikilink")[Charles Rackoff分析了Feistel密码的构造](https://zh.wikipedia.org/wiki/Charles_Rackoff "wikilink")，证明了如果轮函数是一个密码安全的[伪随机函数](https://zh.wikipedia.org/wiki/伪随机函数 "wikilink")，使用K<sub>i</sub>作为种子，那么3轮足以使这种分组密码成为[伪随机置换](https://zh.wikipedia.org/wiki/伪随机置换 "wikilink")，而4轮可使它成为“强”伪随机置换（这意味着，对可以得到其逆排列[谕示的攻击者](https://zh.wikipedia.org/wiki/预言机 "wikilink")，它仍然是伪随机的）\[2\]。

由于Luby和Rackoff的结果非常重要，Feistel密码有时也称为Luby-Rackoff分组密码。进一步的理论工作对其进行了推广，给出了更加精确的安全界限\[3\]\[4\]。

## 构造细节

[Feistel_cipher_diagram_en.svg](https://zh.wikipedia.org/wiki/File:Feistel_cipher_diagram_en.svg "fig:Feistel_cipher_diagram_en.svg")

令\({\rm F}\)为轮函数，并令\(K_0,K_1,\ldots,K_{n}\)分别为轮\(0,1,\ldots,n\)的子密钥。

基本操作如下：

将明文块拆分为两个等长的块，(\(L_0\), \(R_0\))

对每轮\(i =0,1,\dots,n\)，计算

\[L_{i+1} = R_i\,\]

\[R_{i+1}= L_i \oplus {\rm F}(R_i, K_i).\]

则密文为\((R_{n+1}, L_{n+1})\)。

解密密文\((R_{n+1}, L_{n+1})\)则通过计算\(i=n,n-1,\ldots,0\)

\[R_{i} = L_{i+1}\,\]

\[L_{i} = R_{i+1} \oplus \operatorname{F}(L_{i+1}, K_i).\]

则\((L_0,R_0)\)就是明文。

与[代换-置换网络](../Page/代换-置换网络.md "wikilink")相比，Feistel模型的一个优点是轮函数\(\operatorname{F}\)不必是可逆的。

右图显示了加密和解密的过程。注意解密时子密钥顺序反转，这是加密和解密之间的唯一区别。

### 非平衡Feistel密码

非平衡Feistel密码相比其有所修改，其中\(L_0\)和\(R_0\)的长度不等\[5\]。[Skipjack密码就是这种密码的一个例子](https://zh.wikipedia.org/wiki/Skipjack_\(密码学\) "wikilink")。[德州仪器](../Page/德州仪器.md "wikilink")[数字签名转发器使用专有的非平衡Feistel密码来执行](https://zh.wikipedia.org/wiki/数字签名转发器 "wikilink")[挑战-响应认证](https://zh.wikipedia.org/wiki/挑战-响应认证 "wikilink")\[6\]。

[Thorp shuffle是一种非平衡Feistel密码的极端情况](https://zh.wikipedia.org/wiki/Thorp_shuffle "wikilink")，其中一边只有一位。这比平衡Feistel密码具有更好的可证明安全性，但需要更多轮\[7\]。

### 其他用途

除了分组密码外，Feistel结构也用于其他密码算法。例如，[最优非对称加密填充](https://zh.wikipedia.org/wiki/最优非对称加密填充 "wikilink")（OAEP）在某些[非对称密钥加密方案中](../Page/公开密钥加密.md "wikilink")，使用简单的Feistel网络对密文进行随机化。

一个广义的Feistel算法可以用来在大小不是2的幂的小域上创建强排列（参见[保留格式加密](https://zh.wikipedia.org/wiki/保留格式加密 "wikilink")）。\[8\]

### Feistel网络作为设计组件

无论整个密码是否是Feistel密码，类Feistel网络都可以在设计密码时用作其中一个组成部分。例如，[MISTY1是一个使用三轮Feistel网络的Feistel密码函数](https://zh.wikipedia.org/wiki/MISTY1 "wikilink")，[Skipjack是一个修改的Feistel密码](https://zh.wikipedia.org/wiki/Skipjack_\(密码学\) "wikilink")，在它的G置换中使用Feistel网络，[Threefish](https://zh.wikipedia.org/wiki/Threefish "wikilink")（[Skein](https://zh.wikipedia.org/wiki/Skein_\(哈希函数\) "wikilink")）是一个非Feistel的分组密码，其一部分使用了类Feistel的MIX函数。

## Feistel密码列表

Feistel或修改过的Feistel密码：

  - [Blowfish](https://zh.wikipedia.org/wiki/Blowfish_\(密码学\) "wikilink")
  - [Camellia](https://zh.wikipedia.org/wiki/Camellia_\(密码学\) "wikilink")
  - [CAST-128](https://zh.wikipedia.org/wiki/CAST-128 "wikilink")
  - [DES](https://zh.wikipedia.org/wiki/数据加密标准 "wikilink")
  - [FEAL](https://zh.wikipedia.org/wiki/FEAL "wikilink")
  - [GOST 28147-89](https://zh.wikipedia.org/wiki/GOST_28147-89 "wikilink")
  - [ICE](https://zh.wikipedia.org/wiki/ICE_\(密码学\) "wikilink")

<!-- end list -->

  - [KASUMI](https://zh.wikipedia.org/wiki/KASUMI "wikilink")
  - [LOKI97](https://zh.wikipedia.org/wiki/LOKI97 "wikilink")
  - [Lucifer](https://zh.wikipedia.org/wiki/Lucifer_\(密码学\) "wikilink")
  - [MARS](https://zh.wikipedia.org/wiki/MARS_\(密码学\) "wikilink")
  - [MAGENTA](https://zh.wikipedia.org/wiki/MAGENTA_\(密码学\) "wikilink")
  - [MISTY1](https://zh.wikipedia.org/wiki/MISTY1 "wikilink")

<!-- end list -->

  - [RC5](../Page/RC5.md "wikilink")
  - [Simon](https://zh.wikipedia.org/wiki/Simon_\(密码学\) "wikilink")
  - [TEA](../Page/微型加密算法.md "wikilink")
  - [三重DES](https://zh.wikipedia.org/wiki/三重DES "wikilink")
  - [Twofish](../Page/Twofish.md "wikilink")
  - [XTEA](https://zh.wikipedia.org/wiki/XTEA "wikilink")

广义Feistel：

  - [CAST-256](https://zh.wikipedia.org/wiki/CAST-256 "wikilink")
  - [CLEFIA](https://zh.wikipedia.org/wiki/CLEFIA "wikilink")
  - [MacGuffin](https://zh.wikipedia.org/wiki/MacGuffin_\(密码学\) "wikilink")
  - [RC2](https://zh.wikipedia.org/wiki/RC2 "wikilink")

<!-- end list -->

  - [RC6](../Page/RC6.md "wikilink")
  - [Skipjack](https://zh.wikipedia.org/wiki/Skipjack_\(密码学\) "wikilink")
  - [SMS4](https://zh.wikipedia.org/wiki/SMS4 "wikilink")

## 参见

  - [密码学](../Page/密码学.md "wikilink")
  - [流密码](../Page/流密码.md "wikilink")
  - [代换-置换网络](../Page/代换-置换网络.md "wikilink")
  - [提升方案](https://zh.wikipedia.org/wiki/提升方案 "wikilink")，用于离散小波变换，具有几乎相同的结构
  - [保留格式加密](https://zh.wikipedia.org/wiki/保留格式加密 "wikilink")
  - [莱-马西方案](https://zh.wikipedia.org/wiki/莱-马西方案 "wikilink")

## 参考

[Category:密码学](https://zh.wikipedia.org/wiki/Category:密码学 "wikilink") [Category:费斯妥密码](https://zh.wikipedia.org/wiki/Category:费斯妥密码 "wikilink")

1.

2.

3.

4.

5.

6.

7.

8.
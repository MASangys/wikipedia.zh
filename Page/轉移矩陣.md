在[数学中](../Page/数学.md "wikilink")，**随机矩阵**（也称为**概率矩阵**、**转移矩阵**\[1\]、**替代矩阵**、或**马尔可夫矩阵**）是用来描述一个[马尔可夫链的转变的](../Page/马尔可夫链.md "wikilink")[矩阵](../Page/矩阵.md "wikilink")
。它的每一项都是一个表示[概率的非负](../Page/概率.md "wikilink")[实数](../Page/实数.md "wikilink")。它适用于[概率论](https://zh.wikipedia.org/wiki/概率论 "wikilink")、[统计学和](../Page/统计学.md "wikilink")[线性代数](../Page/线性代数.md "wikilink")，也在[计算机科学和](../Page/计算机科学.md "wikilink")[群体遗传学中使用](../Page/群体遗传学.md "wikilink")。
有几种不同的定义和类型随机矩阵：

  - **右随机矩阵**是实方阵，其中每一-{zh-cn:行;zh-hk:行;zh-mo:行;zh-sg:行;zh-tw:列}-求和为1。
  - **左随机矩阵**是实方阵，其中每一-{zh-cn:列;zh-hk:列;zh-mo:列;zh-sg:列;zh-tw:行}-求和为1。
  - **双随机矩阵**是非负实数方阵，每个行和列求和均为1。

同理，可以定义**随机向量**（也称为**概率向量**）为元素为非负实数且和为1的[向量](../Page/向量.md "wikilink")。因此，右随机矩阵的每一-{zh-cn:行;zh-hk:行;zh-mo:行;zh-sg:行;zh-tw:列}-（或左随机矩阵的每一-{zh-cn:列;zh-hk:列;zh-mo:列;zh-sg:列;zh-tw:行}-）都是一个随机向量。

在英语数学文献中的惯例是用概率的-{zh-cn:[行向量](https://zh.wikipedia.org/wiki/行向量 "wikilink");zh-hk:[行向量](https://zh.wikipedia.org/wiki/行向量 "wikilink");zh-mo:[行向量](https://zh.wikipedia.org/wiki/行向量 "wikilink");zh-sg:[行向量](https://zh.wikipedia.org/wiki/行向量 "wikilink");zh-tw:[列向量](https://zh.wikipedia.org/wiki/行向量 "wikilink")}-和概率的右随机矩阵，而不用-{zh-cn:[列向量](https://zh.wikipedia.org/wiki/列向量 "wikilink");zh-hk:[列向量](https://zh.wikipedia.org/wiki/列向量 "wikilink");zh-mo:[列向量](https://zh.wikipedia.org/wiki/列向量 "wikilink");zh-sg:[列向量](https://zh.wikipedia.org/wiki/列向量 "wikilink");zh-tw:[行向量](https://zh.wikipedia.org/wiki/列向量 "wikilink")}-和左随机矩阵，本文遵循此惯例。

## 定义和性质

随机矩阵描述了在一个[有限](https://zh.wikipedia.org/wiki/有限集合 "wikilink")[状态空间](../Page/概率空間.md "wikilink")
*S* 上的[马尔可夫链](../Page/马尔可夫链.md "wikilink") \(\boldsymbol{X}_{t}\)。

如果在一个时间步长内从 \(i\) 到 \(j\) 移动的[概率为](../Page/概率.md "wikilink")
\(\operatorname{Pr}(j|i)=P_{i,j}\)，随机矩阵 *P* 的第
\(i\)-{zh-cn:行;zh-hk:行;zh-mo:行;zh-sg:行;zh-tw:列}-，第 \(j\)
-{zh-cn:列;zh-hk:列;zh-mo:列;zh-sg:列;zh-tw:行}-元素由 \(P_{i,j}\) 给出，例如，

\[P=\left(\begin{matrix}p_{1,1}&p_{1,2}&\dots&p_{1,j}&\dots\\
p_{2,1}&p_{2,2}&\dots&p_{2,j}&\dots\\
\vdots&\vdots&\ddots&\vdots&\ddots\\
p_{i,1}&p_{i,2}&\dots&p_{i,j}&\dots\\
\vdots&\vdots&\ddots&\vdots&\ddots
\end{matrix}\right).\]

由于从状态 \(i\) 到下一状态的概率总和必须是 1，这个矩阵是一个右随机矩阵，于是

\[\sum_j P_{i,j}=1.\,\]

从 \(i\) 到 \(j\) 分两步转变的概率由然后由给定的 \(P\) 的平方矩阵的 \((i,j)\) 号元素给出：

\[\left(P ^{2}\right)_{i,j}.\]

一般地，在由矩阵\(P\)给出的有限马尔可夫链上从任何状态转移到另一个状态的 *k* 步转移概率为 \(P^k\)。

初始分布为一个-{zh-cn:[行向量](https://zh.wikipedia.org/wiki/行向量 "wikilink");zh-hk:[行向量](https://zh.wikipedia.org/wiki/行向量 "wikilink");zh-mo:[行向量](https://zh.wikipedia.org/wiki/行向量 "wikilink");zh-sg:[行向量](https://zh.wikipedia.org/wiki/行向量 "wikilink");zh-tw:[列向量](https://zh.wikipedia.org/wiki/行向量 "wikilink")}-。

平稳概率向量 \(\boldsymbol{\pi}\)
定义为不随转移矩阵的运用而变化的一个向量；也就是说，它定义为概率矩阵的左特征向量，其特征值为1：

\[\boldsymbol{\pi}P=\boldsymbol{\pi}.\]

保证了每个随机矩阵都具有这样的向量，而特征值的最大绝对值始终为1。在一般情况下，可能有多个这样的向量。然而，对于具有严格正项的矩阵，该向量是唯一的，并可以观察到对任意
\(i\) 我们都有以下极限而求出，

\[\lim_{k\rightarrow\infty}\left(P^k \right)_{i,j}=\boldsymbol{\pi}_j,\]

其中 \(\boldsymbol{\pi}_{j}\)
是-{zh-cn:行;zh-hk:行;zh-mo:行;zh-sg:行;zh-tw:列}-向量
\(\boldsymbol{\pi}\) 的第 \(j\) 个元素。在其他方面，这表示处在状态 \(j\) 下的长期概率与初始状态 \(i\)
是独立的。这两种计算得到相同的稳定向量是遍历定理的一种形式，在各种各样的[耗散动力系统广泛成立](../Page/耗散系統.md "wikilink")：该系统随着时间演变到[定态](https://zh.wikipedia.org/wiki/定态 "wikilink")。

直观地看，随机矩阵表示一个马尔可夫链；对概率分布应用随机矩阵，就是将原始分布的概率质量进行重新分布，同时保持其总质量。如果反复应用此过程，分布就会收敛为马尔可夫链的平稳分布。

## 應用

轉移矩陣可用以表示[機率](https://zh.wikipedia.org/wiki/機率 "wikilink")(或變化比率)，而矩陣相乘的結果可用以預測未來事件發生的[機率](https://zh.wikipedia.org/wiki/機率 "wikilink")。

## 性質

設\(\mathbf{A}\)、\(\mathbf{B}\)為二個*n*×*n*階轉移矩陣，則以下亦為轉移矩陣:

  - \(\mathbf{AB}\)
  - \(\mathbf{A}^2\)
  - \(\frac{1}{2}(\mathbf{A}+\mathbf{B})\)

## 范例：猫和老鼠

假设你有一个计时器和五个相邻的格子排成一行，零时刻有一只猫在第一个格子中，而一只老鼠在第五个格子中。在计时器增加的时候猫和老鼠都会随机跳到一个相邻的格子中。例如，如果猫在第二个格子，老鼠在第四个，*在计时器增加后，猫会出现在第一个格子**且**老鼠会出现在第五个格子*的概率为1/4。如果猫在第一个格子而老鼠在第五个，那么计时器增加后，猫会出现在第二个格子且老鼠会出现在第四个的概率为1。当它们处于同一个格子的时候，猫会吃掉老鼠，游戏结束。[随机变量](../Page/随机变量.md "wikilink")
*K* 给出了老鼠仍留在游戏中的时间步长。

表示这个包含五种位置组合 (猫,鼠) 的状态的游戏的[马尔可夫链为](../Page/马尔可夫链.md "wikilink")：

  - 状态 1：(1,3)
  - 状态 2：(1,5)
  - 状态 3：(2,4)
  - 状态 4：(3,5)
  - 状态 5：游戏结束：(2,2), (3,3) & (4,4).

我们使用一个随机矩阵来表示这个系统的[转移概率](../Page/马尔可夫链.md "wikilink")（这个矩阵中的行和列用上面提到的可能状态来索引），

\[P =
\begin{bmatrix}
    0  & 0    & 1/2  &   0  & 1/2 \\
    0  & 0    & 1    &   0  & 0 \\
  1/4  & 1/4  & 0    & 1/4  & 1/4 \\
    0  & 0    & 1/2  &   0  & 1/2 \\
    0  & 0    & 0    &   0  & 1
\end{bmatrix}.\]

### 长期平均

无论初始状态是什么，猫最终都会抓到老鼠（概率为1），且极限为稳态 **π** = (0,0,0,0,1)。要计算随机变量 Y
的长期平均或期望值。对每种状态 S<sub>j</sub> 和时间 t<sub>k</sub>，都有
Y<sub>j,k</sub>·P(S=S<sub>j</sub>,t=t<sub>k</sub>)
的贡献。生存与否可以视作一个二值变量，Y=1 代表生存状态而 Y=0
代表终止状态。Y=0 的状态不对长期平均有贡献。

### 位相型表示

[Mousesurvival.jpg](https://zh.wikipedia.org/wiki/File:Mousesurvival.jpg "fig:Mousesurvival.jpg")

由于状态 5 是一个吸收态，吸收对时间的分布为。假设系统从状态 2 开始，表示为向量
\([0,1,0,0,0]\)。老鼠死亡后的状态不会对生存平均产生影响，所以状态五可以忽略。初始状态和转移矩阵可以化简为，

\[\boldsymbol{\tau}=[0,1,0,0]\]

以及，

\[T=\begin{bmatrix}
    0  & 0    & 1/2  &   0\\
    0  & 0    & 1    &   0\\
  1/4  & 1/4  &   0  & 1/4\\
    0  & 0    & 1/2  &   0
\end{bmatrix}\]；而 \((I-T)^{-1}\boldsymbol{1}
=\begin{bmatrix}2.75 \\ 4.5 \\ 3.5 \\ 2.75\end{bmatrix}\,,\) 其中 \(I\)
为[单位矩阵](https://zh.wikipedia.org/wiki/单位矩阵 "wikilink")，\(\mathbf{1}\)
表示全为1的-{zh-cn:列;zh-hk:列;zh-mo:列;zh-sg:列;zh-tw:行}-矩阵，进行状态的相加。

由于每个状态都占据一个时间步长，老鼠生存时间的期望就是在所有生存状态和时间步长中占据的概率之[和](../Page/矩阵多项式.md "wikilink")，

\[E[K]=\boldsymbol{\tau}(I+T+T^2+\cdots)\boldsymbol{1}=\boldsymbol{\tau}(I-T)^{-1}\boldsymbol{1}=4.5.\]

其高阶矩为

\[E[K(K-1)\dots(K-n+1)]=n!\boldsymbol{\tau}(I-{T})^{-n}{T}^{n-1}\mathbf{1}\,.\]

## 参见

  - [Muirhead's
    inequality](https://zh.wikipedia.org/wiki/Muirhead's_inequality "wikilink")

  -
  - [密度矩陣](../Page/密度矩陣.md "wikilink")

  -
  - [Discrete phase-type
    distribution](https://zh.wikipedia.org/wiki/Discrete_phase-type_distribution "wikilink")

  -
  - [Models of DNA
    evolution](https://zh.wikipedia.org/wiki/Models_of_DNA_evolution "wikilink")

  - ，随机矩阵在连续状态空间的等价形式

## 参考文献

  - G. Latouche, V. Ramaswami. *Introduction to Matrix Analytic Methods
    in Stochastic Modeling*, 1st edition. Chapter 2: PH Distributions;
    ASA SIAM, 1999.

[Category:矩陣](https://zh.wikipedia.org/wiki/Category:矩陣 "wikilink")
[Category:马尔可夫模型](https://zh.wikipedia.org/wiki/Category:马尔可夫模型 "wikilink")

1.
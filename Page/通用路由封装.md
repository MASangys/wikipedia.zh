**通用路由封装**（，縮寫：**GRE**）是一种可以在虚拟[点对点链路中](https://zh.wikipedia.org/wiki/点对点 "wikilink")[封装多种](https://zh.wikipedia.org/wiki/封装 "wikilink")[网络层](../Page/网络层.md "wikilink")协议的[隧道协议](../Page/隧道协议.md "wikilink")。由[思科系统](../Page/思科系统.md "wikilink")开发，在中定义。

## 协议栈举例

| [OSI模型](../Page/OSI模型.md "wikilink")分层                      | [协议](../Page/网络传输协议.md "wikilink")                      |
| ----------------------------------------------------------- | ------------------------------------------------------- |
| 5\. [会话层](../Page/会话层.md "wikilink")                        | [X.225](https://zh.wikipedia.org/wiki/X.225 "wikilink") |
| 4\. [传输层](../Page/传输层.md "wikilink")                        | [UDP](https://zh.wikipedia.org/wiki/UDP "wikilink")     |
| 3\. [网络层](../Page/网络层.md "wikilink") <small>(GRE封装)</small> | [IPv6](../Page/IPv6.md "wikilink")                      |
| [封装](https://zh.wikipedia.org/wiki/封装 "wikilink")           | **GRE**                                                 |
| 3\. [网络层](../Page/网络层.md "wikilink")                        | [IPv4](../Page/IPv4.md "wikilink")                      |
| 2\. [数据链路层](../Page/数据链路层.md "wikilink")                    | [以太网](../Page/以太网.md "wikilink")                        |
| 1\. [物理层](../Page/物理层.md "wikilink")                        | [以太物理层](https://zh.wikipedia.org/wiki/以太物理层 "wikilink") |

从上面的图表可以看出，协议封装（非特指GRE）打破了OSI模型中定义的分层。这可以被看成两个不同协议栈中间的分割器，一个承载另一个。

## 报文头

GRE报文头结构如下图所示。\[最新的[RFC
2784](https://zh.wikipedia.org/wiki/:rfc:2784 "wikilink") && [RFC
2890](https://zh.wikipedia.org/wiki/:rfc:2890 "wikilink")\]

| Bits 0–3                                                                   | 4–12      | 13–15 | 16–31 |
| -------------------------------------------------------------------------- | --------- | ----- | ----- |
| C                                                                          |           | K     | S     |
| [Checksum](https://zh.wikipedia.org/wiki/Checksum "wikilink") *(optional)* | Reserved2 |       |       |
| Key *(optional)*                                                           |           |       |       |
| Sequence Number *(optional)*                                               |           |       |       |

  - C：校验码标记位，标为1为代表启用校验码。
  - K：键码标记位，标为1为代表启用校验码。
  - S：序列号标记位，标为1为代表启用序列号。
  - Reserved1、Reserved2：预留，默认为填0。
  - Version：版本号，默认值为0。
  - Protocol Type：负载得网络层[以太类型](../Page/以太类型.md "wikilink")。
  - Checksum：校验码，C位启用时可用。为GRE头与负载的校验码。
  - Key：键码，K位启用时可用。特定用语所需的键值。
  - Sequence Number，序列号，S位启用时可用。为GRE数据包的发送序列号。

## 参考资料

## 外部链接

  - RFCs
      - RFC 1701 — Generic Routing Encapsulation (GRE) (INFORMATIONAL)
      - RFC 1702 — Generic Routing Encapsulation over IPv4 networks
        (INFORMATIONAL)
      - RFC 2784 — Generic Routing Encapsulation (GRE) (PROPOSED
        STANDARD - Updated by RFC 2890)
      - RFC 2890 — Key and Sequence Number Extensions to GRE (PROPOSED
        STANDARD)
  - Cisco Systems
      - [Generic Routing
        Encapsulation](https://web.archive.org/web/20110403084614/http://www.cisco.com/en/US/tech/tk827/tk369/tk287/tsd_technology_support_sub-protocol_home.html),
        Subprotocol homepage at Cisco
      - [Generic Routing
        Encapsulation](http://docwiki.cisco.com/wiki/Internetworking_Terms:_Generic_Routing_Encapsulation_%28GRE%29),
        Entry in Cisco DocWiki (formerly known as the "Internetworking
        Technology Handbook")

[Category:穿隧协议](https://zh.wikipedia.org/wiki/Category:穿隧协议 "wikilink")
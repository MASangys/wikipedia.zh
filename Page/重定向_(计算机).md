在计算机领域，**重定向**是大多数命令行解释器所具有的功能，包括各种可以将标准流重定向用户规定地点的[Unix](https://zh.wikipedia.org/wiki/Unix "wikilink")
shells。类[Unix操作系统的程序可以透過dup](https://zh.wikipedia.org/wiki/Unix "wikilink")2(2)[系统调用完成重定向](https://zh.wikipedia.org/wiki/系统调用 "wikilink")，或者透過缺少一些灵活性但是更高一级层次的freopen(3)和popen(3)来完成。

## 重定向标准输入输出

重定向一般透過在命令间插入特定的符号来实现。特别的，这些符号的语法如下所示:

``` bash
command1 >file1
```

上面这个命令执行`command1`然后将输出的内容存入`file1`.注意任何`file1`内的已经存在的内容将被新内容替代。如果要将新内容添加在文件末尾，请使用\>\>操作符。

``` bash
command1 <file1
```

执行`command1`，使用`file1`作为用来替代键盘的输入源。

``` bash
command1  <infile > outfile
```

同时替换输入和输出，执行`command1`，从文件`infile`读取内容，然后将输出写入到`outfile`中。

## 管道

多个程序可以一起运行，一个程序可以直接将另外一个程序的输出作为其输入，并且不需要借助中间文件：

``` bash
command1 | command2
```

执行`command1`，将其输出作为`command2`的输入。这种方式被称为管道，因为"|"字符被称为"管道"。这种方式的结果和使用2个重定向及一个临时文件的方式相等价：

``` bash
command1 > tempfile
command2 < tempfile
rm tempfile
```

但是使用管道的时候两个命令是同时执行的，较为省时。

一个使用命令管道的很好例子是使用[echo和另外一个命令达到在一个非交互式shell中达到一定的交互效果](https://zh.wikipedia.org/wiki/echo "wikilink")：

``` bash
echo -e "user\npass" | ftp localhost
```

这个例子运行[ftp客户端](https://zh.wikipedia.org/wiki/ftp "wikilink")，然后输入用户名，回车，然后再输入密码。

## 标准文件句柄的重定向

源自[Bourne shell的许多](../Page/Bourne_shell.md "wikilink")[Unix
shell](../Page/Unix_shell.md "wikilink")，可以将一个数字（文件描述符）放在重定向符号前，这样可以影响用于重定向的数据流。[Unix的标准输入输出流是](https://zh.wikipedia.org/wiki/Unix "wikilink"):

| Handle | Name                                                      | Description |
| ------ | --------------------------------------------------------- | ----------- |
| 0      | [stdin](https://zh.wikipedia.org/wiki/stdin "wikilink")   | 标准输入        |
| 1      | [stdout](https://zh.wikipedia.org/wiki/stdout "wikilink") | 标准输出        |
| 2      | [stderr](https://zh.wikipedia.org/wiki/stderr "wikilink") | 标准错误输出      |

例如：

``` bash
command1 2> file1
```

执行`command1`，然后将标准错误输出重定向到文件`file1`

一些源自[csh的shells](../Page/C_Shell.md "wikilink")，将&符号放在重定向符号后，达到同样的效果。这样做的原因是为了将标准输出与文件名为'1'的文件区分开来。例如对于'cat
file 2\>1'和'cat file 2\>&1'，前者会将错误输出重定向至叫做'1'的文件，后者则将其重定向至标准输出。

另外一个很有用的功能是将一个标准文件句柄重定向到另一个。最流行的一种用法是将标准错误输出融合到标准输出中去，这样错误信息可以和其他普通的输出信息一起处理。例如：

``` bash
find / -name .profile > results 2>&1
```

上面这个命令会找到所有名字为.profile的文件。如果没有重定向，它会输出结果到标准输出，错误（例如在遍历过程中缺少访问某些受保护目录的权限）到标准错误输出。如果标准输出被重定向到一个文件，那么错误信息就会出现在控制台上。通过使用重定向2\>&1，输出的结果和错误信息都被写入了文件`results`.

可以将2\>&1放置在"\>"前，但是这样并不能达到我们想要的效果。因为当解释器读到2\>&1，
它并不知道标准输出已经被重定向到哪裡，所以标准错误输出并没有和标准输出融合。

如果融合过的输出通过管道作为另外一个程序的输入，那么这个融合2\>&1必须在管道符号之前：

``` bash
find / -name .profile 2>&1 | less
```

一个命令

``` bash
command > file 2>&1
```

的简化版本 (不使用于bourne shell)

``` bash
command &>file
```

或者

``` bash
command >&file
```

## 连锁管道

重定向和管道符可以联合使用，这样可以组合出更加复杂的命令， 例如:

``` bash
ls | grep '\.sh' | sort > shlist
```

上面这个命令将当前目录的内容列出来，将其作为[grep命令的输入内容](https://zh.wikipedia.org/wiki/grep "wikilink")，[grep将过滤掉没有以](https://zh.wikipedia.org/wiki/grep "wikilink")".sh"结尾的内容，然后将内容输出给[sort命令作为输入参数](https://zh.wikipedia.org/wiki/sort "wikilink")，[sort将输入内容按照字符的顺序排序以后](https://zh.wikipedia.org/wiki/sort "wikilink")，将最终的输入内容写入shlist文件。在[Unix和](https://zh.wikipedia.org/wiki/Unix "wikilink")[Linux操作系统中](../Page/Linux.md "wikilink")，这个样的组合命令非常的常见。

## 重定向到多个输出

命令[tee可以将一个命令的输出重定向到几个目标](https://zh.wikipedia.org/wiki/tee "wikilink"):

``` bash
ls -lrt | tee xyz
```

上面这个例子将ls的输出重新定向到标准输出和文件xyz。

## 参见

  - [Here-document](https://zh.wikipedia.org/wiki/Here-document "wikilink"),
    a way of specifying text for input in command line shells

## 外部链接

  - [Redirection Definition](http://www.linfo.org/redirection.html) by
    The Linux Information Project (LINFO)
  - [I/O Redirection](http://tldp.org/LDP/abs/html/io-redirection.html)
    in [The Linux Documentation Project](http://tldp.org/)
  - [Redirection in
    Windows](http://technet.microsoft.com/en-us/library/bb490982\(en-us\).aspx)
  - \[<http://msdn.microsoft.com/en-us/library/ms682499(VS.85>).aspx
    Creating a Child Process with Redirected Input and Output\] in
    Windows

[Category:带有代码示例的条目](https://zh.wikipedia.org/wiki/Category:带有代码示例的条目 "wikilink")
[Category:DOS技术](https://zh.wikipedia.org/wiki/Category:DOS技术 "wikilink")
[Category:Unix软件](https://zh.wikipedia.org/wiki/Category:Unix软件 "wikilink")
[Category:Unix](https://zh.wikipedia.org/wiki/Category:Unix "wikilink")
[Category:Windows管理](https://zh.wikipedia.org/wiki/Category:Windows管理 "wikilink")
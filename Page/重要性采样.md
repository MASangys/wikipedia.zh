**重要性采样**（）是[统计学中估计某一](../Page/统计学.md "wikilink")[分布性质时使用的一种方法](https://zh.wikipedia.org/wiki/分布 "wikilink")。该方法从与原分布不同的另一个分布中采样，而对原先分布的性质进行估计。重要性采样与[计算物理学中的](../Page/计算物理学.md "wikilink")相关。

## 原理

假设\(X:\Omega\to \mathbb{R}\)为[概率空间](https://zh.wikipedia.org/wiki/概率空间 "wikilink")\((\Omega,\mathcal{F},P)\)上的一个[随机变量](../Page/随机变量.md "wikilink")。我们想要估计*X*的[期望值](../Page/期望值.md "wikilink")，记作**E**\[*X;P*\]。如果根据*P*随机抽取样本\(x_1, \ldots, x_n\)，估计的期望值即

  -
    <math>

` \widehat{\mathbf{E}}_{n}[X;P] = \frac{1}{n} \sum_{i=1}^n x_i`

</math>

这一估计的精确度取决于*X*的方差，

  -
    <math>

`  \operatorname{var}[\widehat{\mathbf{E}}_{n};P] = \operatorname{var}[X;P]/n`

</math>

而重要性采样的基本思想则是从另一个分布中抽取样本，用以降低**E**\[*X;P*\]估计的方差。进行重要性采样时，首先选择一个随机变量\(L\geq 0\)，使得**E***\[L;P\]=1*，并满足*P*上[几乎处处](https://zh.wikipedia.org/wiki/几乎处处 "wikilink")\(L(\omega)\neq 0\)。由此，可以定义新的概率

  -
    <math>

` \mathbf{E}[X;P] = \mathbf{E}\left[\frac{X}{L};P^{(L)}\right].`

</math>

于是，我们可以从*P<sup>(L)</sup>*上抽样，通过变量*X/L*估计**E**\[*X;P*\]。如果\(\operatorname{var}\left[\frac{X}{L};P^{(L)}\right] < \operatorname{var}[X;P]\)成立，此时的估计便优于直接在原分布上采样得到的估计。

当*X*在Ω上不变号时，最优的*L*为\(L^*=\frac{X}{\mathbf{E}[X;P]}\geq 0\)。此时*X/L\**即为要估计的**E**\[*X;P*\]，只需一个样本便可得到该值。然而由于*L\**与要估计的**E**\[*X;P*\]有关，在实际操作中我们无法取到理论上最优的*L\**。不过，我们仍可以采用如下方式逼近该理论值：

  -
    <math>

\\begin{align}\\forall a\\in\\mathbb{R}, \\; P^{(L^\*)}(X\\in\[a;a+da\])
&= \\int_{\\omega\\in\\{X\\in\[a;a+da\]\\}}
\\frac{X(\\omega)}{E\[X;P\]}dP(\\omega) \\\\ &= \\frac{1}{E\[X;P\]}\\;
a\\,P(X\\in\[a;a+da\]) \\end{align}</math>

于是，要估计的期望值可改写为：

  -
    \(E[X;P] = \int_{a=-\infty}^{+\infty} a\,P(X\in[a;a+da])\)

注意到，更优（即让估计值方差更小）的*P<sup>(L)</sup>*会使得样本分布的频率与其在**E**\[*X;P*\]计算中的权重更加相关。这也是该方法得名“重要性采样”的原因。

重要性采样常用于[蒙特卡洛积分](https://zh.wikipedia.org/wiki/蒙特卡洛方法 "wikilink")。当\(P\)为[均匀分布](https://zh.wikipedia.org/wiki/均匀分布 "wikilink")、\(\Omega =\mathbb{R}\)时，**E**\[*X;P*\]即为实函数\(X:\mathbb{R}\to\mathbb{R}\)的积分。

## 参考文献

  -
  -
  -
  -
  -
  -
  -
  -
  -
  -
[Category:蒙地卡羅方法](https://zh.wikipedia.org/wiki/Category:蒙地卡羅方法 "wikilink")
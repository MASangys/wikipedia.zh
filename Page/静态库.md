在[计算机科学中](../Page/计算机科学.md "wikilink")，**靜態庫**（），或称**靜態函式庫**，是一個外部函式與變數的集合體。靜態函式庫的檔案內容，通常包含一堆程式設計師自定的變數與函式，其內容不像[動態連結庫那麼複雜](https://zh.wikipedia.org/wiki/動態連結庫 "wikilink")，在編譯期間由[編譯器與](../Page/編譯器.md "wikilink")[連結器將它整合至應用程式內](https://zh.wikipedia.org/wiki/連結器 "wikilink")，並製作成[目的檔以及可以獨立運作的](https://zh.wikipedia.org/wiki/目的碼 "wikilink")[執行檔](https://zh.wikipedia.org/wiki/執行檔 "wikilink")。而這個執行檔與編譯執行檔的程序，都是一種程式的靜態建立（static
build）。以過去的觀點來說，函式庫只能算是靜態（static）類型。

## 与动态链接库的比较

### 优点

只需保证在开发者的计算机有正确的[库文件](../Page/函式庫.md "wikilink")，在以二进制发布时不需考虑在使用者的计算机上库文件是否存在及[版本问题](https://zh.wikipedia.org/wiki/版本 "wikilink")，可避免[DLL地狱等问题](https://zh.wikipedia.org/wiki/DLL地狱 "wikilink")。

### 缺点

生成的[可执行文件体积较大](https://zh.wikipedia.org/wiki/可执行文件 "wikilink")。当初正是为了避免此问题，才开发了[动态库技术](../Page/动态链接库.md "wikilink")。

## 实现及使用

靜態函式庫可以用簡單的[C語言或是](https://zh.wikipedia.org/wiki/C語言 "wikilink")[C++程式碼去建立它](../Page/C++.md "wikilink")。這兩個程式語言提供關鍵字指定函式與變數是否為外部（external）或是內部（internal）連結，此外，還提供其他的特性。

建立這類的函式庫時，將函式或是變數匯出（export）一定要用外部連結（*external linkage* ）的語法特別指定它們。

### [GCC](../Page/GCC.md "wikilink")

静态库文件名为`lib*.a`，在使用了其中的函数之后，使用`-l*`参数要求连接器连入。

例如，在许多系统上，当使用了`math.h`中的函数后，需要使用`-lm`参数连接`libm.a`文件。

### [Visual C++](https://zh.wikipedia.org/wiki/Visual_C++ "wikilink")

静态库文件名为`*.lib`，在使用了其中的函数之后，使用`#pragma comment(lib,"*")`预编译指令要求连接器连入。

## 原始碼範例

### C/C++

[Static_lib_000.png](https://zh.wikipedia.org/wiki/File:Static_lib_000.png "fig:Static_lib_000.png")的原始碼與執行結果\]\]

<table>
<caption>靜態函式庫的原始碼範例</caption>
<thead>
<tr class="header">
<th><p>標頭檔案（Header File）</p></th>
<th><p>原始碼檔案（Source File） |- valign = "top"</p></th>
<th><div class="sourceCode" id="cb1"><pre class="sourceCode cpp"><code class="sourceCode cpp"><a class="sourceLine" id="cb1-1" title="1"><span class="co">// static_lib.h</span></a>
<a class="sourceLine" id="cb1-2" title="2"></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="pp"># ifndef _STATIC_LIB_H_</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="pp"># define _</span>STATIC_LIB_H_</a>
<a class="sourceLine" id="cb1-5" title="5"></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="pp"># include </span><span class="im">&lt;iostream&gt;</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="pp"># include </span><span class="im">&lt;string&gt;</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="pp"># include </span><span class="im">&lt;Windows.h&gt;</span></a>
<a class="sourceLine" id="cb1-9" title="9"></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="kw">using</span> <span class="kw">namespace</span> std;</a>
<a class="sourceLine" id="cb1-11" title="11"></a>
<a class="sourceLine" id="cb1-12" title="12"><span class="kw">namespace</span> STAIC_LIB</a>
<a class="sourceLine" id="cb1-13" title="13">{</a>
<a class="sourceLine" id="cb1-14" title="14">BOOL PRINT(__in string&amp; STRING);</a>
<a class="sourceLine" id="cb1-15" title="15">}</a>
<a class="sourceLine" id="cb1-16" title="16"></a>
<a class="sourceLine" id="cb1-17" title="17"><span class="pp"># endif</span></a></code></pre></div></th>
<th><p>|</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode cpp"><code class="sourceCode cpp"><a class="sourceLine" id="cb2-1" title="1"><span class="co">// static_lib.cpp</span></a>
<a class="sourceLine" id="cb2-2" title="2"></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="pp"># include </span><span class="im">&quot;static_lib.h&quot;</span></a>
<a class="sourceLine" id="cb2-4" title="4"></a>
<a class="sourceLine" id="cb2-5" title="5">BOOL STAIC_LIB::PRINT(__in string&amp; STRING)</a>
<a class="sourceLine" id="cb2-6" title="6">{</a>
<a class="sourceLine" id="cb2-7" title="7"><span class="cf">if</span> ( STRING.empty() )</a>
<a class="sourceLine" id="cb2-8" title="8">{</a>
<a class="sourceLine" id="cb2-9" title="9"><span class="cf">return</span> FALSE;</a>
<a class="sourceLine" id="cb2-10" title="10">}</a>
<a class="sourceLine" id="cb2-11" title="11"><span class="co">// 顯示一個字串</span></a>
<a class="sourceLine" id="cb2-12" title="12">cout&lt;&lt;STRING&lt;&lt;endl;</a>
<a class="sourceLine" id="cb2-13" title="13"><span class="cf">return</span> TRUE;</a>
<a class="sourceLine" id="cb2-14" title="14">}</a></code></pre></div></th>
</tr>
</thead>
<tbody>
</tbody>
</table>

## 参见

  - [函式庫](../Page/函式庫.md "wikilink")
  - [链接器](../Page/链接器.md "wikilink")
  - [载入器](https://zh.wikipedia.org/wiki/载入器 "wikilink")
  - [共享库](https://zh.wikipedia.org/wiki/共享库 "wikilink")
  - [动态链接库](../Page/动态链接库.md "wikilink")
  - [外部变量](../Page/外部变量.md "wikilink")
  - [目标文件](https://zh.wikipedia.org/wiki/目标文件 "wikilink")
  - [预绑定](https://zh.wikipedia.org/wiki/预绑定 "wikilink")

## 外部連結

  - [The C Book -
    Linkage.](http://publications.gbdirect.co.uk/c_book/chapter4/linkage.html)

[Category:计算机程序库](https://zh.wikipedia.org/wiki/Category:计算机程序库 "wikilink")
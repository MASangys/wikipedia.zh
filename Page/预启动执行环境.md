**预启动执行环境**（**Preboot eXecution Environment**，**PXE**，也被称为预执行环境)提供了一种使用网络接口（Network Interface）启动计算机的机制。这种机制让计算机的启动可以不依赖本地数据存储设备（如硬盘）或本地已安装的操作系统。

PXE当初是作为[Intel的](https://zh.wikipedia.org/wiki/Intel "wikilink")[有线管理体系的一部分](https://zh.wikipedia.org/wiki/有线管理 "wikilink")，[Intel](https://zh.wikipedia.org/wiki/Intel "wikilink") 和 [Systemsoft于](https://zh.wikipedia.org/wiki/Systemsoft "wikilink")1999年9月20日公布其规格(版本2.1)\[1\]。通过使用像[网际协议](../Page/网际协议.md "wikilink")(IP)、[用户数据报协议](../Page/用户数据报协议.md "wikilink")(UDP)、[动态主机设定协定](https://zh.wikipedia.org/wiki/动态主机设定协定 "wikilink")(DHCP)、[小型文件传输协议](../Page/小型文件传输协议.md "wikilink")(TFTP)等几种[网络协议和](https://zh.wikipedia.org/wiki/网络协议 "wikilink")[全局唯一标识符](../Page/全局唯一标识符.md "wikilink")(GUID)、[通用网络驱动接口](https://zh.wikipedia.org/wiki/通用网络驱动接口 "wikilink")(UNDI)、[通用唯一识别码](../Page/通用唯一识别码.md "wikilink")(UUID)的概念并通过对客户机(通过PXE自检的电脑)[固件扩展预设的](https://zh.wikipedia.org/wiki/固件 "wikilink")[API来实现目的](https://zh.wikipedia.org/wiki/API "wikilink")。

*PXE 客户机(client)*这个术语是指机器在PXE启动过程中的角色。一个*PXE 客户机(client)*可以是一台服务器、桌面级电脑、笔记本电脑或者其他装有PXE启动代码的机器。

## 通路

客户机的固件为接受到可用的PXE启动服务器，要在网络中尝试找出PXE重定向服务（DHCP代理）。在分析返回的包后，固件会向合适的启动服务器询问[网络自检程序](https://zh.wikipedia.org/wiki/网络自检程序 "wikilink")(NBP)的路径，并且通过[TFTP协议下载到电脑的内存中](https://zh.wikipedia.org/wiki/TFTP "wikilink")，有可能会去校验它，最后执行它。当只有全部的PXE 客户机(client)只使用一个NBP时，全部的PXE 客户机可能会被指定是用[BOOTP协议](https://zh.wikipedia.org/wiki/BOOTP "wikilink")，从而不需要DHCP代理，但是仍然需要TFTP启动服务。

## 优点

PXE被设计成适合各种计算机体系。在x86體系上，僅[UEFI韌體可能支援PXE](https://zh.wikipedia.org/wiki/UEFI "wikilink") IPv6，傳統[BIOS](../Page/BIOS.md "wikilink")（Legacy BIOS）只支援PXE IPv4。

## 協議

PXE 協議大致上結合了DHCP和TFTP，雖然都有在兩者上面有改進。DHCP用於查找合適的啟動伺服器,TFTP用於下載初始引導程序和附加文件。

為了開始一個PXE自檢會話，PXE固件廣播一個帶有明確的PXE選項DHCPDISCOVER包(*擴展DHCPDISCOVER*)到67/UDP端口(DHCP伺服器端口)。PXE選項是PXE固件有PXE能力的鑑定，但是會被一般的DHCP服務忽略。當固件受到從這樣的服務受到DHCPOFFER包時，它會通過要求其提供配置信息來自我配置。

## DHCP代理

当 PXE 重定向服务 （DHCP代理） 收到一个 *扩展DHCPDISCOVER* 包时，它会通过发送一个带有明确的PXE选项DHCPDISCOVER包到PXE客户机的68/UDP端口 (DHCP 客户机端口)来回答。 一个*扩展*DHCPDISCOVER包主要包含:

  - 一个PXE发现控制领域，以决定是使用[多播](../Page/多播.md "wikilink")，[广播(网路)或](https://zh.wikipedia.org/wiki/广播 "wikilink")[单播来联系PXE启动服务器](https://zh.wikipedia.org/wiki/单播 "wikilink")。
  - 一个列出可用的PXE启动服务器类型的地址表。
  - 一个代表每个一个PXE启动服务器类型的条目单。
  - 一个带有提示用户按下哪一个键来看到启动菜单的PXE启动菜单/
  - 一个超过多长时间就启动第一启动菜单的超时数值。

一个DHCP代理服务可能在相同的主机上运行一个标准的DHCP服务器。尽管两个服务不可以共享67/UDP 端口，DHCP代理服务在4011/UDP 端口上运行，要求从客户端来的DHCPDISCOVER 包变成DHCPREQUEST 包。标准DHCP服务在其发送的DHCPOFFER 包中加入特殊的PXE 选项组合，这样PXE客户端知道可以在同一个主机的 4011/UDP 端口找到一个DHCP代理服务。

## 联系启动服务

和一个正在启动系统的启动服务联系必须有一个[IP地址](../Page/IP地址.md "wikilink")（可能来自DHCP服务）。

通过[多播](../Page/多播.md "wikilink")或[单播一个带有特殊的PXE选项的](https://zh.wikipedia.org/wiki/单播 "wikilink") *<small>DHCP</small>REQUEST</big>* 包(扩展*<small>DHCP</small>REQUEST</big>*包)到 4011/UDP端口，或者[广播(网路)这种包到](https://zh.wikipedia.org/wiki/广播 "wikilink") 67/UDP端口。这种包包含有PXE启动服务**类型**和PXE启动层，一个守护进程允许运行多个启动服务类型。 一个*扩展 <small>DHCP</small>REQUEST*包可能是一个*<small>DHCP</small>INFORM*包。

## 参见

  - [Remote Initial Program Load](https://zh.wikipedia.org/wiki/Remote_Initial_Program_Load "wikilink") (RIPL)
  - [System Deployment Image](https://zh.wikipedia.org/wiki/System_Deployment_Image "wikilink") (SDI)
  - [gPXE](https://zh.wikipedia.org/wiki/gPXE "wikilink") - 无需 PXE-ROM的 的 PXE启动
  - [Cobbler （软件）](https://zh.wikipedia.org/wiki/Cobbler_（软件） "wikilink") - 一个协助 PXE 部署的 Linux 自由软件
  - [Windows Deployment Services](https://zh.wikipedia.org/wiki/Windows_Deployment_Services "wikilink") - 一个基于 PXE的[Microsoft Windows部署方案](https://zh.wikipedia.org/wiki/Microsoft_Windows "wikilink")
  - [无盘系统](https://zh.wikipedia.org/wiki/无盘系统 "wikilink")
  - [利用PXE部署Linux](http://www.ytyzx.net/index.php?title=%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8Kickstart%E8%87%AA%E5%8A%A8%E6%89%B9%E9%87%8F%E5%AE%89%E8%A3%85Linux%E5%AE%A2%E6%88%B7%E7%AB%AF%EF%BC%88CentOS%EF%BC%89)

## 资源

Specifications, RFCs and other documents about PXE:

  - [PXE specification](https://web.archive.org/web/20110524083740/http://download.intel.com/design/archives/wfm/downloads/pxespec.pdf) - The Preboot Execution Environment specification v2.1 published by [Intel](https://zh.wikipedia.org/wiki/Intel "wikilink") & [Systemsoft](https://zh.wikipedia.org/wiki/Systemsoft "wikilink").
  - [BIS specification](https://web.archive.org/web/20091117070518/http://download.intel.com/design/archives/wfm/downloads/bisspec.pdf) - The Boot Integrity Services specification v1.0 published by Intel.
  - [Remote Boot Protocol Draft](http://quimby.gnus.org/internet-drafts/draft-henry-remote-boot-protocol-00.txt) - draft of the PXE Client/Server Protocol included in the PXE specification.
  - [LTSP](http://www.ltsp.org/) - Linux Terminal Server Project
  - [Lan Core](http://lancore.sourceforge.net/) - Open Source Thin Client solution.

## 引用

<references/>

## 外部链接

  - [PXE error codes](https://web.archive.org/web/20110712224602/http://h18013.www1.hp.com/products/servers/management/rdp/knowledgebase/00000138.html) - A catalogue of PXE error codes

<!-- end list -->

  - [PXE, aka Pre-Execution Environment](http://www.itstuff.ca/2007/09/pxe-aka-pre-execution-environment-part.html) - How to boot from Network - Part 1
  - [PXE, aka Pre-Execution Environment](http://www.itstuff.ca/2007/12/pxe-aka-pre-execution-environment-and.html) - How to boot from Network - Part 2

[分類:網路標準](https://zh.wikipedia.org/wiki/分類:網路標準 "wikilink")

1.